<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camino Portugu√©s de la Costa - Etapas 1 a 9</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; color: #333; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        /* --- CABECERA PRO COMPACTA & CLARA --- */
/* --- HEADER COMPACTO --- */
/* --- HEADER ULTRA-COMPACTO --- */
header {
    position: relative;
    background: linear-gradient(to bottom, rgba(15, 23, 42, 0.5), rgba(15, 23, 42, 0.95)), 
                url('https://images.unsplash.com/photo-1551043047-1d2adf00f300?q=80&w=1000&auto=format&fit=crop'); 
    background-size: cover;
    background-position: center 40%;
    color: white !important;
    /* CLAVE: Reducimos mucho el padding (especialmente el de abajo) */
    padding: 20px 15px 15px; 
    border-radius: 0 0 30px 30px;
    text-align: center;
    box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    overflow: hidden;
    font-family: 'Montserrat', sans-serif;
    margin-bottom: 20px;
}

/* Logo un poco m√°s peque√±o para ganar espacio */
.logo-badge-pro {
    width: 85px; 
    height: 85px;
    margin: 0 auto 5px; /* Margen m√≠nimo con el t√≠tulo */
    background: transparent; 
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    overflow: hidden;
    border: 2px solid rgba(255, 255, 255, 0.2);
    transition: transform 0.3s ease;
}
.logo-img-real {
    width: 100%;        /* Ocupa todo el ancho del c√≠rculo */
    height: 100%;       /* Ocupa todo el alto */
    object-fit: cover;  /* Recorta lo que sobra para no deformarse */
    border-radius: 50%; /* Se asegura de ser redondo */
    display: block;
}

/* T√≠tulos m√°s pegaditos */
header h1 {
    font-size: 1.7em; /* Un pel√≠n m√°s peque√±o */
    margin: 0;
    line-height: 1.1;
}

header p.subtitle-pro {
    font-size: 0.8em;
    margin-top: 4px;
    opacity: 0.9;
}

/* Stats m√°s compactas */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr); /* 2 columnas */
    gap: 8px; /* Menos hueco entre cajas */
    margin-top: 15px; /* Menos separaci√≥n con el t√≠tulo */
}

.stat {
    padding: 8px 5px; /* Cajas m√°s finas */
    /* ... resto de estilos de stat ... */
}

/* Cuenta atr√°s "Slim" */
#countdown-container {
    margin-top: 12px;
    padding: 5px 15px !important; /* M√°s fino */
    background: rgba(0,0,0,0.4) !important;
    /* ... */
}
#countdown {
    font-size: 1.1em !important; /* Letra un poco m√°s peque√±a */
}

/* Controles pegados abajo */
.controls-area {
    margin-top: 12px; /* Pegado a la cuenta atr√°s */
    display: flex;
    flex-direction: column;
    gap: 8px; /* Poca distancia entre filas */
    align-items: center;
}

.btn-app {
    padding: 6px 12px; /* Botones m√°s finos */
    font-size: 0.9em;
}

/* --- NUEVO ESTILO MOCHILA (Integrado) --- */
.btn-mochila {
    /* Gradiente Naranja/Dorado vibrante */
    background: linear-gradient(135deg, #FF8008 0%, #FFC837 100%);
    border: none; /* Quitamos bordes por defecto del button */
    cursor: pointer; /* Aseguramos que salga la manita al pasar el mouse */
    font-family: inherit; /* Heredar fuente de la web */
}

/* Ajuste espec√≠fico para que el bot√≥n <button> se comporte igual que los <a> */
button.btn-app {
    display: inline-flex; /* Asegura alineaci√≥n correcta */
    outline: none;
}

/* --- LIMPIEZA (Opcional pero recomendada) --- */
/* Si tienes por ah√≠ reglas antiguas llamadas .btn-mochila-pro que ya no usas,
   puedes borrarlas para no tener c√≥digo basura */

/* Ajustes extra para m√≥viles */
@media (max-width: 768px) {
    header { padding: 20px 15px 30px; }
    .logo-badge-pro { width: 60px; height: 60px; }
    .logo-icon-svg { width: 36px; height: 36px; }
    header h1 { font-size: 1.8em; }
}
        header { background: linear-gradient(135deg, #2c3e50 0%, #34595e 100%); color: white; padding: 40px; margin-bottom: 40px; border-radius: 8px; text-align: center; }
        header h1 { font-size: 2.5em; margin-bottom: 10px; }
        header p { font-size: 1.1em; opacity: 0.9; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 30px; }
        .stat { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 5px; border-left: 4px solid #f39c12; }
        .stat-number { font-size: 1.8em; font-weight: bold; margin-bottom: 5px; }
        .stat-label { font-size: 0.9em; opacity: 0.8; }

        .whatsapp-banner { background: linear-gradient(135deg, #25d366 0%, #20ba58 100%); color: white; padding: 25px; margin-bottom: 30px; border-radius: 8px; text-align: center; box-shadow: 0 4px 15px rgba(37,211,102,0.3); }
        .whatsapp-banner h2 { margin-bottom: 10px; font-size: 1.5em; }
        .whatsapp-banner p { font-size: 0.95em; margin-bottom: 10px; }
        .whatsapp-btn { display: inline-block; background: white; color: #25d366; padding: 12px 30px; border-radius: 5px; text-decoration: none; font-weight: bold; margin-top: 10px; transition: transform 0.3s; }
        .whatsapp-btn:hover { transform: scale(1.05); }

        .etapas-container { display: grid; gap: 30px; }
        .etapa { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-left: 5px solid #e74c3c; position: relative; }
        .etapa-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #ecf0f1; padding-bottom: 15px; }
        .etapa-title { font-size: 1.8em; color: #2c3e50; margin: 0; }
        .etapa-meta { display: flex; gap: 20px; font-size: 0.95em; }
        .meta-item { display: flex; align-items: center; gap: 8px; }
        .meta-label { font-weight: bold; color: #7f8c8d; }
        .meta-value { color: #2c3e50; }
        .etapa-intro { background: #f8f9fa; padding: 20px; border-radius: 5px; margin-bottom: 25px; border-left: 4px solid #3498db; line-height: 1.6; }
        .etapa-stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 25px; }
        .stat-box { background: #ecf0f1; padding: 15px; border-radius: 5px; text-align: center; }
        .stat-box-value { font-size: 1.5em; font-weight: bold; color: #e74c3c; margin-bottom: 5px; }
        .stat-box-label { font-size: 0.9em; color: #7f8c8d; }
        .btn-modal { display: inline-block; margin-top: 10px; padding: 10px 20px; background: #3498db; color: #fff; border-radius: 5px; text-decoration: none; font-size: 0.95em; font-weight: 600; border: none; cursor: pointer; transition: background 0.2s ease; }
        .btn-modal:hover { background: #2980b9; }

        .extra-card { background: #ffffff; border-radius: 6px; padding: 15px 18px; box-shadow: 0 1px 4px rgba(0,0,0,0.08); border-top: 3px solid #3498db; }
        .extra-card h4 { margin-bottom: 8px; font-size: 1.05em; color: #2c3e50; }
        .extra-card p, .extra-card ul { font-size: 0.9em; color: #555; line-height: 1.4; }
        .extra-card ul { padding-left: 18px; margin-top: 5px; }

        .accommodation-card { background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%); border-left: 4px solid #27ae60; padding: 15px; border-radius: 6px; margin-bottom: 12px; }
        .accommodation-card h4 { color: #27ae60; margin-bottom: 8px; font-size: 1.05em; }
        .accommodation-details { font-size: 0.85em; color: #555; line-height: 1.6; margin-bottom: 10px; }
        .accommodation-detail-line { margin-bottom: 5px; }

        .expandible-text { position: relative; }
        .expandible-content { max-height: none; overflow: hidden; position: relative; transition: max-height 0.4s ease; }
        .expandible-content.collapsed { max-height: 450px; }
        .expandible-fade { position: absolute; bottom: 0; left: 0; right: 0; height: 80px; background: linear-gradient(transparent, #ffffff); pointer-events: none; }
        .expandible-content.collapsed .expandible-fade { display: block; }
        .expandible-content:not(.collapsed) .expandible-fade { display: none; }
        .btn-expandible { display: inline-block; margin-top: 10px; padding: 6px 14px; background: #3498db; color: white; border-radius: 4px; text-decoration: none; font-size: 0.8em; font-weight: 600; border: none; cursor: pointer; transition: background 0.2s ease; }
        .btn-expandible:hover { background: #2980b9; }

        .tramo { background: #f8f9fa; padding: 12px 15px; margin-bottom: 10px; border-radius: 5px; border-left: 4px solid #3498db; transition: background 0.2s ease; }
        .tramo.open { background: #ffffff; }
        .tramo-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; cursor: pointer; user-select: none; }
        .tramo-header h4 { margin: 0; font-size: 0.95em; }
        .tramo-header-right { display: flex; align-items: center; gap: 12px; }
        .tramo-distance { background: #e74c3c; color: white; padding: 4px 10px; border-radius: 15px; font-weight: bold; font-size: 0.8em; }
        .tramo-toggle-icon { font-size: 1.1em; color: #7f8c8d; font-weight: bold; min-width: 18px; text-align: center; }
        .tramo-content { line-height: 1.6; color: #444; display: none; font-size: 0.9em; }
        .tramo.open .tramo-content { display: block; }
        .tramo-content p { margin-bottom: 8px; }

        .punto-parada { background: white; padding: 10px; margin-top: 10px; border-radius: 4px; border-left: 3px solid #27ae60; font-size: 0.85em; }
        .punto-parada-nombre { font-weight: bold; color: #27ae60; font-size: 0.95em; margin-bottom: 4px; }
        .distancia-acumulada { font-size: 0.8em; color: #7f8c8d; font-style: italic; }

        .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.55); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .modal-backdrop.show { display: flex; }
        .modal-panel { background: #ffffff; max-width: 1100px; width: 95%; max-height: 90vh; border-radius: 10px; box-shadow: 0 10px 35px rgba(0,0,0,0.35); display: flex; flex-direction: column; overflow: hidden; }
        .modal-header { padding: 16px 24px; border-bottom: 1px solid #ecf0f1; display: flex; justify-content: space-between; align-items: center; background: #f8f9fb; }
        .modal-header h2 { font-size: 1.3em; margin: 0; }
        .modal-close { background: none; border: none; font-size: 1.5em; cursor: pointer; color: #7f8c8d; }
        .modal-body { padding: 20px 24px; overflow-y: auto; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .modal-section { 
    min-width: 0; 
    margin-bottom: 25px; 
}

/* Ajuste para que el t√≠tulo y el icono se vean bien */
.modal-section h3 { 
    font-size: 1.1em; 
    margin-bottom: 12px; 
    color: #2c3e50; 
    border-bottom: 2px solid #e74c3c; 
    padding-bottom: 8px;
    display: block; /* Cambiamos flex por block para que ::first-letter funcione */
}

/* C√≠rculo base para todos los iconos de secci√≥n */
.modal-section h3::first-letter {
    background: #fff5f5; /* Rojo suave por defecto */
    padding: 5px 10px;
    border-radius: 50%;
    margin-right: 12px;
    border: 1px solid #fee2e2;
    box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    float: left;
    line-height: 1;
}

/* --- COLORES EXPERTOS POR CATEGOR√çA --- */

/* Verde para Alojamiento üè® */
.sec-alojamiento::first-letter { 
    background: #e8f5e9 !important; 
    border-color: #c8e6c9 !important; 
}

/* Azul para Tramos y Puntos üìç */
.sec-tramos::first-letter { 
    background: #e3f2fd !important; 
    border-color: #bbdefb !important; 
}

/* Naranja para Gastronom√≠a üçΩÔ∏è */
.sec-gastronomia::first-letter { 
    background: #fff3e0 !important; 
    border-color: #ffe0b2 !important; 
}
        .btn-alojamiento { display: inline-block; margin-top: 12px; padding: 8px 16px; background: #27ae60; color: white; border-radius: 4px; text-decoration: none; font-size: 0.85em; font-weight: 600; border: none; cursor: pointer; transition: background 0.2s ease; }
        .btn-alojamiento:hover { background: #229954; }
        .btn-maps { display: inline-block; margin-top: 12px; margin-left: 8px; padding: 8px 16px; background: #4285f4; color: white; border-radius: 4px; text-decoration: none; font-size: 0.85em; font-weight: 600; border: none; cursor: pointer; transition: background 0.2s ease; }
        .btn-maps:hover { background: #3367d6; }

        .modal-left { grid-column: 1; }
        .modal-right { grid-column: 2; }

        @media (max-width: 900px) {
            .modal-body { grid-template-columns: 1fr; }
            .modal-left, .modal-right { grid-column: 1; }
        }
        @media (max-width: 768px) {
            .etapa-header { flex-direction: column; align-items: flex-start; }
            .etapa-meta { flex-direction: column; gap: 10px; margin-top: 15px; }
            .etapa-stats { grid-template-columns: 1fr; }
            header h1 { font-size: 1.8em; }
            .tramo-header { flex-direction: column; align-items: flex-start; }
            .tramo-header-right { width: 100%; margin-top: 8px; }
        }
        /* --- CREDENCIAL DIGITAL PRO (DISE√ëO PREMIUM) --- */
.progress-section {
    background: #ffffff;
    padding: 30px 35px;
    border-radius: 20px; /* Bordes m√°s redondeados y modernos */
    margin-bottom: 40px;
    text-align: center;
    position: relative;
    overflow: hidden; /* Para que el brillo no se salga */
    
    /* Sombra suave pero profunda (Efecto elevaci√≥n) */
    box-shadow: 0 20px 50px rgba(0,0,0,0.08), 0 5px 15px rgba(0,0,0,0.05);
    
    /* Borde sutil para definir la tarjeta */
    border: 1px solid rgba(0,0,0,0.03);
}

/* üåü LA MAGIA: Borde superior degradado (Azul Mar -> Verde Camino -> Dorado Meta) */
.progress-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px; /* Grosor de la l√≠nea de color */
    background: linear-gradient(90deg, #3498db 0%, #2ecc71 50%, #f1c40f 100%);
    z-index: 1;
}

/* Fondo decorativo (Marca de agua de concha) */
.progress-section::after {
    content: 'üêö';
    position: absolute;
    right: -10px;
    bottom: -20px;
    font-size: 140px;
    opacity: 0.04; /* Muy sutil, casi invisible */
    transform: rotate(-15deg);
    pointer-events: none;
    filter: grayscale(100%);
}

/* T√≠tulo de la credencial mejorado */
.progress-label {
    font-weight: 800; /* Letra m√°s gruesa */
    color: #2c3e50;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
    z-index: 2; /* Para que est√© por encima del fondo */
}

/* Barra de fondo */
.progress-bar-bg {
    background-color: #f0f2f5; /* Un gris m√°s limpio */
    height: 28px; /* Un pel√≠n m√°s alta */
    border-radius: 50px; /* Redonda como una c√°psula */
    overflow: hidden;
    position: relative;
    box-shadow: inset 0 2px 5px rgba(0,0,0,0.05); /* Profundidad interior */
    z-index: 2;
}

/* Relleno de la barra (Con brillo animado) */
.progress-bar-fill {
    background: linear-gradient(90deg, #27ae60, #2ecc71);
    height: 100%;
    width: 0%;
    transition: width 1s cubic-bezier(0.4, 0, 0.2, 1); /* Animaci√≥n m√°s suave */
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.85em;
    font-weight: bold;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    position: relative;
    overflow: hidden;
}

/* Brillo que recorre la barra */
.progress-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: 100%;
    background: linear-gradient(
        90deg,
        rgba(255,255,255,0) 0%,
        rgba(255,255,255,0.3) 50%,
        rgba(255,255,255,0) 100%
    );
    transform: translateX(-100%);
    animation: shimmer 2.5s infinite;
}

@keyframes shimmer {
    100% { transform: translateX(100%); }
}

/* Interruptor (Toggle) para cada etapa */
.check-container {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px dashed #eee;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.check-label {
    font-weight: 600;
    color: #555;
    font-size: 0.9em;
}

/* Dise√±o del Switch */
.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 26px;
}

.switch input { 
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0; left: 0; right: 0; bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: #27ae60;
}

input:checked + .slider:before {
    transform: translateX(24px);
}

/* Efecto visual cuando la etapa est√° completada */
.etapa.completed {
    border-left-color: #27ae60;
    background-color: #f9fff9;
}

.etapa.completed .etapa-title {
    color: #27ae60;
    text-decoration: line-through;
}

/* --- ESTILOS WIDGETS (TIEMPO Y DIARIO) ACTUALIZADO --- */
.widget-card {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    overflow: hidden;
    border: 1px solid #eee;
    margin-bottom: 20px; /* Importante: crea espacio debajo del widget */
    font-family: 'Segoe UI', sans-serif;
}

/* --- NUEVA CABECERA CLIM√ÅTICA PRO --- */
.weather-header {
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.5s ease;
    min-height: 100px;
    background: #34495e; /* Color base por si falla la carga */
    color: white;
}

/* Clases din√°micas seg√∫n el tiempo */
.weather-sunny { background: linear-gradient(135deg, #FF8008, #FFC837); }
.weather-rainy { background: linear-gradient(135deg, #606c88, #3f4c6b); }
.weather-cloudy { background: linear-gradient(135deg, #bdc3c7, #2c3e50); }
.weather-storm { background: linear-gradient(135deg, #4b6cb7, #182848); }

.weather-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

.weather-temp {
    font-size: 2.8em;
    font-weight: 800;
    line-height: 1;
    text-shadow: 0 2px 10px rgba(0,0,0,0.2);
}

.weather-desc-group {
    display: flex;
    flex-direction: column;
}

.weather-desc {
    font-size: 1em;
    font-weight: 600;
    text-transform: capitalize;
}

.weather-advice {
    font-size: 0.75em;
    opacity: 0.9;
    margin-top: 4px;
    font-style: italic;
    max-width: 150px;
}

.weather-icon {
    font-size: 3.5em;
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

.diary-body {
    padding: 15px;
    background-color: #fdfbf7;
}

.diary-textarea {
    width: 100%;
    min-height: 150px; /* Un poco m√°s de espacio */
    border: 1px solid #e0d5c1; /* Borde sutil color arena */
    background-color: #fdfbf7; /* Color papel hueso */
    resize: vertical;
    font-family: 'Segoe Print', 'Comic Sans MS', cursive; /* Fuente tipo escritura a mano */
    font-size: 1em;
    color: #4b3621; /* Marr√≥n oscuro para simular tinta */
    line-height: 1.6em;
    outline: none;
    padding: 10px;
    border-radius: 4px;
    /* Efecto de l√≠neas de cuaderno */
    background-image: linear-gradient(#e1d9c6 1px, transparent 1px);
    background-size: 100% 1.6em;
    box-shadow: inset 0 1px 4px rgba(0,0,0,0.05);
}

.diary-footer {
    padding: 10px 15px;
    background: #f9f9f9;
    border-top: 1px solid #eee;
    font-size: 0.8em;
    color: #888;
    text-align: right;
    display: flex;
    justify-content: space-between;
}

/* --- ESTILOS MODO LISTA Y MOCHILA --- */

/* Transici√≥n suave para el cambio de vista */
.etapas-container .etapa {
    transition: all 0.3s ease;
}

/* --- MODO LISTA (Compacto) --- */
.etapas-container.list-mode {
    gap: 10px; /* Menos espacio entre tarjetas */
}

.etapas-container.list-mode .etapa {
    padding: 15px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    min-height: auto;
}

.etapas-container.list-mode .etapa-header {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
    flex: 1;
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 15px;
}

.etapas-container.list-mode .etapa-title {
    font-size: 1.1em;
    margin: 0;
    min-width: 250px;
}

.etapas-container.list-mode .etapa-meta {
    margin-top: 0;
    font-size: 0.85em;
    flex-direction: row;
    gap: 15px;
}

/* Ocultar elementos sobrantes en modo lista */
.etapas-container.list-mode .etapa-intro,
.etapas-container.list-mode .etapa-stats,
.etapas-container.list-mode .check-container, /* Ocultamos el switch grande */
.etapas-container.list-mode .progress-section {
    display: none; 
}

/* Bot√≥n "Ver detalles" en modo lista */
.etapas-container.list-mode .btn-modal {
    margin-top: 0;
    padding: 6px 12px;
    font-size: 0.8em;
    background: #ecf0f1;
    color: #333;
}

/* Ajuste m√≥vil para modo lista */
@media (max-width: 768px) {
    .etapas-container.list-mode .etapa { flex-direction: column; align-items: flex-start; gap: 10px; }
    .etapas-container.list-mode .etapa-header { flex-direction: column; align-items: flex-start; gap: 5px; }
    .etapas-container.list-mode .btn-modal { width: 100%; text-align: center; }
}

/* --- ESTILOS MOCHILA PRO 2.0 (NUEVO) --- */

/* Contenedor superior (Tarjeta Iberia + Regla Oro) */
.backpack-header-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-bottom: 25px;
}

@media (max-width: 600px) {
    .backpack-header-grid { grid-template-columns: 1fr; }
}

/* Tarjeta Iberia */
.airline-card {
    background: white;
    border: 1px solid #e1e1e1;
    border-radius: 12px;
    padding: 15px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    border-left: 5px solid #d70f21; /* Rojo Iberia */
}

.airline-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    border-bottom: 1px dashed #ccc;
    padding-bottom: 8px;
}

.airline-logo-text {
    font-weight: 800;
    color: #d70f21;
    font-size: 1.1em;
    letter-spacing: -0.5px;
}

.bag-specs {
    display: flex;
    justify-content: space-around;
    align-items: center;
    text-align: center;
}

.spec-item strong {
    display: block;
    font-size: 1.4em;
    color: #333;
}

.spec-item span {
    font-size: 0.8em;
    color: #777;
    text-transform: uppercase;
}

/* Regla de Oro visual */
.golden-rule-card {
    background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
    border-radius: 12px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    border: 1px solid #ddd;
}

.golden-rule-icon { font-size: 1.8em; margin-bottom: 5px; }
.golden-rule-text { font-size: 0.9em; color: #555; line-height: 1.4; }

/* Barra de progreso visual */
.mini-progress-container {
    margin-top: 10px;
    width: 100%;
    background: #e0e0e0;
    border-radius: 10px;
    height: 8px;
    overflow: hidden;
}

.mini-progress-bar {
    height: 100%;
    background: #27ae60;
    width: 0%;
    transition: width 0.5s ease;
}

/* Checklist Grid (Cuadr√≠cula de categor√≠as) */
.checklist-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 15px;
}

.checklist-category {
    background: #fff;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 15px;
    border-top: 3px solid #ccc; /* Color por defecto */
}

/* Colores tem√°ticos por categor√≠a */
.cat-docs { border-top-color: #3498db; } /* Azul */
.cat-gear { border-top-color: #e67e22; } /* Naranja */
.cat-meds { border-top-color: #e74c3c; } /* Rojo */
.cat-tech { border-top-color: #9b59b6; } /* Violeta */

.checklist-category h4 {
    margin-bottom: 12px;
    color: #2c3e50;
    font-size: 1em;
    font-weight: 700;
}

/* Items de la lista mejorados */
.check-item {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    font-size: 0.9em;
    color: #555;
    cursor: pointer;
    transition: all 0.2s;
}

.check-item:hover { color: #000; }

/* Checkbox personalizado (Cuadradito bonito) */
.check-item input {
    appearance: none;
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border: 2px solid #cbd5e0;
    border-radius: 4px;
    margin-right: 10px;
    position: relative;
    cursor: pointer;
    transition: all 0.2s;
    flex-shrink: 0; /* Evita que se aplaste si hay mucho texto */
}

.check-item input:checked {
    background-color: #27ae60;
    border-color: #27ae60;
}

/* El tick ‚úîÔ∏è */
.check-item input:checked::after {
    content: '‚úî';
    font-size: 12px;
    color: white;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/* Texto tachado al marcar */
.check-item input:checked + span {
    text-decoration: line-through;
    color: #a0aec0;
}

/* --- ESTILOS SOS FLOTANTE --- */
.btn-sos {
    position: fixed;
    bottom: 25px;
    right: 25px;
    width: 60px;
    height: 60px;
    background: #e74c3c;
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    z-index: 9999; /* Siempre encima de todo */
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s;
    animation: pulse-red 2s infinite;
}

.btn-sos:hover {
    transform: scale(1.1);
    background: #c0392b;
}

@keyframes pulse-red {
    0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); }
    70% { box-shadow: 0 0 0 15px rgba(231, 76, 60, 0); }
    100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
}

/* --- ESTILO BOT√ìN RUTA MAPA --- */
.btn-route-map {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    width: 100%;
    padding: 14px;
    margin-top: 20px;
    margin-bottom: 20px;
    background: #ffffff;
    border: 2px solid #4285f4;
    color: #4285f4;
    font-size: 1em;
    font-weight: bold;
    border-radius: 8px;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.btn-route-map:hover {
    background: #4285f4;
    color: white;
    box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
    transform: translateY(-2px);
}

/* --- CABECERA HERO STYLE (DISE√ëO NUEVO) --- */
header {
    background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.7)), 
                url('https://estaticos-cdn.prensaiberica.es/clip/6bbb0fed-2234-4eac-b78e-77702924fd41_alta-libre-aspect-ratio_default_0.jpg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    color: white;
    /* CAMBIO AQU√ç: Reducimos de 140px a 40px abajo */
    padding: 40px 20px 40px 20px; 
    margin-bottom: 30px;
    border-radius: 0 0 25px 25px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    position: relative;
    overflow: visible;
}

header h1 {
    font-size: 3em;
    margin-bottom: 15px;
    font-weight: 800;
    text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
    letter-spacing: -1px;
}

header p {
    font-size: 1.2em;
    opacity: 0.95;
    font-weight: 300;
    max-width: 700px;
    margin: 0 auto 30px auto;
    text-shadow: 1px 1px 4px rgba(0,0,0,0.5);
}

/* --- ESTAD√çSTICAS CON EFECTO CRISTAL (Glassmorphism) --- */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 15px;
    margin-top: 30px;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
}

.stat {
    background: rgba(255, 255, 255, 0.15); /* Fondo semitransparente */
    backdrop-filter: blur(10px); /* El truco del cristal borroso */
    -webkit-backdrop-filter: blur(10px);
    padding: 20px 10px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-left: none; /* Quitamos el borde naranja antiguo */
    transition: transform 0.3s ease;
}

.stat:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.25);
}

.stat-number {
    font-size: 2em;
    font-weight: 800;
    margin-bottom: 5px;
    color: #f1c40f; /* Amarillo dorado */
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
}

.stat-label {
    font-size: 0.85em;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.9;
    font-weight: 600;
}

/* --- CUENTA ATR√ÅS MEJORADA --- */
#countdown-container {
    background: rgba(0, 0, 0, 0.4) !important; /* M√°s oscuro */
    backdrop-filter: blur(5px);
    border: 1px solid rgba(255,255,255,0.1) !important;
    margin-top: 35px !important;
    padding: 20px 40px !important;
    border-radius: 50px !important; /* Forma de p√≠ldora */
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

/* --- AJUSTES ESPECIALES PARA M√ìVIL --- */
@media (max-width: 768px) {
    
    /* 1. Ajustar la Cabecera */
    header {
    padding: 30px 15px 40px 15px !important; 
}
    header h1 {
        font-size: 2.2em; /* T√≠tulo un poco m√°s peque√±o */
    }

    /* 2. Forzar que las cajas quepan en dos filas en m√≥vil */
.stats-grid {
            grid-template-columns: repeat(2, 1fr); /* Crea 2 columnas iguales */
            grid-template-rows: repeat(2, auto);   /* Crea 2 filas autom√°ticas */
            gap: 12px;
            margin-top: 25px;
            display: grid;
            width: 100%;
            max-width: 400px; /* Centra el bloque en el m√≥vil */
            margin-left: auto;
            margin-right: auto;
        }

.stat {
            padding: 15px 5px; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 90px; /* Les da una altura uniforme a todas */
        }

    .stat-number {
        font-size: 1.4em; /* N√∫meros ajustados */
    }

    .stat-label {
        font-size: 0.65em; /* Texto etiqueta m√°s peque√±o */
        white-space: nowrap; /* Evita que el texto ocupe dos l√≠neas */
    }

    /* 3. Cuenta atr√°s m√°s recogida */
    #countdown-container {
        width: 95%; /* Que no toque los bordes */
        padding: 12px !important;
        margin-left: auto !important;
        margin-right: auto !important;
        margin-top: 25px !important;
    }
    
    #countdown {
        font-size: 1.3em !important;
    }
}

/* --- FOOTER ORIGINAL Y CHULO --- */
footer {
    background: linear-gradient(rgba(44, 62, 80, 0.9), rgba(44, 62, 80, 0.95)), 
                url('https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=2000&auto=format&fit=crop');
    background-size: cover;
    background-position: center;
    background-attachment: fixed; /* Efecto Parallax */
    color: white;
    padding: 60px 20px 30px;
    margin-top: 50px;
    border-radius: 40px 40px 0 0;
    text-align: center;
}

.footer-content {
    max-width: 800px;
    margin: 0 auto;
}

.footer-quote {
    font-style: italic;
    font-size: 1.2em;
    margin-bottom: 25px;
    color: #f1c40f; /* Dorado */
}

.footer-nav {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

.footer-nav a {
    color: white;
    text-decoration: none;
    font-weight: 600;
    opacity: 0.8;
    transition: 0.3s;
}

.footer-nav a:hover {
    opacity: 1;
    color: #f1c40f;
}

.shell-icon { 
    width: 70px; 
    height: 70px; 
    margin-bottom: 20px; 
    filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3)); /* Sombra para darle volumen */
}

.copyright {
    font-size: 0.8em;
    opacity: 0.6;
    border-top: 1px solid rgba(255,255,255,0.1);
    padding-top: 20px;
}

/* --- BLOQUE DE CONTROLES CABECERA (TODO EN UNO) --- */

/* Contenedor Principal */
.controls-area {
    display: flex;
    flex-direction: column; /* Organiza en pisos */
    align-items: center;
    gap: 15px;
    margin-top: 30px;
    width: 100%;
    position: relative;
    z-index: 5;
}

/* Piso 1: Mochila y Selector */
.tools-row {
    display: flex;
    gap: 15px;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
}

/* Piso 2: Apps Externas (Tricount/Spotify) */
.apps-row {
    display: flex;
    gap: 15px;
    justify-content: center;
    width: 100%;
}

/* --- ESTILO SELECTOR (C√ÅPSULA DE CRISTAL) - VERSI√ìN CLARA --- */
.view-toggle-capsule {
    /* CAMBIO: Fondo gris muy claro (casi blanco) */
    background: #f1f2f6; 
    
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    padding: 5px;
    border-radius: 50px;
    display: flex;
    gap: 5px;
    
    /* CAMBIO: Borde gris sutil en vez de blanco */
    border: 1px solid #e1e1e1; 
    /* Sombra m√°s suave */
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05); 
}

.view-btn-pro {
    background: transparent;
    
    /* CAMBIO: Color de texto gris medio (para que se lea sobre el fondo claro) */
    color: #95a5a6; 
    
    border: none;
    padding: 8px 20px;
    border-radius: 40px;
    font-weight: 600;
    font-size: 0.85em;
    cursor: pointer;
    transition: all 0.3s;
}

.view-btn-pro.active {
    background: white;
    /* CAMBIO: Texto activo m√°s oscuro para contraste */
    color: #2c3e50; 
    font-weight: 800;
    /* Sombra suave para que el bot√≥n "salte" */
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
}

/* --- ESTILO APPS (P√çLDORAS) CON ICONOS REALES --- */
.btn-app {
    text-decoration: none;
    color: white;
    /* Ajustamos el padding para acomodar el icono */
    padding: 8px 20px 8px 15px; 
    border-radius: 50px;
    font-weight: 700;
    font-size: 0.9em;
    display: flex;
    align-items: center;
    gap: 10px; /* Espacio entre icono y texto */
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    border: 1px solid rgba(255,255,255,0.15);
    /* Efecto cristal sutil */
    backdrop-filter: blur(4px); 
}

/* Estilo para la imagen del icono */
.app-icon {
    width: 26px;  /* Tama√±o ideal para icono de app */
    height: 26px;
    object-fit: contain;
    /* Sombrita para que el logo destaque sobre el fondo del bot√≥n */
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
    transition: transform 0.3s ease;
}

/* Efecto Hover (Al pasar el rat√≥n) */
.btn-app:hover { 
    transform: translateY(-3px); 
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.btn-app:hover .app-icon {
    /* El icono hace un peque√±o baile al pasar el rat√≥n */
    transform: scale(1.15) rotate(5deg); 
}

/* Colores Espec√≠ficos */
.btn-tricount {
    /* Azul Tricount oficial */
    background: linear-gradient(135deg, #004e92 0%, #2b5876 100%); 
}

.btn-spotify {
    /* Verde Spotify y Negro */
    background: linear-gradient(135deg, #1DB954 0%, #101010 100%); 
}

/* Versi√≥n M√≥vil */
@media (max-width: 768px) {
    .tools-row { flex-direction: column; width: 100%; }
    .btn-mochila-pro { width: 80%; justify-content: center; }
}

/* --- EFECTO SELLO DE CREDENCIAL (CORREGIDO) --- */
/* Importante: Esto permite que el sello se coloque encima */
.etapa {
    position: relative; 
}

/* El Sello Rojo */
.etapa.completed::after {
    content: 'ETAPA\A COMPLETADA';
    white-space: pre;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(-15deg);
    
    border: 4px solid #c0392b;
    color: #c0392b;
    padding: 10px 20px;
    font-weight: 900;
    font-size: 1.5rem;
    text-transform: uppercase;
    text-align: center;
    line-height: 1.2;
    border-radius: 12px;
    
    opacity: 0.9;
    mix-blend-mode: multiply; /* Efecto tinta realista */
    pointer-events: none;     /* Permite hacer clic debajo */
    z-index: 100;
    box-shadow: inset 0 0 0 3px rgba(192, 57, 43, 0.4);
    
    animation: stamp-bounce 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* Animaci√≥n de golpe */
@keyframes stamp-bounce {
    0% { transform: translate(-50%, -50%) rotate(-15deg) scale(3); opacity: 0; }
    100% { transform: translate(-50%, -50%) rotate(-15deg) scale(1); opacity: 0.9; }
}
/* --- NUEVO SISTEMA PRO: C√çRCULOS Y ARMON√çA --- */

/* 1. Contenedor de Secci√≥n */
.modal-section {
    margin-bottom: 25px;
}

/* 2. T√≠tulos de Secci√≥n (Estilo Fino) */
.modal-section h3 {
    font-size: 1.15em;
    font-weight: 600; /* Menos negrita, m√°s elegante */
    color: #2c3e50;
    margin-bottom: 15px;
    display: block; /* Necesario para que el c√≠rculo funcione bien */
    border: none !important;
    padding: 0 !important;
}

/* 3. El C√≠rculo del Icono (La Magia) */
.modal-section h3::first-letter {
    color: rgba(0,0,0,0.8); /* El emoji se ve n√≠tido */
    padding: 8px 12px;      /* Espacio para crear el c√≠rculo */
    margin-right: 12px;     /* Separaci√≥n con el texto */
    border-radius: 50%;     /* Lo hace redondo */
    font-size: 1em;
    line-height: 1.5;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05); /* Sombra sutil al c√≠rculo */
    
    /* Estos valores se sobreescriben abajo seg√∫n el color */
    background: #eee; 
    border: 1px solid #ddd;
}

/* 4. Tarjeta Base (Dise√±o limpio) */
.pro-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.04);
    border: 1px solid rgba(0,0,0,0.05);
    border-left: 4px solid #ccc; /* L√≠nea de color a la izquierda */
    transition: transform 0.2s ease;
}

/* --- PALETA DE COLORES (C√≠rculo + Borde Tarjeta + Fondo Suave) --- */

/* ‚ö° DATOS R√ÅPIDOS (Azul Cian - Fondo Suave A√±adido) */
.theme-info h3::first-letter { background: #e0f7fa; border: 1px solid #b2ebf2; }
.theme-info .pro-card { 
    border-left-color: #00bcd4; 
    background: #f0fbff; /* ¬°Fondo azulito muy suave! */
}

/* üìç TRAMOS (Azul Marino) */
.theme-route h3::first-letter { background: #e3f2fd; border: 1px solid #bbdefb; }
.theme-route .pro-card, .theme-route .tramo { border-left-color: #1976d2; }

/* üè® ALOJAMIENTO (Verde Esmeralda - Fondo Suave A√±adido) */
.theme-sleep h3::first-letter { background: #e8f5e9; border: 1px solid #c8e6c9; }
.theme-sleep .pro-card, .theme-sleep .accommodation-card { 
    border-left-color: #2ecc71; 
    background: #f6fdf7; /* ¬°Fondo verde menta muy suave! */
}

/* ‚úçÔ∏è DIARIO (Violeta) */
.theme-diary h3::first-letter { background: #f3e5f5; border: 1px solid #e1bee7; }
.theme-diary .pro-card, .theme-diary .widget-card { border-left-color: #9b59b6; }

/* üçΩÔ∏è GASTRONOM√çA (Naranja) */
.theme-food h3::first-letter { background: #fff3e0; border: 1px solid #ffe0b2; }
.theme-food .pro-card { border-left-color: #e67e22; background: #fffbf5; }

/* üí∞ GASTOS (Dorado) */
.theme-money h3::first-letter { background: #fffde7; border: 1px solid #fff9c4; }
.theme-money .pro-card { border-left-color: #f1c40f; background: #fffff0; }

/* üì∏ FOTO (Magenta) */
.theme-photo h3::first-letter { background: #fce4ec; border: 1px solid #f8bbd0; }
.theme-photo .pro-card { border-left-color: #e91e63; }

/* ü§ì CURIOSIDADES (Turquesa) */
.theme-curious h3::first-letter { background: #e0f2f1; border: 1px solid #b2dfdb; }
.theme-curious .pro-card { border-left-color: #1abc9c; }

/* Bot√≥n Check-in Iberia */
.btn-checkin {
    display: block; /* Ocupa todo el ancho */
    width: 100%;
    margin-top: 12px;
    padding: 10px;
    background: #d70f21; /* Rojo corporativo */
    color: white;
    text-align: center;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 700;
    font-size: 0.9em;
    transition: background 0.2s ease, transform 0.2s;
    box-shadow: 0 2px 5px rgba(215, 15, 33, 0.2);
}

.btn-checkin:hover {
    background: #b30b1b; /* Rojo m√°s oscuro al pasar el rat√≥n */
    transform: translateY(-1px);
}

/* Bot√≥n WhatsApp Emergencia */
.btn-whatsapp-sos {
    display: block;
    width: 100%;
    background: #25D366; /* Verde WhatsApp */
    color: white;
    border: none;
    padding: 15px;
    border-radius: 10px;
    font-size: 1.1em;
    font-weight: bold;
    margin-bottom: 20px;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3);
    transition: transform 0.2s;
    text-decoration: none; /* Por si decidimos usar <a> */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.btn-whatsapp-sos:hover {
    background: #1ebc57;
    transform: scale(1.02);
}

.sos-divider {
    display: flex;
    align-items: center;
    text-align: center;
    color: #888;
    margin: 15px 0;
    font-size: 0.85em;
}
.sos-divider::before, .sos-divider::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid #ddd;
}
.sos-divider:not(:empty)::before { margin-right: .25em; }
.sos-divider:not(:empty)::after { margin-left: .25em; }

/* --- MODO NOCHE: CORRECTOR DE PORTADA --- */
body.dark-mode {
    background-color: #121212 !important; /* Fondo general muy oscuro */
    color: #e0e0e0;
}

/* 1. Tarjetas Principales (Las Etapas) */
body.dark-mode .etapa {
    background-color: #1e1e1e; /* Gris casi negro */
    box-shadow: 0 4px 15px rgba(0,0,0,0.5); /* Sombra m√°s oscura */
    border-left: 5px solid #e74c3c; /* Mantiene el color rojo */
}

/* 2. El t√≠tulo de la etapa */
body.dark-mode .etapa-title {
    color: #ffffff;
}

/* 3. ¬°EL ARREGLO CLAVE! Cajas de texto interiores */
/* Esto arregla los recuadros grises claros que se ve√≠an mal */
body.dark-mode .etapa-intro,
body.dark-mode .stat-box,
body.dark-mode .check-container,
body.dark-mode .tramo,
body.dark-mode .widget-card {
    background-color: #2d2d2d !important; /* Gris oscuro suave */
    border-color: #444;
    color: #ccc;
}

/* 4. Textos peque√±os y etiquetas */
body.dark-mode .meta-label,
body.dark-mode .stat-box-label {
    color: #aaa; /* Gris claro para que se lea bien */
}

body.dark-mode .meta-value,
body.dark-mode .stat-box-value {
    color: #fff; /* Blanco brillante */
}

/* 5. La barra de progreso superior (Credencial) */
body.dark-mode .progress-section {
    background-color: #1e1e1e;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
}

body.dark-mode .progress-label {
    color: #fff;
}

body.dark-mode .progress-bar-bg {
    background-color: #333;
}

/* 6. Modales (Ventanas emergentes) */
body.dark-mode .modal-panel {
    background-color: #1e1e1e;
    color: #ddd;
}

body.dark-mode .modal-header {
    background-color: #252525;
    border-bottom: 1px solid #333;
}

body.dark-mode .modal-header h2 {
    color: white;
}

body.dark-mode .pro-card {
    background-color: #2d2d2d !important;
    border-color: #444;
}

/* 7. Ajuste para los Inputs de gastos en modo noche */
body.dark-mode input.expense-input {
    background-color: #444;
    border-color: #555;
    color: white;
}

    </style>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<link rel="manifest" href="manifest.json?v=15">
<link rel="apple-touch-icon" href="logo-camino1.jpg">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">

</head>
<body>
    <div class="container">
        <header>
    <div class="logo-badge-pro">
       <img src="./logo-camino.png" alt="Logo Peregrinos" class="logo-img-real">
    </div>

    <h1 style="margin-bottom: 5px;">Nuestro Cami√±o</h1>

<p class="subtitle-pro" style="font-size: 1.1em; opacity: 0.95;">
    Xime ¬∑ Paty ¬∑ Modes ¬∑ Alex
    <br>
    <span style="font-size: 0.75em; color: #f1c40f; text-transform: uppercase; letter-spacing: 1px; margin-top: 8px; display: inline-block;">
        Ruta Portuguesa de la Costa ¬∑ 2026
    </span>
</p>
    
    <div class="stats-grid">
        <div class="stat"><div class="stat-number">241 km</div><div class="stat-label">Distancia Total</div></div>
        <div class="stat"><div class="stat-number">12 Etapas</div><div class="stat-label">Jornadas</div></div>
        <div class="stat"><div class="stat-number">8-10 d√≠as</div><div class="stat-label">Duraci√≥n Aprox.</div></div>
        <div class="stat" style="background: rgba(230, 126, 34, 0.3); border: 1px solid #e67e22;">
            <div class="stat-number" id="global-total-money">0.00‚Ç¨</div>
            <div class="stat-label">Presupuesto</div>
        </div>
    </div>

    <div id="countdown-container" style="background: rgba(0,0,0,0.3); padding: 8px 16px; border-radius: 50px; margin-top: 20px; display: inline-block; border: 1px solid rgba(255,255,255,0.15); backdrop-filter: blur(5px);">
        <span style="font-size: 0.75em; text-transform: uppercase; letter-spacing: 1px; opacity: 0.9;">‚è≥ Comienza en:</span>
        <div id="countdown" style="font-size: 1.2em; font-weight: 800; margin-top: 1px; color: #f1c40f;">
            Cargando...
        </div>
    </div>

    <div class="controls-area">
    <div class="apps-row" style="flex-wrap: wrap;"> <button onclick="openModal('modalMochila')" class="btn-app btn-mochila">
            <img src="https://cdn-icons-png.flaticon.com/512/2662/2662503.png" alt="Mochila" class="app-icon">
            <span>Mochila</span>
        </button>

        <a href="https://tricount.com/ttpkwRQfUInLcPVXHb" target="_blank" class="btn-app btn-tricount">
            <img src="https://t1.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=https://tricount.com&size=128" alt="Tricount" class="app-icon">
            <span>Tricount</span>
        </a>

        <a href="https://open.spotify.com/playlist/7Akw7DCeq3bTUNXQ69pcVc?si=2IK1mTG4QUCY3NtyTP01Cw&pt=473465e8068564a44586aed89baed87f&pi=gPtd8AuXQP6-8" target="_blank" class="btn-app btn-spotify">
            <img src="https://upload.wikimedia.org/wikipedia/commons/1/19/Spotify_logo_without_text.svg" alt="Spotify" class="app-icon">
            <span>M√∫sica</span>
        </a>

        <button onclick="toggleTheme()" class="btn-app" style="background: linear-gradient(135deg, #2c3e50 0%, #000000 100%); border: 1px solid rgba(255,255,255,0.2);">
    <span style="font-size: 1.2em;">üåô</span>
    <span>Modo Noche</span>
</button>

    </div>
</div>

    </div>
</header>

        <div class="progress-section">
    <div class="progress-label" style="align-items: center; margin-bottom: 15px;">
    <span style="display: flex; align-items: center; gap: 12px; font-size: 1.15em; color: #2c3e50;">
        <svg width="34" height="34" viewBox="0 0 100 100" style="box-shadow: 0 2px 5px rgba(0,0,0,0.15); border-radius: 6px; border: 2px solid #fff;">
            <rect width="100" height="100" fill="#005eb8"/> <path d="M50 85 C 50 85, 50 20, 50 20" stroke="#ffdd00" stroke-width="8" stroke-linecap="round" fill="none"/>
            <path d="M50 85 C 50 85, 20 25, 20 25" stroke="#ffdd00" stroke-width="8" stroke-linecap="round" fill="none"/>
            <path d="M50 85 C 50 85, 80 25, 80 25" stroke="#ffdd00" stroke-width="8" stroke-linecap="round" fill="none"/>
            <path d="M50 85 C 50 85, 2 55, 2 55" stroke="#ffdd00" stroke-width="8" stroke-linecap="round" fill="none"/>
            <path d="M50 85 C 50 85, 98 55, 98 55" stroke="#ffdd00" stroke-width="8" stroke-linecap="round" fill="none"/>
        </svg>
        Tu Credencial Digital
    </span>
    <span id="progressText" style="font-size: 0.85em; background: #ecf0f1; padding: 5px 12px; border-radius: 15px; color: #7f8c8d;">0/9 Etapas</span>
</div>

    <div class="progress-bar-bg">
        <div class="progress-bar-fill" id="progressBar">0%</div>
    </div>
</div>
<div class="view-toggle-bar">
    <div class="view-toggle-capsule">
        <button class="view-btn-pro active" onclick="switchView('detail', this)">ü™™ Tarjetas</button>
        <button class="view-btn-pro" onclick="switchView('list', this)">üìã Lista</button>
    </div>
</div>
        <div class="etapas-container">
            <!-- ETAPA 1 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 1: Oporto ‚Üí Labruge</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">24,1 km</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">6h</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">üü¢ Baja</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>La jornada inicial plantea una disyuntiva: seguir la orilla del r√≠o Duero y las playas del litoral atl√°ntico, en un recorrido variado y entretenido, o bien optar por el trazado interior por Padr√£o da L√©gua y el aeropuerto, sin alicientes y donde no veremos el mar en ning√∫n momento. Trat√°ndose de la primera etapa del Camino Portugu√©s de la Costa, la mayor√≠a de peregrinos lo tienen muy claro: <strong>r√≠o y playas</strong>.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">6h</div><div class="stat-box-label">Duraci√≥n Estimada</div></div>
                    <div class="stat-box"><div class="stat-box-value">Baja</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa1" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa1')">Ver detalles de la etapa</button>
            </div>

            <!-- ETAPA 2 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 2: Labruge ‚Üí P√≥voa de Varzim</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">14 km</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">3h 30m</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">üü¢ Muy Baja</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>Contin√∫a nuestro recorrido por las atractivas playas del litoral atl√°ntico, a trav√©s de pasarelas de madera sobre las dunas. Tras cruzar el puente sobre el r√≠o Ave entraremos en Vila do Conde, cuyo casco hist√≥rico no podemos dejar de visitar. Al final de esta corta etapa nos espera P√≥voa de Varzim, localidad cosmopolita, abocada al mar y con m√∫ltiples ofertas de ocio.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">3h 30m</div><div class="stat-box-label">Duraci√≥n Estimada</div></div>
                    <div class="stat-box"><div class="stat-box-value">Muy Baja</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa2" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa2')">Ver detalles de la etapa</button>
            </div>

            <!-- ETAPA 3 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 3: P√≥voa de Varzim ‚Üí Marinhas</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">24,5 km</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">6h</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">üü¢ Baja</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>Hoy nos espera una jornada variada, que comienza recorriendo la costa para despu√©s virar ligeramente hacia el interior, en direcci√≥n a F√£o y su puente sobre el r√≠o C√°davo. Probablemente no sea la etapa m√°s bonita, pero tiene un poco de todo: paseos mar√≠timos, playas con pasarelas de madera, alg√∫n tramo sombreado por camino de tierra y, para desgracia nuestra, bastantes aceras y adoquines.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">6h</div><div class="stat-box-label">Duraci√≥n Estimada</div></div>
                    <div class="stat-box"><div class="stat-box-value">Baja</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa3" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa3')">Ver detalles de la etapa</button>
            </div>

            <!-- ETAPA 4 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 4: Marinhas ‚Üí Viana do Castelo</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">20,8 km</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">5h 15m</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">üü¢ Baja</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>La jornada de hoy discurre √≠ntegramente por el interior, sin pisar ni una playa. Sin embargo cuenta con alguno de los paisajes m√°s bellos de este camino, como el sendero que baja hasta el cauce del r√≠o Neiva. El paso de dicho r√≠o, por una plataforma de losas de piedra, quedar√° grabado en nuestra memoria. Una vez en Viana do Castelo os proponemos visitar sin prisas su interesante casco hist√≥rico.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">5h 15m</div><div class="stat-box-label">Duraci√≥n Estimada</div></div>
                    <div class="stat-box"><div class="stat-box-value">Baja</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa4" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa4')">Ver detalles de la etapa</button>
            </div>

            <!-- ETAPA 5 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 5: Viana do Castelo ‚Üí Caminha</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">26,8 km</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">6h 30m</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">üü° Media</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>Hoy ser√° nuestra √∫ltima jornada en Portugal. Desde Viana podemos seguir el camino oficial que va por el interior, o bien optar por el litoral, sin flechas pero con playas. Una vez en Vila Praia de √Çncora nos espera un paseo sin desniveles hasta Caminha, localidad donde algunos dar√°n por finalizada la etapa, mientras que otros tomar√°n hoy mismo el ferry que cruza el r√≠o Mi√±o hacia Galicia.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">6h 30m</div><div class="stat-box-label">Duraci√≥n Estimada</div></div>
                    <div class="stat-box"><div class="stat-box-value">Media</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa5" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa5')">Ver detalles de la etapa</button>
            </div>

            <!-- ETAPA 6 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 6: Caminha ‚Üí Porto Moug√°s</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">23,5 km</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">5h 40m</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">üü¢ Baja</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>La primera jornada de este camino en Galicia nos depara tramos muy bellos junto al mar, por un paisaje agreste, expuesto al viento y a los temporales. Adem√°s de los diferentes miradores ante el oc√©ano, ser√°n paradas obligadas A Guarda, preciosa villa marinera, y Oia, con el imponente edificio de su monasterio abocado sobre la playa.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">5h 40m</div><div class="stat-box-label">Duraci√≥n Estimada</div></div>
                    <div class="stat-box"><div class="stat-box-value">Baja</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa6" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa6')">Ver detalles de la etapa</button>
            </div>

            <!-- ETAPA 7 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 7: Porto Moug√°s ‚Üí Baiona</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">11,5 km</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">4h</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">üü¢ Muy Baja</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>Si la jornada anterior era bonita, la de hoy tambi√©n resultar√° muy atractiva y variada: comenzaremos nuestro camino junto a la costa, disfrutaremos de un precioso tramo por monte con vistas sobre un faro, y poco despu√©s descubriremos Baiona, una villa que enamora. Por supuesto podemos dar por finalizada la etapa all√≠, o bien prolongarla unos kil√≥metros m√°s hasta la localidad de Baiona.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">4h</div><div class="stat-box-label">Duraci√≥n Estimada</div></div>
                    <div class="stat-box"><div class="stat-box-value">Muy Baja</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa7" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa7')">Ver detalles de la etapa</button>
            </div>

            <!-- ETAPA 8 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 8: Baiona ‚Üí Padr√≥n (Transporte + Descanso)</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">Flex</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">2 d√≠as</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">‚≠ê Relax</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>Etapa de descanso en Baiona con visita a las Islas C√≠es y exploraci√≥n de la villa. El segundo d√≠a utilizaremos transporte p√∫blico para llegar a Padr√≥n, punto de partida para nuestra √∫ltima etapa hacia Santiago de Compostela. Tiempo para recuperarse y disfrutar de la gastronom√≠a local antes del tramo final del camino.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">2 noches</div><div class="stat-box-label">Alojamiento en Baiona</div></div>
                    <div class="stat-box"><div class="stat-box-value">Relax</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa8" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa8')">Ver detalles de la etapa</button>
            </div>
            <!-- ETAPA 9 CARD -->
            <div class="etapa">
                <div class="etapa-header">
                    <h2 class="etapa-title">Etapa 9 Padr√≥n - Santiago de Compostela</h2>
                    <div class="etapa-meta">
                        <div class="meta-item"><span class="meta-label">Distancia:</span><span class="meta-value">24,3 km</span></div>
                        <div class="meta-item"><span class="meta-label">Duraci√≥n:</span><span class="meta-value">6h</span></div>
                        <div class="meta-item"><span class="meta-label">Dificultad:</span><span class="meta-value">üü¢Baja</span></div>
                    </div>
                </div>
                <div class="etapa-intro"><p>Esta √∫ltima etapa del Camino Portugu√©s transcurre en buena parte por asfalto y zonas urbanizadas, siguiendo, c√≥mo no, la nacional N-550, la cual hoy cruzamos hasta cuatro veces. En cuanto a desniveles, cabe mencionar el moderado y progresivo ascenso al Agro dos Monteiros, en O Milladoiro. En el √°mbito cultural, aparte de Santiago con su extraordinaria catedral, cabe destacar la bella colegiata de Iria Flavia.</p></div>
                <div class="etapa-stats">
                    <div class="stat-box"><div class="stat-box-value">6h</div><div class="stat-box-label">Duraci√≥n Estimada</div></div>
                    <div class="stat-box"><div class="stat-box-value">Baja</div><div class="stat-box-label">Dificultad</div></div>
                </div>
                <div class="check-container">
    <span class="check-label">¬øEtapa completada?</span>
    <label class="switch">
        <input type="checkbox" class="etapa-checkbox" data-id="etapa9" onchange="updateProgress()">
        <span class="slider"></span>
    </label>
</div>
                <button class="btn-modal" onclick="openModal('modalEtapa9')">Ver detalles de la etapa</button>
            </div>
        </div>
    </div>


    <!-- MODAL ETAPA 8 -->
    <div class="modal-backdrop" id="modalEtapa8">
    <div class="modal-panel">
        
        <div class="modal-header">
            <h2>Etapa 8: Baiona ‚Üí Padr√≥n - Descanso y Transici√≥n</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa8')">√ó</button>
        </div>

        <div class="modal-body">
            
            <div class="modal-left">

                <div class="widget-card" id="weather-etapa8" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Tipo de etapa:</strong> Descanso y transporte</li>
                            <li><strong>Duraci√≥n:</strong> 2 d√≠as completos</li>
                            <li><strong>Dificultad:</strong> Relax - Sin caminata</li>
                            <li><strong>Alojamiento:</strong> 2 noches (07-09/06 en Baiona)</li>
                            <li><strong>Transporte:</strong> Autob√∫s p√∫blico Baiona ‚Üí Padr√≥n</li>
                            <li><strong>Distancia caminable:</strong> A elecci√≥n personal</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-route">
                    <h3>üìç Actividades y Puntos de Inter√©s</h3>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>üèñÔ∏è D√≠a 1: Exploraci√≥n de Baiona</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">Completo</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p><strong>Ma√±ana - Paseo por el casco hist√≥rico:</strong> Visita la Praza do Consello (Ayuntamiento), recorre las calles medievales del casco viejo con sus coloridas casas marineras. Descubre el cruceiro da Sant√≠sima Trinidade del siglo XV, la excolegiata de Santa Mar√≠a y la capilla de Santa Liberata.</p>
                            <p><strong>Tarde - Paseo mar√≠timo:</strong> Disfruta del paseo mar√≠timo con vistas a la bah√≠a. Visita la r√©plica de la carabela Pinta en el puerto, que conmemora el descubrimiento del Nuevo Mundo en 1493. Descansa en los miradores con vistas a las Islas C√≠es.</p>
                            <p><strong>Gastronom√≠a:</strong> Degustation de pulpo a la gallega, percebes del Cabo Silleiro, n√©coras y otros productos del mar. Prueba los vinos locales de la comarca de Pontevedra.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç BAIONA - D√çA 1</div>
                                <div class="distancia-acumulada">Descanso y exploraci√≥n cultural</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>üåä D√≠a 2 (Ma√±ana): Islas C√≠es</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">Ferry</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p><strong>Excursi√≥n a las Islas C√≠es:</strong> Toma el ferry desde el puerto de Baiona hacia las Islas C√≠es (aproximadamente 30-40 minutos). Estas islas, parte del Parque Nacional de las Islas Atl√°nticas, ofrecen playas paradis√≠acas de arena blanca y agua cristalina.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/10/61/44/ba/photo1jpg.jpg?w=1200&h=-1&s=1" alt="Islas C√≠es" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Islas C√≠es
                                </figcaption>
                            </figure>
                            <p><strong>Actividades en las islas:</strong> Ba√±o en la Playa de Rodas (considerada una de las mejores playas de Espa√±a), senderismo entre pinos, observaci√≥n de aves marinas, fotograf√≠a del paisaje virgen. Las islas son refugio de gaviota patiamarilla y foca monje.</p>
                            <p><strong>Informaci√≥n pr√°ctica:</strong> El acceso a las islas es limitado por razones de conservaci√≥n. Se recomienda reservar billete con antelaci√≥n en el puerto. Traer protecci√≥n solar, agua y snorkel opcional.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üèùÔ∏è ISLAS C√çES</div>
                                <div class="distancia-acumulada">Parque Nacional - Excursi√≥n recomendada</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>üöå D√≠a 2 (Tarde): Transporte a Padr√≥n</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">Autob√∫s</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p><strong>Retorno de las islas y traslado:</strong> Toma el ferry de regreso a Baiona (√∫ltima salida t√≠picamente a las 18:00). Desde el puerto, dir√≠gete a la estaci√≥n de autob√∫s de Baiona.</p>
                            <p><strong>Autob√∫s Baiona ‚Üí Padr√≥n:</strong> Toma un autob√∫s de l√≠nea regular (operadores: Autobuses Castromil o similares, aproximadamente 1 hora y 30 minutos de trayecto). La ruta recorre el interior de Galicia con vistas a paisajes verdes y pueblos t√≠picos gallegos.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://petiscosgalegos.es/wp-content/uploads/2025/02/puente-de-santiago-de-padron-con-vistas-al-convento-do-carme-a-coruna.jpg" alt="Padr√≥n" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Padr√≥n
                                </figcaption>
                            </figure>
                            <p><strong>Llegada a Padr√≥n:</strong> Padr√≥n es famoso por sus pimientos, peque√±os y picantes. A tu llegada, inst√°late en el alojamiento y disfruta de la tarde explorando este pueblo tradicional. La plaza principal de Padr√≥n conserva su encanto medieval.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">‚úÖ PADR√ìN - PUNTO DE PARTIDA PARA √öLTIMA ETAPA</div>
                                <div class="distancia-acumulada">Preparaci√≥n para Santiago de Compostela</div>
                            </div>
                        </div>
                    </div>

                    <div id="map-etapa8" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa8()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Mapa Trayecto (Bus)</button>

                    <div class="modal-section theme-photo" style="margin-top: 25px;">
                        <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                        <div class="pro-card">
                            <div id="photo-container-etapa8" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                                <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="document.getElementById('input-photo-etapa8').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üì∑ Seleccionar Foto</button>
                                <button onclick="removePhoto('etapa8')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer;">üóëÔ∏è Borrar</button>
                            </div>
                            <input type="file" id="input-photo-etapa8" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa8', this)">
                        </div>
                    </div>

                </div> 
            </div> <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü O SECRETO *** (Padr√≥n)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 09/06/2026 ‚Äì 10/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Duraci√≥n:</strong> 1 noche en Padr√≥n</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 200m del centro de Padr√≥n</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Apartamento entero</div>
                            <div class="accommodation-detail-line"><strong>Camas:</strong> 1 doble + 2 individuales</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size: 1.1em; font-weight: bold; color: #27ae60;">100‚Ç¨</span></div>
                            <div class="accommodation-detail-line" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(0,0,0,0.1);"><strong>Nota:</strong> Estas 2 noches tambi√©n incluyen alojamiento en Baiona (anteriormente contratado)</div>
                        </div>
                        <a href="https://www.booking.com/Share-ZjPVJQ" target="_blank" class="btn-alojamiento">Ver alojamiento en Booking</a>
                    </div>
                </div>

                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa8">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="‚úçÔ∏è Notas personales..." oninput="saveDiary('etapa8', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa8">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p><strong>Especialidades de Padr√≥n:</strong></p>
                        <ul style="padding-left: 20px;">
                            <li><strong>Pimientos de Padr√≥n</strong> - DOP, peque√±os y picantes (los "que pican, que pican")</li>
                            <li>Preparados a la sart√©n con sal marina</li>
                            <li>Quesos locales gallegos</li>
                            <li>Vinos de la D.O. R√≠as Baixas</li>
                            <li>Empanadas gallegas</li>
                            <li>Pulpo a la gallega</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üéí Otros / Varios (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #f9e79f; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent8">
                                <p><strong>ISLAS C√çES - PARQUE NACIONAL</strong><br>
                                Las Islas C√≠es son parte del Parque Nacional Mar√≠timo-Terrestre de las Islas Atl√°nticas de Galicia, declaradas as√≠ en 2002. Forman un archipi√©lago con tres islas principales: Monteagudo, San Marti√±o y O Faro. Su belleza natural es excepcional, con playas v√≠rgenes de arena blanca y aguas cristalinas del Atl√°ntico norte. La Playa de Rodas es considerada una de las mejores playas de Espa√±a, con casi 1 km de arena fina.<br><br>
                                Durante la visita es posible ver especies end√©micas de plantas y aves marinas. Los acantilados albergan colonias de gaviota patiamarilla y cormor√°n mo√±udo. El faro de C√≠es, construido en 1860, sigue siendo un punto de referencia para la navegaci√≥n.<br><br>
                                <strong>BAIONA - HISTORIA Y PATRIMONIO</strong><br>
                                Baiona es una villa medieval hist√≥rica, conocida mundialmente por ser el primer puerto europeo donde se recibi√≥ la noticia del descubrimiento de Am√©rica. El 1 de marzo de 1493, la carabela Pinta, capitaneada por Mart√≠n Alonso Pinz√≥n, arribar√≠a a Baiona trayendo las primeras noticias del viaje de Col√≥n. La r√©plica de la carabela Pinta se encuentra en el puerto y es visitable, permitiendo una experiencia inmersiva en la era de los grandes descubrimientos.<br><br>
                                El casco antiguo de Baiona conserva su trazado medieval con calles estrechas, casas marineras de colores y monumentos hist√≥ricos. La Praza do Consello es el coraz√≥n de la villa, rodeada de edificios hist√≥ricos. Cada marzo, Baiona celebra la llegada de la Pinta con una fiesta medieval multitudinaria.<br><br>
                                <strong>PADR√ìN - CAPITAL DE UN TESORO CULINARIO</strong><br>
                                Padr√≥n es mundialmente famoso por sus pimientos, peque√±os y verdes, con un sabor √∫nico que oscila entre lo dulce y lo picante. El dicho popular "Os pementos de Padr√≥n, uns pican e outros non" (Los pimientos de Padr√≥n, unos pican y otros no) refleja la sorpresa y la emoci√≥n de degustarlos. Estos pimientos tienen Denominaci√≥n de Origen Protegida (DOP) desde 2003.<br><br>
                                La tradici√≥n de cultivar pimientos en Padr√≥n se remonta al siglo XVI, cuando los monjes franciscanos los trajeron desde Am√©rica. El clima especial de la zona, con influencia de la proximidad al Atl√°ntico, produce pimientos con caracter√≠sticas √∫nicas.<br><br>
                                El pueblo de Padr√≥n es peque√±o y encantador, con una fuerte tradici√≥n agr√≠cola. Su plaza mayor mantiene la estructura medieval, y durante los meses de agosto y septiembre, se celebra la Festa do Pimiento, con degustaciones, concursos y actividades gastron√≥micas.<br><br>
                                <strong>TRANSICI√ìN HACIA SANTIAGO</strong><br>
                                Padr√≥n es un punto estrat√©gico para acceder a la ruta final hacia Santiago de Compostela. Desde aqu√≠, se puede continuar con la √∫ltima etapa del Camino Portugu√©s de la Costa, conectando con rutas secundarias que llevan hacia la capital compostelana. La distancia desde Padr√≥n a Santiago es de aproximadamente 50 km, un recorrido que completa la peregrinaci√≥n.<br><br>
                                La regi√≥n de O Saln√©s (donde se ubica Padr√≥n) es tambi√©n famosa por sus vinos blancos frescos, especialmente los Albari√±o de las R√≠as Baixas, que acompa√±an perfectamente los productos locales.<br><br>
                                Esta etapa de descanso es fundamental para recuperar fuerzas antes del √∫ltimo tramo hacia el ap√≥stol Santiago. Padr√≥n ofrece la combinaci√≥n perfecta de descanso gastron√≥mico, tranquilidad rural y preparaci√≥n espiritual para la meta final del camino.</p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent8', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div> </div> </div> </div> ```

    <div class="modal-backdrop" id="modalMochila">
    <div class="modal-panel" style="max-width: 850px;"> <div class="modal-header" style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); border-bottom: none;">
            <h2 style="color: #E65100; display: flex; align-items: center; gap: 10px;">
                üéí Mochila & Vuelo
            </h2>
            <button class="modal-close" onclick="closeModal('modalMochila')">√ó</button>
        </div>

        <div class="modal-body" style="background-color: #fafafa; display: block;"> 
            
            <div class="backpack-header-grid">
                
                <div class="airline-card">
    <div class="airline-header">
        <span class="airline-logo-text">IBERIA</span>
        <span style="font-size: 0.75em; background: #eee; padding: 2px 6px; border-radius: 4px; color: #555;">Equipaje Cabina</span>
    </div>
    
    <div class="bag-specs">
        <div class="spec-item">
            <span style="font-size: 1.8em;">‚öñÔ∏è</span>
            <strong>10 kg</strong>
            <span>Peso M√°x</span>
        </div>
        <div style="border-right: 1px solid #eee; height: 40px;"></div>
        <div class="spec-item">
            <span style="font-size: 1.8em;">üìè</span>
            <strong>56x40x25</strong>
            <span>Cent√≠metros</span>
        </div>
    </div>
    
    <div style="margin-top: 8px; font-size: 0.75em; color: #999; text-align: center; margin-bottom: 5px;">
        *Incluye asas, bolsillos y ruedas.
    </div>

    <a href="https://www.iberia.com/es/autocheckin/" target="_blank" class="btn-checkin">
        üì≤ Hacer Check-in Online
    </a>
</div>

                <div class="golden-rule-card">
                    <div class="golden-rule-icon">‚öñÔ∏è</div>
                    <div class="golden-rule-text">
                        <strong>Regla del 10%:</strong><br>
                        Tu mochila no deber√≠a pesar m√°s de 7-8 kg para caminar c√≥modo.
                    </div>
                    
                    <div style="width: 100%; margin-top: 15px; text-align: left;">
                        <div style="display: flex; justify-content: space-between; font-size: 0.8em; font-weight: bold; color: #555; margin-bottom: 4px;">
                            <span>Estado de la mochila</span>
                            <span id="backpack-progress-text">0%</span>
                        </div>
                        <div class="mini-progress-container">
                            <div class="mini-progress-bar" id="backpack-progress-bar"></div>
                        </div>
                    </div>
                </div>
            </div>

            <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">

            <div class="checklist-grid">
                
                <div class="checklist-category cat-docs">
                    <h4>üìÇ Documentaci√≥n</h4>
                    <label class="check-item"><input type="checkbox" id="bp_dni" onchange="updateBackpackPro()"><span>DNI / Pasaporte</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_credencial" onchange="updateBackpackPro()"><span>Credencial Peregrino</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_seguro" onchange="updateBackpackPro()"><span>Tarjeta Sanitaria</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_dinero" onchange="updateBackpackPro()"><span>Efectivo / Tarjetas</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_billetes" onchange="updateBackpackPro()"><span>Billetes Avi√≥n (PDF)</span></label>
                </div>

                <div class="checklist-category cat-gear">
                    <h4>ü•æ Equipo B√°sico</h4>
                    <label class="check-item"><input type="checkbox" id="bp_botas" onchange="updateBackpackPro()"><span>Calzado de trekking (domado)</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_chanclas" onchange="updateBackpackPro()"><span>Chanclas ducha/descanso</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_saco" onchange="updateBackpackPro()"><span>Chubasquero / Funda Mochila</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_mochila" onchange="updateBackpackPro()"><span>Mochila (30-40L)</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_cantimplora" onchange="updateBackpackPro()"><span>Cantimplora/Agua</span></label>
                </div>

                <div class="checklist-category cat-meds">
                    <h4>üíä Botiqu√≠n & Aseo</h4>
                    <label class="check-item"><input type="checkbox" id="bp_compeed" onchange="updateBackpackPro()"><span>Compeed / Aguja</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_vaselina" onchange="updateBackpackPro()"><span>Vaselina</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_solar" onchange="updateBackpackPro()"><span>Crema Solar / Gorra</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_jabon" onchange="updateBackpackPro()"><span>Jab√≥n Pastilla cuerpo/ropa</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_toalla" onchange="updateBackpackPro()"><span>Toalla Microfibra</span></label>
                </div>
                
                <div class="checklist-category cat-tech">
                    <h4>üì± Tecnolog√≠a</h4>
                    <label class="check-item"><input type="checkbox" id="bp_movil" onchange="updateBackpackPro()"><span>M√≥vil + Cargador</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_power" onchange="updateBackpackPro()"><span>Powerbank</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_auriculares" onchange="updateBackpackPro()"><span>Auriculares</span></label>
                    <label class="check-item"><input type="checkbox" id="bp_ladron" onchange="updateBackpackPro()"><span>Ladr√≥n (Enchufes)</span></label>
                </div>

            </div>

        </div>
    </div>
</div>

<!-- MODAL ETAPA 1 (COMPLETO CON TODOS LOS 6 TRAMOS) -->
    <div class="modal-backdrop" id="modalEtapa1">
    <div class="modal-panel">
        <div class="modal-header">
            <h2>Etapa 1: Oporto ‚Üí Labruge - Detalles Completos</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa1')">√ó</button>
        </div>

        <div class="modal-body">
            <div class="modal-left">
                
                <div class="widget-card" id="weather-etapa1" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Distancia:</strong> 24,1 km</li>
                            <li><strong>Duraci√≥n estimada:</strong> 6 horas</li>
                            <li><strong>Dificultad:</strong> Baja</li>
                            <li><strong>Tipo de etapa:</strong> Costera, muy esc√©nica</li>
                            <li><strong>Pavimento:</strong> Paseos mar√≠timos, pasarelas de madera y tramos urbanos</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-elevation">
    <h3>‚õ∞Ô∏è Perfil de la Etapa</h3>
    <div class="pro-card">
        <div style="height: 200px; width: 100%;">
            <canvas id="elevation-etapa1"></canvas> 
        </div>
        <p style="font-size: 0.8em; color: #777; text-align: center; margin-top: 5px;">
            üìà Desnivel acumulado: <span id="gain-etapa1">--</span>m
        </p>
    </div>
</div>

                <div class="modal-section theme-route">
                    <h3>üìç Tramos y Puntos de Parada</h3>
                    
                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 1: Oporto ‚Üí Foz de Douro</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">6,1 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://oportoando.com/wp-content/uploads/sites/12/2018/02/barrio-se-oporto-1-1024x683.jpeg" alt="S√© de Oporto" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Inicio de la aventura: La Catedral de Oporto (S√© de Oporto)
                                </figcaption>
                            </figure>
                            <p>Esta primera etapa del Camino Portugu√©s por la Costa parte de la ciudad de Oporto, la segunda m√°s grande de Portugal y una de las principales de la Pen√≠nsula Ib√©rica, y termina en Labruge, con una distancia total de 24 km totalmente pegados a la costa.</p>
                            <p>Salvo que ya la hayamos visitado el d√≠a anterior, el punto tradicional de salida de los peregrinos ser√≠a desde la catedral de Oporto, la <strong>"S√©-catedral"</strong>. A partir de aqu√≠ s√≥lo tenemos que bajar a la ribera del r√≠o Duero (Douro), sin hacer caso de las flechas amarillas ni de las placas met√°licas que han colocado (pues √©stas conducen hacia el "trazado hist√≥rico", que no va por la costa).</p>
                            <p>Tras bajar a nuestro aire por las calles empedradas del casco antiguo llegaremos al <strong>Cais da Ribeira</strong>, muelle al pie del gran puente met√°lico de D. Lu√≠s I, y a la inmediata Pra√ßa da Ribeira, siempre muy concurrida por turistas y locales.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://oportoando.com/wp-content/uploads/sites/12/2018/03/puente-don-luis-oporto-1-1024x683.jpeg" alt="Puente Don Luis I" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Puente Don Luis I
                                </figcaption>
                            </figure>
                            <p>Sin flechas ‚Äìni falta que hace, pues es imposible perderse‚Äì seguiremos un recorrido muy ameno por todo el margen del r√≠o Douro en direcci√≥n hacia su desembocadura. Pasaremos junto a la iglesia de S√£o Francisco, despu√©s ante la antigua aduana o Alf√¢ndega, el museo del Vino de Porto y tambi√©n bajo el inmenso arco del puente da Arr√°bida. En este tramo encontraremos a menudo runners, ciclistas y paseantes; m√°s de uno nos desear√° "Bom caminho" al vernos con la mochila.</p>
                            <p>En <strong>Foz de Douro</strong> superamos el farol (faro) de S√£o Miguel, los jardines do Passeio Alegre y llegamos al fuerte de S√£o Jo√£o Baptista, donde desemboca el Duero y aparece frente a nosotros el <strong>oc√©ano Atl√°ntico</strong>.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç FOZ DO DOURO</div>
                                <div class="distancia-acumulada">Distancia acumulada: 6,1 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 2: Foz de Douro ‚Üí Matosinhos</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">5,2 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Comienza aqu√≠ un largo tramo por la fachada mar√≠tima del barrio de Nevogilde, la Copacabana de Porto, pasando ante las concurridas playas de Ourigo, Ingleses, da Luz, Molhe‚Ä¶ Al final llegamos al fuerte de S√£o Francisco Xavier, m√°s conocido como <strong>Castelo do Queijo</strong> (castillo del queso), donde comienza la extensa playa de Matosinhos, muy frecuentada por surfistas.</p>
                            <p>A partir de aqu√≠ es probable que encontremos alguna flecha amarilla, pero no hay que agobiarse busc√°ndolas pues el recorrido es intuitivo.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://porto-north-portugal.com/images/650x450/castelo-do-queijo-matosinhos.jpg" alt="Castelo do Queijo" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Castelo do Queijo (Castillo del Queso)
                                </figcaption>
                            </figure>
                            <p>Superamos una rotonda de forma el√≠ptica con una curiosa escultura colgante que simboliza una red de pesca, si bien es m√°s conocida como la An√©mona; al final de la playa tenemos otra escultura, √©sta figurativa, titulada Trag√©dia do Mar y dedicada al desastre acaecido aqu√≠ una noche de diciembre de 1947, donde naufragaron varios barcos de pesca y murieron 152 marineros.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://lifecooler.com/files/registos/imagens/429139/240627.jpg" alt="Trag√©dia do Mar" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Trag√©dia do Mar - 1947
                                </figcaption>
                            </figure>
                            <p>Podemos seguir por el puerto o por las calles interiores hasta llegar a la parada de metro de Mercado, de la l√≠nea A-azul (ojo, pues el metro en Porto va casi siempre por superficie, parecido a un tranv√≠a largo).</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç MATOSINHOS</div>
                                <div class="distancia-acumulada">Distancia acumulada: 11,3 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 3: Matosinhos ‚Üí Le√ßa da Palmeira</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">1,3 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.leca-palmeira.com/wordpress/wp-content/uploads/2026/01/Ponte-Movel-de-Leixoes.webp" alt="Ponte M√≥vel de Leix√µes" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Ponte M√≥vel de Leix√µes
                                </figcaption>
                            </figure>
                            <p>Cruzamos el <strong>Ponte M√≥vel</strong> (puente levadizo) sobre el puerto de Leix√µes que, aunque no lo parezca, es tambi√©n la desembocadura del r√≠o Le√ßa. En la rampa o escaleras que suben al puente ‚Äìy tambi√©n al cruzarlo‚Äì encontraremos flechas pintadas. Tras cruzar el puente entramos en Le√ßa da Palmeira, un barrio perteneciente al municipio de Matosinhos.</p>
                            <p>Al final del puente giramos a la izquierda por la Rua Hintze Ribeiro y la seguimos hasta el final; justo antes de llegar a la playa hay una <strong>oficina tur√≠stica</strong> donde nos sellar√°n la credencial con un bonito carimbo jacobeo.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç LE√áA DA PALMEIRA</div>
                                <div class="distancia-acumulada">Distancia acumulada: 12,6 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 4: Le√ßa da Palmeira ‚Üí Aldeia Nova (Perafita)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">4,0 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Continuamos por el paseo mar√≠timo (Av. Libertade) y pasaremos junto a la singular <strong>piscina das Mareas</strong> (1966), que se llena del agua del mar y cuyos muros se funden con las rocas de la playa; es un proyecto de juventud del insigne arquitecto portugu√©s √Ålvaro Siza Vieira, nacido en Matosinhos y hoy con obras repartidas por todo el mundo.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://images.adsttc.com/media/images/57ed/0e4f/e58e/ce20/4500/01b8/newsletter/04.jpg?1475153480g" alt="Piscina das Mar√©s" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Piscina das Mar√©s
                                </figcaption>
                            </figure>
                            <p>La ruta sigue por el paseo mar√≠timo (por cierto, dise√±ado en 2006 tambi√©n por Siza), en direcci√≥n hacia un gran faro.</p>
                            <p><strong>Farol (faro) da Boa Nova:</strong> Construido en 1926, con sus 46 metros es el segundo faro m√°s alto de Portugal y su luz puede verse desde 28 millas n√°uticas (52 km). A pocos metros de √©ste tenemos otro edificio del arquitecto √Ålvaro Siza, el <strong>restaurante Casa de Ch√° da Boa Nova</strong> (1963), recostado en un mont√≠culo donde hay un mirador y una peque√±a capilla; en 2011 el restaurante fue declarado Monumento Nacional, y actualmente est√° dirigido por el prestigioso chef Rui Paula, contando con una estrella Michelin.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://vive.eixoatlantico.com/wp-content/uploads/2024/07/Farol-scaled.jpg" alt="Faro da Boa Nova" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Faro da Boa Nova
                                </figcaption>
                            </figure>
                            <p>A partir de aqu√≠ comienzan varios tramos por pasarelas de madera sobre las dunas de las sucesivas playas, aunque siempre tenemos la opci√≥n de continuar por el paseo (por donde deben ir obligatoriamente los ciclistas). En breve superamos las instalaciones y chimeneas de la refiner√≠a de petr√≥leo Petrogal, cuya presencia resulta chocante frente a un litoral tan bonito; por suerte podemos seguir por la playa, utilizando las pasarelas de madera que nos distraen de la visi√≥n de la refiner√≠a.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç ALDEIA NOVA (PERAFITA)</div>
                                <div class="distancia-acumulada">Distancia acumulada: 16,6 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 5: Aldeia Nova ‚Üí Praia de Angeiras</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">6,2 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>A la altura del campo de f√∫tbol de Aldeia Nova comienza un carril bici, si bien los que van a pie pueden seguir por las pasarelas; volveremos durante unos metros al paseo en la playa do Para√≠so, con casas y bloques de apartamentos.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/9/95/Padr%C3%A3o_da_Mem%C3%B3ria_-_Praia_da_Mem%C3%B3ria_-_Portugal_%2845800727384%29.jpg" alt="Obelisco da Mem√≥ria" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Obelisco da Mem√≥ria - 1832
                                </figcaption>
                            </figure>
                            <p><strong>Obelisco da Mem√≥ria:</strong> El monumento recuerda el lugar donde en 1832 desembarcaron las tropas del ej√©rcito liberal para poner fin al r√©gimen absolutista de Miguel I de Bragan√ßa. Seguimos nuestro recorrido por las playas de Quebrada, Agudela y Pedras do Corgo, para llegar a la localidad de Praia de Angeiras.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.playocean.net/i/portugal/beaches/matosinhos/angeiras-norte/praia-de-angeiras-norte-5.jpg" alt="Praia de Angeiras" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Praia de Angeiras (Lavra)
                                </figcaption>
                            </figure>
                            <p><strong>Praia de Angeiras (Lavra):</strong> Pueblo con restaurantes y bares a pie de playa; sobre la arena hay barcas, as√≠ como redes y todo tipo de enseres para la pesca. Los que decidan acabar aqu√≠ la jornada disponen del <strong>camping Orbitur</strong> a 400 metros hacia el interior, que ofrece alojamiento en bungalows a los peregrinos.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç PRAIA DE ANGEIRAS (LAVRA)</div>
                                <div class="distancia-acumulada">Distancia acumulada: 22,8 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 6: Praia de Angeiras ‚Üí Labruge (Final de Etapa)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">0,8 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Seguimos hasta el final del paseo mar√≠timo, donde una nueva pasarela nos conduce hasta un bonito puente de madera sobre la desembocadura del r√≠o Onda. Aqu√≠ dejamos a freguesia o parroquia de Lavra (perteneciente al municipio de Matosinhos) y entramos en la freguesia de Labruge (perteneciente al municipio de Vila do Conde).</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.playocean.net/i/portugal/beaches/vila-do-conde/labruge/praia-de-labruge-1.jpg" alt="Praia de Labruge" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Praia de Labruge
                                </figcaption>
                            </figure>
                            <p><strong>Praia de Labruge:</strong> Llegamos a un par de lounge-bar a pie de playa, y a 250 metros hacia el interior tenemos un restaurante m√°s convencional. Quienes decidan prolongar la etapa deber√°n seguir por el litoral, sin necesidad de desviarse hacia el pueblo de Labruge.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">‚úÖ LABRUGE - FIN DE ETAPA</div>
                                <div class="distancia-acumulada">Distancia acumulada total: 24,5 km</div>
                            </div>
                        </div>
                    </div>

                    <div id="map-etapa1" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa1()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Cargar Mapa Interactivo</button>
                </div>

                <div class="modal-section theme-photo">
                    <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                    <div class="pro-card">
                        <div id="photo-container-etapa1" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                            <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                        </div>
                        
                        <div style="display: flex; gap: 8px;">
                            <button onclick="document.getElementById('input-photo-etapa1').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">
                                üì∑ Seleccionar Foto
                            </button>
                            <button onclick="removePhoto('etapa1')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">
                                üóëÔ∏è Borrar
                            </button>
                        </div>
                        <input type="file" id="input-photo-etapa1" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa1', this)">
                    </div>
                </div>

            </div>

            <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü BEACH HOUSE *** (Labruge)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 01/06/2026 ‚Äì 02/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 500m del centro de Labruge</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Apartamento entero</div>
                            <div class="accommodation-detail-line"><strong>Capacidad:</strong> 2 camas dobles</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size: 1.1em; font-weight: bold; color: #27ae60;">165‚Ç¨</span></div>
                        </div>
                        <a href="https://www.booking.com/Share-Zo09uJ" target="_blank" class="btn-alojamiento">Ver alojamiento en Booking</a>
                    </div>
                </div>
                
                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa1">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="‚úçÔ∏è Notas personales..." oninput="saveDiary('etapa1', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa1">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p>A lo largo de la etapa podr√°s disfrutar de una excelente oferta gastron√≥mica ligada al mar:</p>
                        <ul style="padding-left: 20px;">
                            <li><strong>Oporto y Matosinhos:</strong> ideales para probar pescado fresco a la brasa y marisco.</li>
                            <li>Platos t√≠picos: bacalao en sus m√∫ltiples preparaciones, sardinas asadas y caldeirada de peixe.</li>
                            <li>No olvides degustar un <em>Vinho Verde</em> o un vino de Oporto al finalizar la jornada.</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" 
                                       style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" 
                                       style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üéí Otros / Varios (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" 
                                   style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #f9e79f; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent1">
                                <p><strong>Recorridos de la Etapa:</strong><br>
                                Existen dos recorridos diferentes para iniciar este camino: uno va por la orilla del Duero y las playas del litoral atl√°ntico, y otro por el interior, excesivamente urbano y sin ver la costa en toda la jornada. El primero es intuitivo y el m√°s utilizado hoy en d√≠a por los peregrinos, si bien no dispone de flechas ‚Äìni falta que hace‚Äì hasta llegar a Matosinhos.<br><br>
                                El recorrido por el interior ‚Äìsin r√≠o ni playas‚Äì ser√≠a la ruta considerada "hist√≥rica", pero resulta francamente anodina y decepcionante. Quien se decante por ella debe seguir las flechas del Camino Central cruzando toda la ciudad hasta un lugar conocido como Padr√£o da L√©gua, donde se desv√≠a en direcci√≥n al aeropuerto. Os explicamos ambas posibilidades en la pesta√±a Recorrido de la etapa.<br><br>
                                Si decidimos ir por el litoral debemos bajar hasta el r√≠o, sin hacer caso de las flechas que han colocado por el casco antiguo. Una vez en la ribiera del Duero es imposible perderse: no hay m√°s que seguir r√≠o abajo hacia su desembocadura, la Foz do Douro.<br><br>
                                En algunos tramos de la etapa caminaremos por pasarelas de madera sobre la arena (passadi√ßos en portugu√©s), por las que no deben circular bicicletas para evitar incidentes con los viandantes. La alternativa de los ciclistas es tan sencilla como seguir por el paseo, donde a menudo disponen de un carril bici.<br><br>
                                En el litoral de Matosinhos, Angeiras y Labruge encontraremos restaurantes y chiringuitos a pie de playa donde podemos escoger el pescado, reci√©n sacado del mar, y te lo cocinan en el acto en unas parrillas con brasas, situadas a menudo en plena calle.<br><br>
                                <strong>PORTO</strong><br>
                                La catedral es un edificio que data de los siglos XII y XIII, por lo que alberga elementos de estilo rom√°nico y g√≥tico, si bien con importantes a√±adidos barrocos. La visita a la catedral es gratuita (excepto el claustro) y aqu√≠ nos sellar√°n (y entregar√°n, si la necesitamos) la credencial. El horario es de 9 a 12.30h y de 14.30 a 18h. En caso que estuviera cerrada podemos sellar en la oficina de turismo que hay justo al lado.<br>
                                Quiz√° lo mejor de la ciudad sea su agradable ambiente y las estupendas vistas que, desde el Cais da Ribeira (el paseo del muelle) y otros puntos de la ciudad, tenemos sobre el r√≠o Douro (Duero) y el omnipresente puente Luiz I. La ciudad tambi√©n cuenta, por supuesto, con monumentos destacados: el puente Luiz I, la catedral, la iglesia y torre de los Cl√©rigos, la estaci√≥n ferroviaria de S√£o Bento, etc.<br>
                                El Bacalhau, como en todo Portugal, es el producto estrella. A parte de las recetas comunes t√≠picas de todo el pa√≠s con este c√©lebre producto, en Porto destaca el Bacalhau √† Gomes de S√°, que lleva el nombre de su creador. En la elaboraci√≥n, el bacalao es desmenuzado y macerado con leche para despu√©s hornearse con ajo y cebolla y acompa√±arlo con aceitunas y huevos cocidos.<br>
                                Los ciudadanos de Porto son llamados tripeiros en honor a esta carne y la elaboraci√≥n m√°s famosa de la ciudad son las tripas √° moda do Porto, similares a los callos espa√±oles pero a los que se a√±aden jud√≠as blancas.<br>
                                Si lo que buscamos es dulce, Porto es una ciudad con multitud de opciones. Muy similares a los Past√©is de Bel√©m de Lisboa, aqu√≠ podemos encontrar las natas y otras elaboraciones que aunque no sean originarias de la ciudad, se han extendido, como los bolos de arroz, las queijadas o los oves moles.<br>
                                Si queremos comprar provisiones para la etapa siguiente (aunque encontraremos servicios de sobra), podemos visitar el mercado de Bolh√£o, de lunes a s√°bado en el centro de la ciudad.<br><br>
                                <strong>MATOSINHOS</strong><br>
                                Algunos peregrinos deciden tomar el autob√∫s 500 o la l√≠nea azul del metro hasta la parada de Mercado, en Matosinhos, donde comienzan las flechas. Desde aqu√≠ s√≥lo hay que cruzar el puente y seguir el paseo junto a las playas del litoral ‚Äìalgunas muy bonitas‚Äì hacia Vila do Conde, que queda a 24 km de distancia.<br><br>
                                <strong>LE√áA DA PALMEIRA</strong><br>
                                Adem√°s de las playas y sus dunas, el recorrido pasa junto a un faro, varios miradores y dos edificios del gran arquitecto portugu√©s √Ålvaro Siza Vieira: la piscina de las Mareas, que se llena con las aguas del mar, y el restaurante Boa Nova.<br><br>
                                <strong>LABRUGE</strong><br>
                                Localidad peque√±a y tranquila que dispone de albergue de peregrinos en la antigua escuela, al lado de la Junta da Freguesia (administraci√≥n local). A pocos metros hay un caf√© ‚Äìdonde se puede comer o cenar‚Äì y una pasteler√≠a-caf√©.</p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent1', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

    
    <!-- MODAL ETAPA 2 (COMPLETO) -->
    <div class="modal-backdrop" id="modalEtapa2">
    <div class="modal-panel">
        <div class="modal-header">
            <h2>Etapa 2: Labruge ‚Üí P√≥voa de Varzim - Detalles Completos</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa2')">√ó</button>
        </div>

        <div class="modal-body">
            
            <div class="modal-left">

                <div class="widget-card" id="weather-etapa2" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Distancia:</strong> 14 km</li>
                            <li><strong>Duraci√≥n estimada:</strong> 3 horas 30 minutos</li>
                            <li><strong>Dificultad:</strong> Muy Baja</li>
                            <li><strong>Tipo de etapa:</strong> Costera, playas y centros urbanos</li>
                            <li><strong>Pavimento:</strong> Pasarelas de madera, playas y calles urbanas</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-elevation">
                    <h3>‚õ∞Ô∏è Perfil de la Etapa</h3>
                    <div class="pro-card">
                        <div style="height: 150px; width: 100%;">
                            <canvas id="elevation-etapa2"></canvas>
                        </div>
                        <p style="font-size: 0.8em; color: #777; text-align: center; margin-top: 5px;">
                            üìà Desnivel acumulado: <span id="gain-etapa2">--</span>m
                        </p>
                    </div>
                </div>

                <div class="modal-section theme-route">
                    <h3>üìç Tramos y Puntos de Parada</h3>
                    
                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 1: Labruge ‚Üí Vila Ch√£</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,4 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Aquellos que hayan dormido en el albergue de Labruge deben volver hasta la playa para retomar el camino. Los que vengan por la costa y prosigan hacia Vila do Conde no tienen porqu√© entrar en la localidad de Labruge.</p>
                            <p>El camino sigue por pasarelas de madera entre playas, mont√≠culos rocosos y zonas de dunas, en un tramo con paisajes muy bonitos. Una de las primeras playas es la de Sampaio, donde se descubri√≥ un castro de la Edad del Hierro. Enseguida llegamos a las casas de pescadores de Vila Ch√£, originales y multicolores; en una plaza junto a la playa vemos una original capillita vidriada con una imagen de la Senhora da Guia en su interior.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç VILA CH√É</div>
                                <div class="distancia-acumulada">Distancia acumulada: 3,4 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 2: Vila Ch√£ ‚Üí Lou√ß√°-Mindelo</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">1,1 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Atravesamos la localidad, que dispone de un par de caf√©s, restaurantes y algunas tiendas; tambi√©n tenemos un camping y un albergue municipal de peregrinos (a apenas 300 metros del camino, hay cartelitos para llegar). Enseguida, por la Av. Marginal, entramos en el barrio de Lou√ß√°.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç LOU√á√Å-MINDELO</div>
                                <div class="distancia-acumulada">Distancia acumulada: 4,5 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 3: Lou√ß√°-Mindelo ‚Üí Vila do Conde</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">6,2 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Alternamos varios barrios de casas y bloques de apartamentos con tramos de pasarelas. As√≠ llegamos a la playa de Mindelo, donde las pasarelas nos conducen por detr√°s de las dunas. Seguimos de frente, bordeando la Reserva Ornitol√≥gica de Mindelo. Tras los bloques de apartamentos de la playa de √Årvore, ya con la vista de Vila do Conde al fondo, volvemos a las pasarelas. Seguimos por la playa en paralelo a la valla del camping de √Årvore; justo al final del camping enfilamos hacia el interior.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://beachcam.meo.pt/media/g3kpfw0l/praia-de-mindelo.jpg" alt="Praia do Mindelo" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Praia do Mindelo
                                </figcaption>
                            </figure>
                            <p>Al llegar a la carretera N13 giramos a la izquierda y por la misma acera cruzamos el puente sobre el r√≠o Ave. Al otro lado vemos la enorme mole del convento de Santa Clara. Tras cruzar el puente entramos en Vila do Conde.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://images.winalist.com/blog/wp-content/uploads/2025/02/26173259/adobestock-436045981-1500x1000.jpeg" alt="Vila do Conde" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Vila do Conde
                                </figcaption>
                            </figure>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç VILA DO CONDE</div>
                                <div class="distancia-acumulada">Distancia acumulada: 10,7 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 4: Vila do Conde ‚Üí P√≥voa de Varzim</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,3 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Nuestra ruta contin√∫a en subida por la estrecha Rua da Igreja y tuerce a la derecha por la Rua da Costa, callejeando hasta la Rua dos Benguiados, por la que llegamos a una rotonda donde hay un estanque y una escultura con dos figuras de bronce.</p>
                            <p>Seguimos recto por la misma Rua dos Benguiados, a lo largo de la valla de un instituto y una escuela, y continuamos por la Rua da Estrada Velha y Rua das Violetas, pasando junto al cementerio das Caxinhas. A lo largo de la Rua dos Ferreiros accedemos al municipio de P√≥voa de Varzim, ciudad importante y con todos los servicios.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://viajerosocultos.com/wp-content/uploads/2023/11/Povoa_de_Varzim.jpg" alt="P√≥voa de Varzim" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ P√≥voa de Varzim
                                </figcaption>
                            </figure>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">‚úÖ P√ìVOA DE VARZIM - FIN DE ETAPA</div>
                                <div class="distancia-acumulada">Distancia acumulada total: 14 km</div>
                            </div>
                        </div>
                    </div>

                    <div id="map-etapa2" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa2()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Cargar Mapa Interactivo</button>
                </div>

                <div class="modal-section theme-photo">
                    <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                    <div class="pro-card">
                        <div id="photo-container-etapa2" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                            <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                        </div>
                        
                        <div style="display: flex; gap: 8px;">
                            <button onclick="document.getElementById('input-photo-etapa2').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">
                                üì∑ Seleccionar Foto
                            </button>
                            <button onclick="removePhoto('etapa2')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">
                                üóëÔ∏è Borrar
                            </button>
                        </div>
                        <input type="file" id="input-photo-etapa2" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa2', this)">
                    </div>
                </div>

            </div> <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü CASA FRAGOSA (P√≥voa de Varzim)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 02/06/2026 ‚Äì 03/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 2,3 km del centro de P√≥voa de Varzim</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Habitaci√≥n familiar con ba√±o</div>
                            <div class="accommodation-detail-line"><strong>Camas:</strong> 2 individuales + 1 doble</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size: 1.1em; font-weight: bold; color: #27ae60;">86‚Ç¨</span></div>
                        </div>
                        <a href="https://www.booking.com/Share-twQySs" target="_blank" class="btn-alojamiento">
                            Ver alojamiento en Booking
                        </a>
                    </div>
                </div>

                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa2">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="‚úçÔ∏è Notas personales..." oninput="saveDiary('etapa2', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa2">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p>Etapa rica en oferta gastron√≥mica ligada al mar:</p>
                        <ul style="padding-left: 20px;">
                            <li><strong>Especialidades:</strong> Pescado fresco, marisco y arroz de marisco</li>
                            <li><strong>Vila do Conde:</strong> Tradici√≥n en caldo de fideos y platos tradicionales</li>
                            <li><strong>P√≥voa de Varzim:</strong> Restaurantes con vistas al mar y cocina t√≠pica portuguesa</li>
                            <li>Prueba los vinos locales y el famoso vino verde</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" 
                                       style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" 
                                       style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üéí Otros / Varios (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" 
                                   style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #f9e79f; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent2">
                                <p><strong>LABRUGE</strong><br>
                                El camino contin√∫a por la costa sobre pasarelas de madera, entre paisajes muy fotog√©nicos con playas, promontorios rocosos y zonas de dunas. Hoy pasaremos junto a una reserva ornitol√≥gica que a lo largo del a√±o alberga m√°s de 150 especies de aves.<br>
                                En los tramos por pasarelas han marcado el camino de forma discreta e inteligente, substituyendo una de las tablillas de madera del pavimento por otra de pl√°stico de color amarillo o azul, con el texto buen camino en varios idiomas.<br>
                                Las playas largas invitan a descalzase y caminar un rato por la orilla. Si todav√≠a no lo hab√©is hecho, os lo recomendamos: es un placer para los pies y para la mente.<br><br>
                                <strong>VILA CHA</strong><br>
                                En una loma sobre la playa podemos ver los restos arqueol√≥gicos del Castro Sampaio, un poblado celta que data de la Edad del Hierro (hacia el siglo V a. C.), si bien sigui√≥ habitado durante la dominaci√≥n romana.<br>
                                El litoral que estamos recorriendo era conocido hasta mediados del siglo XX como la Costa Negra, por ser la m√°s peligrosa del pa√≠s para la navegaci√≥n. Lo podemos comprobar por las numerosas placas conmemorativas de tragedias de naufragios.<br><br>
                                <strong>AZURARA</strong><br>
                                El recorrido por el litoral y el "trazado hist√≥rico" que viene del Padr√£o da Legua confluyen en Azurara, unos metros antes del puente sobre el r√≠o Ave, a la entrada de Vila do Conde.<br><br>
                                <strong>VILA DO CONDE</strong><br>
                                En el skyline de la villa destaca un largu√≠simo acueducto de 999 arcos, del que se conservan sus √∫ltimos 5 km. Fue construido entre 1705 y 1714 para conducir agua desde un manantial del interior hasta el convento de Santa Clara.<br>
                                La localidad dispone de estaci√≥n de metro de la l√≠nea B-roja que comunica con Porto. Algunos deciden caminar una primera etapa Matosinhos-Vila do Conde sin peso, tomando acto seguido el metro para dormir de nuevo en Porto, y volviendo aqu√≠ al d√≠a siguiente, bien temprano y ya con la mochila. Aunque pueda parecer una combinaci√≥n un tanto artificial, utilizar la ayuda del transporte p√∫blico tiene muchos adeptos.<br><br>
                                <strong>P√ìVOA DE VARZIM</strong><br>
                                Si el tiempo acompa√±a puede ser una buena idea pasar la tarde en la playa de P√≥voa, muy concurrida en √©poca estival. Adem√°s de casetas de ba√±o, bares chill out y restaurantes, tenemos muy cerca el sobrio edificio del Casino, una biblioteca e incluso, algo m√°s lejos, la plaza de toros.<br>
                                Otra posibilidad para quienes se aburran en P√≥voa ser√≠a aprovechar la tarde para tomar el metro hasta el centro de Porto y completar as√≠ nuestra visita de la ciudad.<br>
                                Los platos tradicionales de la zona reflejan la combinaci√≥n entre pesca y agricultura, destacando el Arroz de sardinhas, la Pescada √† Poveira o la Caldeirada de peixe. Los m√°s golosos no pueden perderse las Rabanadas Poveiras, una dulce tentaci√≥n a la que sin duda sucumbir√°n.</p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent2', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div> </div> </div> </div> ```

     <!-- MODAL ETAPA 3 -->
    <div class="modal-backdrop" id="modalEtapa3">
    <div class="modal-panel">
        <div class="modal-header">
            <h2>Etapa 3: P√≥voa de Varzim ‚Üí Marinhas - Detalles Completos</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa3')">√ó</button>
        </div>

        <div class="modal-body">
            
            <div class="modal-left">

                <div class="widget-card" id="weather-etapa3" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Distancia:</strong> 24,5 km</li>
                            <li><strong>Duraci√≥n estimada:</strong> 6 horas</li>
                            <li><strong>Dificultad:</strong> Baja</li>
                            <li><strong>Tipo de etapa:</strong> Mixta, litoral y tramos interiores</li>
                            <li><strong>Pavimento:</strong> Paseos mar√≠timos, pasarelas de madera, caminos de tierra, aceras y adoquines</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-elevation">
    <h3>‚õ∞Ô∏è Perfil de la Etapa</h3>
    <div class="pro-card">
        <div style="height: 150px; width: 100%;"> <canvas id="elevation-etapa3"></canvas> </div>
        <p style="font-size: 0.8em; color: #777; text-align: center; margin-top: 5px;">
            üìà Desnivel acumulado: <span id="gain-etapa3">--</span>m
        </p>
    </div>
</div>

                <div class="modal-section theme-route">
                    <h3>üìç Tramos y Puntos de Parada</h3>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 1: P√≥voa de Varzim ‚Üí A Ver-o-Mar</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,5 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Para retomar el camino desde el centro de P√≥voa no tenemos m√°s que ir hasta el paseo mar√≠timo (Av. dos Banhos) y seguirlo en direcci√≥n norte.</p>
                            <p>A nuestra derecha se suceden cientos de bloques de apartamentos y a la izquierda, sobre la arena, tenemos bares musicales con sus terrazas chill out, algunos restaurantes y diferentes instalaciones de la playa. Al cabo de 900 metros pasaremos entre los edificios de las piscinas municipales y del campo de f√∫tbol; enseguida, y sin que cambie el paisaje, entramos en la localidad vecina de A Ver-o-Mar.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/24/6d/ec/f3/passadico.jpg?w=900&h=500&s=1" alt="PASSEIO A VER-O-MAR" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ PASSEIO A VER-O-MAR (P√≥voa de Varzim)
                                </figcaption>
                            </figure>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç A VER-O-MAR</div>
                                <div class="distancia-acumulada">Distancia acumulada: 3,5 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 2: A Ver-o-Mar ‚Üí Agu√ßadoura</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,6 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>El paseo de la costa pasa ahora a denominarse Av. dos Pescadores. Al final de la playa do Fragosinho una flecha nos propone girar a la izquierda para seguir ahora por pasarelas de madera sobre la arena.</p>
                            <p>En la Praia de Santo Andr√© abre en temporada un chiringuito muy jacobeo, el Caminho Beach Bar, con vieiras en su exterior y carteles indicando las distancias a Santiago, a P√≥voa y a Porto (recordemos que bastantes peregrinos utilizan este camino en sentido contrario, pues la orientaci√≥n con el mar al lado resulta muy f√°cil).</p>
                            <p>M√°s adelante, ya en la fregues√≠a (parroquia) de Agu√ßadoura, llegamos a una plaza con un crucero en el centro.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç AGU√áADOURA</div>
                                <div class="distancia-acumulada">Distancia acumulada: 7,1 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 3: Agu√ßadoura ‚Üí Ap√∫lia</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">6,9 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Un nuevo tramo de pasarelas de madera nos acerca al cuerpo cil√≠ndrico de un antiguo molino de viento; al cabo de 1 km llegamos ante el campo de f√∫tbol del Agu√ßadoura F√∫tebol Clube, donde dejaremos nuestro paseo por el litoral (Nota 2021: nos informan que ahora este paseo litoral se ha alargado 1,1 km m√°s, bien se√±alizado).</p>
                            <p>M√°s adelante las flechas nos llevan a girar a la derecha hasta la M-501, carreterita estrecha que discurre en paralelo a la costa. Seguiremos por su m√≠nimo arc√©n en direcci√≥n norte, entre un paisaje de campos e invernaderos. Pasamos junto a un desv√≠o a la izquierda, donde un cartel indica el acceso al camping Orbitur Rio Grande.</p>
                            <p><strong>3,8 km.</strong> Acceso al camping y a la Praia de Estela. El camping queda a 300 metros fuera del camino, entre la carretera y la playa. Nosotros debemos seguir por la carretera durante 450 metros, hasta llegar a una encrucijada donde toca girar a la izquierda por una pista adoquinada.</p>
                            <p>En breve veremos al fondo la silueta de un molino de viento, pero antes de llegar a √©l las flechas viran a la derecha, en direcci√≥n hacia una zona arbolada donde encontramos las instalaciones de un campo de f√∫tbol; nuestra ruta sigue por la Rua do Pinhal hasta que al cabo de 400 metros cruzamos una carretera y llegamos a las primeras casas de la localidad de Ap√∫lia.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://content-viajes.nationalgeographic.com.es/medio/2024/08/08/playa-apulia_1b582d7b_240808154327_1280x853.jpg" alt="Ap√∫lia" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Ap√∫lia
                                </figcaption>
                            </figure>
                            <p><strong>3,1 km.</strong> Ap√∫lia, iglesia.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç AP√öLIA</div>
                                <div class="distancia-acumulada">Distancia acumulada: 14 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 4: Ap√∫lia ‚Üí F√£o</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,7 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Pasamos frente a la iglesia y recorremos las calles del centro del pueblo. Salimos por un camino adoquinado que al cabo de 800 metros nos lleva hasta una carreterita; torcemos a la izquierda y, a 30 metros, por la derecha, comienza uno de los tramos m√°s agradables de la jornada: durante 1,5 km seguiremos un camino de tierra, a la sombra de los pinos y algunos eucaliptus, que nos conduce hacia la villa de F√£o.</p>
                            <p>Despu√©s de superar el campo de f√∫tbol (con √©ste ya son cuatro los campos de f√∫tbol que hemos encontrado en la etapa de hoy), giramos a la derecha por la Rua Santo Antonio da Fonte; una vez frente al cementerio giramos a la izquierda, pasamos ante una escultura coloreada de San Antonio y seguimos la acera de la carretera N-13; la cruzamos por un paso de cebra y llegamos a la iglesia do Bom Jes√∫s.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://rpcr.visitesposende.com/wp-content/uploads/2021/05/Igreja-do-Bom-Jesus-de-Fa%CC%83o-1.jpg" alt="F√£o" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Templo del Buen Jes√∫s de F√£o 
                                </figcaption>
                            </figure>
                            <p><strong>Nota:</strong> En este punto, a la entrada de F√£o, se incorpora al Camino de la Costa un ramal de enlace que proviene de S√£o Pedro de Rates, localidad que se halla a pie del Camino Portugu√©s Central.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç F√ÉO</div>
                                <div class="distancia-acumulada">Distancia acumulada: 17,7 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 5: F√£o ‚Üí Esposende</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">2,5 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Avanzamos por la alameda de la iglesia-santuario do Bom Jes√∫s, donde tambi√©n hay un quiosco de m√∫sica. Justo a la derecha, a orillas del r√≠o, se halla el albergue-Pousada de Juventude.</p>
                            <p>Despu√©s de atravesar el casco antiguo de la villa llegamos frente al r√≠o C√°davo, que cruzaremos por el puente met√°lico de la carretera N-13, conocido como puente de D. Lu√≠s Filipe y que data del a√±o 1892.</p>
                            <p>Nada m√°s cruzar el puente giramos a la izquierda por un vial de servicio en desuso. En breve llegaremos a una rotonda, y tras superarla toca cruzar la avenida y enfilar una bocacalle empedrada que desemboca en la Rua Narciso Ferreira. Pasamos junto al cementerio y siguiendo de frente accedemos al centro de la villa de Esposende.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://viajecaminodesantiago.com/wp-content/uploads/2021/03/pueblo-esposende-camino-portugues-costa.jpg" alt="Esposende" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Villa de Esposende 
                                </figcaption>
                            </figure>
                            <p><strong>Nota:</strong> Desde la rotonda, si alguien prefiere evitar el meollo del casco urbano de Esposende, se puede seguir el paseo litoral, que va bordeando el estuario del r√≠o.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç ESPOSENDE</div>
                                <div class="distancia-acumulada">Distancia acumulada: 20,2 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 6: Esposende ‚Üí Marinhas (Final de etapa)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">4,3 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Desde el centro de Esposende seguimos de frente por la Av. Dr. Henrique Barros Lima hasta llegar ante el Hospital Valentim Ribeiro, en un elegante edificio hist√≥rico, donde giraremos a la izquierda por la Av. Rocha Gon√ßalves para volver de nuevo ante el estuario del r√≠o C√°davo.</p>
                            <p>Al cabo de 800 metros pasaremos junto al fuerte de S√£o Jo√£o Baptista, por detr√°s del cual sobresale un peque√±o faro; seguimos la Av. dos Banhos en paralelo al mar, si bien en breve se va desviando hacia el interior.</p>
                            <p>Ahora toca girar a la izquierda por la Rua da Agrela, con √°rboles y campos a lado y lado, y que al final nos deja en la localidad de Marinhas. Tomamos a la derecha la Rua da Praia y cruzamos la carretera N-13; al otro lado tenemos la capilla de S√£o Sebasti√£o y el edificio de la Cruz Roja, donde est√° el albergue.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.visitesposende.com/images/fazer/roteiros/roteiro-motorizado-das-marinhas/roteiro-motorizado-das-marinhas_3.jpg" alt="Marinhas - Esposende" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Marinhas - Esposende 
                                </figcaption>
                            </figure>
                            <p>Aquellos que deseen utilizar el albergue deben pasar antes por dicha oficina de la Cruz Roja para registrarse y sellar la credencial; a poca distancia disponemos de varios bares y una tienda. En la zona de la playa de Cep√£es hay m√°s bares y restaurantes; √©sta se halla a apenas 1 km de distancia del albergue, siguiendo la Rua da Praia en direcci√≥n contraria a la que llegamos.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">‚úÖ MARINHAS - FIN DE ETAPA</div>
                                <div class="distancia-acumulada">Distancia acumulada total: 24,5 km</div>
                            </div>
                        </div>
                    </div>

                    <div id="map-etapa3" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa3()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Cargar Mapa Interactivo</button>

                    <div class="modal-section theme-photo" style="margin-top: 25px;">
                        <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                        <div class="pro-card">
                            <div id="photo-container-etapa3" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                                <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                            </div>
                            
                            <div style="display: flex; gap: 8px;">
                                <button onclick="document.getElementById('input-photo-etapa3').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">
                                    üì∑ Seleccionar Foto
                                </button>
                                <button onclick="removePhoto('etapa3')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">
                                    üóëÔ∏è Borrar
                                </button>
                            </div>
                            <input type="file" id="input-photo-etapa3" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa3', this)">
                        </div>
                    </div>

                </div> 
            </div> <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü CASA OUTEIRO POLO 2 *** (Marinhas)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 03/06/2026 ‚Äì 04/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 0,5 km del centro de Marinhas</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Apartamento de 3 dormitorios</div>
                            <div class="accommodation-detail-line"><strong>Camas:</strong> 2 dobles + 1 individual y un sof√° cama</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size: 1.1em; font-weight: bold; color: #27ae60;">100‚Ç¨</span></div>
                        </div>
                        <a href="https://www.booking.com/Share-d0PenZ" target="_blank" class="btn-alojamiento">
                            Ver alojamiento en Booking
                        </a>
                    </div>
                </div>

                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa3">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="‚úçÔ∏è Notas personales..." oninput="saveDiary('etapa3', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa3">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p>En esta etapa encontrar√°s numerosos bares y restaurantes tanto en las localidades costeras como en el interior:</p>
                        <ul style="padding-left: 20px;">
                            <li>Pescados y mariscos frescos en Ap√∫lia, F√£o y Esposende.</li>
                            <li>Cocina casera y platos tradicionales en las parroquias del interior.</li>
                            <li>Opciones de tapas y men√∫s econ√≥micos para peregrinos.</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" 
                                       style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" 
                                       style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üéí Otros / Varios (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" 
                                   style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #f9e79f; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent3">
                                <p>Al final del paseo mar√≠timo de P√≥voa nuestro camino vuelve a las pasarelas de madera sobre las playas. Como pod√©is imaginar no las han construido para los peregrinos, sino para encauzar el paso de todos sus usuarios: as√≠ se evita el deterioro de las dunas y de su vegetaci√≥n, que constituyen un ecosistema protegido.<br>
                                Las se√±ales en este tramo del Camino Portugu√©s de la Costa son peque√±os pictogramas, ya sea troquelados sobre placas de acero pre-oxidado, o bien en un material composite muy resistente que combina los colores azul y amarillo. Un dise√±o sencillo y pr√°ctico.<br><br>
                                <strong>FAO</strong><br>
                                A la entrada de F√£o se incorpora a nuestro Camino de la Costa un ramal de enlace que proviene de S√£o Pedro de Rates, localidad que se halla a pie del Camino Portugu√©s Central. Los m√°s puristas defienden que el trazado originario del Camino de la Costa pasaba por S√£o Pedro de Rates.<br>
                                Durante la jornada, tanto en las playas como junto a los campos, seguramente veamos unos montones extra√±os, parecidos a balas de paja: son sargazos, unas algas gelatinosas de color amarronado que se extraen del mar y se utilizan aqu√≠ para el abono de los cultivos.<br><br>
                                Hoy nuestro recorrido frente al mar pasa junto a varios molinos de viento, utilizados durante siglos para moler el grano. Las aspas eran varas con velas triangulares ‚Äìalgo diferente a la imagen t√≠pica de los molinos de La Mancha‚Äì y la cubierta era rotatoria, girando en funci√≥n de la direcci√≥n del viento. Algunos molinos est√°n abandonados, si bien la mayor√≠a han sido reconvertidos en casitas de veraneo.<br><br>
                                Veremos tramos de pasarelas donde se permite el paso de bicicletas, pero √©stas deben circular despacio y con suma precauci√≥n, pues los paseantes tienen preferencia.<br><br>
                                <strong>MARINHAS</strong><br>
                                Si el tiempo acompa√±a os recomendamos pasar la tarde en la playa de Cep√£es, que est√° a apenas 1 km del albergue de Marinhas, siguiendo la Rua da Praia en direcci√≥n contraria a la que llegamos. Un lugar tranquilo y con una excelente terraza a pie de arena, con sof√°s, hamacas y m√∫sica al atardecer.</p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent3', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div> </div> </div> </div> ```
    <!-- MODAL ETAPA 4 -->
    <div class="modal-backdrop" id="modalEtapa4">
    <div class="modal-panel">
        
        <div class="modal-header">
            <h2>Etapa 4: Marinhas ‚Üí Viana do Castelo - Detalles Completos</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa4')">√ó</button>
        </div>

        <div class="modal-body">
            
            <div class="modal-left">

                <div class="widget-card" id="weather-etapa4" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Distancia:</strong> 20,8 km</li>
                            <li><strong>Duraci√≥n estimada:</strong> 5 horas 15 minutos</li>
                            <li><strong>Dificultad:</strong> Baja</li>
                            <li><strong>Tipo de etapa:</strong> Interior, senderos y bosque</li>
                            <li><strong>Pavimento:</strong> Calles empedradas, pistas de tierra, senderos y carreteras</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-elevation">
    <h3>‚õ∞Ô∏è Perfil de la Etapa</h3>
    <div class="pro-card">
        <div style="height: 150px; width: 100%;"> <canvas id="elevation-etapa4"></canvas> </div>
        <p style="font-size: 0.8em; color: #777; text-align: center; margin-top: 5px;">
            üìà Desnivel acumulado: <span id="gain-etapa4">--</span>m
        </p>
    </div>
</div>

                <div class="modal-section theme-route">
                    <h3>üìç Tramos y Puntos de Parada</h3>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 1: Marinhas ‚Üí Mar (Esposende)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">2,7 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Seguimos la calle del albergue hasta el final, donde est√° la iglesia de S√£o Miguel, y giramos a la derecha. Despu√©s del Centro de Educaci√≥n Ambiental torcemos a la izquierda por la Rua de S√£o Jo√£o, y en breve pasaremos ante la capilla de S√£o Jo√£o do Monte. Por la Rua da Ponte Nova, Rua da Estrada Velha y la Estrada Real llegamos al edificio del Centro C√≠vico de Mar.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç MAR (ESPOSENDE)</div><div class="distancia-acumulada">Distancia acumulada: 2,7 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 2: Mar ‚Üí Belinho</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">1,2 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Continuamos en la misma direcci√≥n, siguiendo las flechas por las calles de la localidad. Una vez en la Rua Padre Almeida pasamos junto a una escuela donde hay un mural que saluda a los peregrinos, y llegamos a la iglesia de Belinho, con un cruceiro.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç BELINHO</div><div class="distancia-acumulada">Distancia acumulada: 3,9 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 3: Belinho ‚Üí Antas</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">1,9 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Seguimos de frente por la misma Rua Padre Almeida, y pasamos ante la urbanizaci√≥n Quinta do Para√≠so, que rodeamos por la izquierda. La adoquinada Rua Bar√£o de Maracan√° se convierte en pista de tierra, con muros de piedra a ambos lados, por la que llegamos a una carreterita donde hay una capilla; seguimos su acera hacia la izquierda durante 200 metros, pasando ante un cruceiro, y la dejamos por la derecha. Estamos en la fregues√≠a de Antas.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.visitesposende.com/images/fazer/roteiros/antas/antas_2.JPG" alt="Antas" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">üåâ Antas</figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç ANTAS</div><div class="distancia-acumulada">Distancia acumulada: 5,8 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 4: Antas ‚Üí Castelo do Neiva</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">2,9 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Enseguida llegamos al cruce con la carretera EN-13, que atravesamos con cuidado, y seguimos de frente por la estrecha Rua da Carvalha, entre casas y muros de piedra; √©sta contin√∫a por una pista de tierra en bajada que se introduce en el bosque.</p>
                            <p>Tras pasar una encrucijada con un gran monolito jacobeo en piedra, comienza a la izquierda un sendero estrecho y precioso que desciende hasta el cauce del r√≠o Neiva, junto al antiguo molino o azenha de Guilheta. El paso del r√≠o se realiza mediante una pontella o plataforma de losas de granito.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://derutasysendas.com/wp-content/uploads/2018/12/etp8_portu-4.jpg" alt="Camino r√≠o Neiva" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">üåâ Camino r√≠o Neiva</figcaption>
                            </figure>
                            <p><strong>1,2 km.</strong> Paso del r√≠o Neiva. Una vez al otro lado seguimos a mano derecha por pista empedrada, en fuerte subida, hasta llegar a la Capilla de N. S. de Guadalupe.</p>
                            <p>Seguimos a la derecha hasta el cruce con la carretera EN-13-3; aqu√≠ arranca la Travessa de Santiago, atajo adoquinado en fuerte subida que nos conducir√° hasta la iglesia de S√£o Tiago.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/17/f0/55/29/vista-da-igreja.jpg?w=900&h=-1&s=1" alt="Iglesia de S√£o Tiago" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">üåâ Iglesia de S√£o Tiago de Castelo do Neiva</figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç CASTELO DO NEIVA</div><div class="distancia-acumulada">Distancia acumulada: 8,7 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 5: Castelo do Neiva ‚Üí Chaf√©</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">4,6 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Nuestra ruta contin√∫a en direcci√≥n hacia la zona del aparcamiento de veh√≠culos; una vez en √©ste giramos a la derecha y tomaremos un camino de tierra que arranca en fuerte subida, bordeando el cementerio. Pasamos por las casas del barrio de Monte y volvemos a internarnos en el bosque hasta desembocar en la iglesia barroca del monasterio de S√£o Rom√£o de Neiva.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjfbnr_uEz3qURK93-PCzlH-Q1NQwRPo84C7TGAHvUC2t0u51bwHzcKpxch9JWrksbaJ2NO8XVlfABEmmK-sQIkcsVkLcENs5xQfsZ-4UIYPuqaFNgmsdKQ9FFTXvSowL2nNCyHYnicQWE/s640/45657096_2010925558930788_6159477590638723072_o.jpg" alt="Sao Romao de Neiva" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">üåâ Monasterio de Sao Romao de Neiva</figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç CHAF√â</div><div class="distancia-acumulada">Distancia acumulada: 13,3 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 6: Chaf√© ‚Üí Anha</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">2,3 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Al llegar al cementerio giramos a la izquierda; vamos siguiendo un rosario de calles empedradas hasta entrar en la fregues√≠a (parroquia) de Vila Nova de Anha. Llegamos ante la iglesia parroquial de S√£o Tiago.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç ANHA</div><div class="distancia-acumulada">Distancia acumulada: 15,6 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 7: Anha ‚Üí Darque</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">2,7 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Tras cruzar la localidad salimos por una carreterita asfaltada entre campos y bosque, que nos deja en un pol√≠gono industrial sin finalizar; tras un tramo por camino de arena en bajada llegamos a Darque, antesala de Viana do Castelo.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç DARQUE</div><div class="distancia-acumulada">Distancia acumulada: 18,3 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 8: Darque ‚Üí Viana do Castelo (Final)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">2,5 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://vive.eixoatlantico.com/wp-content/uploads/2024/06/DJI_0424-scaled.jpg" alt="Ponte Eiffel" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">üåâ Ponte Eiffel</figcaption>
                            </figure>
                            <p>Avanzamos por la acera de la carretera N-13 hasta una rotonda, tras la cual seguimos de frente para enfilar el gran puente Eiffel sobre el r√≠o Lima.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.benoitproperties.com/wp-content/uploads/2026/01/viana-do-castelo.jpg" alt="Viana do Castelo" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">üåâ Viana do Castelo</figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">‚úÖ VIANA DO CASTELO - FIN DE ETAPA</div><div class="distancia-acumulada">Distancia acumulada total: 20,8 km</div></div>
                        </div>
                    </div>

                    <div id="map-etapa4" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa4()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Cargar Mapa Interactivo</button>

                    <div class="modal-section theme-photo" style="margin-top: 25px;">
                        <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                        <div class="pro-card">
                            <div id="photo-container-etapa4" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                                <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="document.getElementById('input-photo-etapa4').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üì∑ Seleccionar Foto</button>
                                <button onclick="removePhoto('etapa4')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üóëÔ∏è Borrar</button>
                            </div>
                            <input type="file" id="input-photo-etapa4" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa4', this)">
                        </div>
                    </div>

                </div> 
            </div> <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü 3 MARIAS RESIDENCE *** (Viana do Castelo)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 04/06/2026 ‚Äì 05/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 1 km del centro</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Suite de 2 dormitorios</div>
                            <div class="accommodation-detail-line"><strong>Camas:</strong> 1 doble extragrande + 2 individuales</div>
                            <div class="accommodation-detail-line"><strong>Servicios:</strong> Piscina</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size:1.1em;font-weight:bold;color:#27ae60;">106‚Ç¨</span></div>
                        </div>
                        <a href="https://www.booking.com/Share-rrTim3C" target="_blank" class="btn-alojamiento">Ver alojamiento en Booking</a>
                    </div>
                </div>

                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa4">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="‚úçÔ∏è Notas personales..." oninput="saveDiary('etapa4', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa4">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p>En esta etapa por el interior encontrar√°s opciones gastron√≥micas variadas en los pueblos y localidades:</p>
                        <ul style="padding-left: 20px;">
                            <li>Cocina casera tradicional portuguesa en caf√©s y peque√±os restaurantes.</li>
                            <li>Especialidades de carnes y productos locales.</li>
                            <li>En Viana do Castelo: amplia oferta de restaurantes con cocina t√≠pica y especialidades de mar.</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b;">üéí Otros (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #f9e79f; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent4">
                                <p>La etapa de hoy es √∫nica en su especie, pues nos aleja completamente de la costa. Algunos peregrinos describen este d√≠a como la etapa m√°s hermosa del Camino Portugu√©s de la Costa, especialmente por el paso del r√≠o Neiva.<br><br>
                                El r√≠o Neiva es un r√≠o de monta√±a que baja con fuerza desde las alturas del interior. La antigua azenha (molino de agua) de Guilheta representa un patrimonio industrial singular de estas tierras portuguesas.<br><br>
                                <strong>CASTELO DO NEIVA</strong><br>
                                La iglesia de S√£o Tiago de Castelo do Neiva es especial para los peregrinos jacobeos. La inscripci√≥n del a√±o 862 que conmemora la consagraci√≥n de la iglesia hace de √©sta uno de los lugares m√°s antiguos dedicados a Santiago en la Pen√≠nsula Ib√©rica.<br><br>
                                <strong>S√ÉO ROM√ÉO DE NEIVA</strong><br>
                                Este monasterio barroco tiene una larga historia de espiritualidad. Su ubicaci√≥n en el bosque lo hace especialmente sereno y contemplativo.<br><br>
                                <strong>VIANA DO CASTELO</strong><br>
                                Viana do Castelo es una ciudad medieval con uno de los cascos hist√≥ricos mejor conservados de la costa portuguesa. Su puerto fluvial sobre el r√≠o Lima fue durante siglos un lugar de gran importancia comercial.</p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent4', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div> </div> </div> </div> ```
    <!-- MODAL ETAPA 5 -->
    <div class="modal-backdrop" id="modalEtapa5">
    <div class="modal-panel">
        
        <div class="modal-header">
            <h2>Etapa 5: Viana do Castelo ‚Üí Caminha - Detalles Completos</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa5')">√ó</button>
        </div>

        <div class="modal-body">
            
            <div class="modal-left">

                <div class="widget-card" id="weather-etapa5" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Distancia:</strong> 26,8 km</li>
                            <li><strong>Duraci√≥n estimada:</strong> 6 horas 30 minutos</li>
                            <li><strong>Dificultad:</strong> Media</li>
                            <li><strong>Tipo de etapa:</strong> Mixta, interior y litoral</li>
                            <li><strong>Pavimento:</strong> Calles empedradas, pistas de tierra, senderos, playas y carreteras</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-elevation">
    <h3>‚õ∞Ô∏è Perfil de la Etapa</h3>
    <div class="pro-card">
        <div style="height: 150px; width: 100%;"> <canvas id="elevation-etapa5"></canvas> </div>
        <p style="font-size: 0.8em; color: #777; text-align: center; margin-top: 5px;">
            üìà Desnivel acumulado: <span id="gain-etapa5">--</span>m
        </p>
    </div>
</div>

                <div class="modal-section theme-route">
                    <h3>üìç Tramos y Puntos de Parada</h3>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 1: Viana do Castelo ‚Üí Areosa</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">4,9 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p><strong>NOTA IMPORTANTE:</strong> En la primera parte de la etapa podemos escoger entre la ruta oficial, que va por el interior, o bien el recorrido alternativo por el litoral, sin flechas pero con playas. La distancia en ambas opciones es similar.</p>
                            <p><strong>Ruta alternativa por el litoral:</strong> Los que decidan seguir el litoral no tendr√°n ninguna dificultad para orientarse. Desde Viana do Castelo s√≥lo hay que buscar la Av. do Atl√¢ntico y superar la playa Norte y el fort√≠n da Areosa, siguiendo la costa en direcci√≥n hacia el faro de Montedor. Se pasa por playas, molinos y tramos de pasarelas de madera.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://live.staticflickr.com/1788/43040127272_4ef16b94ae_b.jpg" alt="Pra√ßa da Rep√∫blica" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Pra√ßa da Rep√∫blica - Viana do Castelo 
                                </figcaption>
                            </figure>
                            <p><strong>Ruta oficial:</strong> Desde la Pra√ßa da Rep√∫blica se toma el Passeio das Mordomas y seguimos las indicaciones hacia el centro comercial Esta√ß√£o Viana Shopping. Tras pasar bajo las v√≠as del tren y la circunvalaci√≥n, subimos hacia la iglesia de los Santos M√°rtires. Bordeamos el monte de Santa Luzia por callecitas estrechas hasta llegar a Areosa.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç AREOSA</div><div class="distancia-acumulada">Distancia acumulada: 4,9 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 2: Areosa ‚Üí Carre√ßo</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,5 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Continuamos por un tramo adoquinado entre olivos y subimos hacia una peque√±a urbanizaci√≥n. Seguimos por asfalto entre pinos y tomamos un camino a la derecha. Seguimos entre casitas y muros de piedra, a veces con buenas vistas sobre el litoral. Al llegar a un puente sobre la v√≠a del tren giramos a la derecha para enfilar la Rua do Moreno, cruzando finalmente la v√≠a para llegar a la iglesia de Carre√ßo.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç CARRE√áO</div><div class="distancia-acumulada">Distancia acumulada: 8,4 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 3: Carre√ßo ‚Üí Vila Praia de √Çncora</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">9,9 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Seguiremos por detr√°s de la iglesia en paralelo a la v√≠a del tren. Pasamos junto al albergue privado Casa do Sard√£o, con vistas sobre el faro de Montedor.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.diariodesantiago.es/wp-content/uploads/2025/11/viana-web-117.original-2025-11-17-viana-web-117.original.jpg" alt="Faro de Montedor" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Faro de Montedor 
                                </figcaption>
                            </figure>
                            <p>El camino se interna en un bosque de eucaliptus. Llegamos a la Quinta de Cabanas y al Convento de S√£o Jo√£o.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/30/ce/9b/bb/convento.jpg?w=900&h=500&s=1" alt="Convento de S√£o Jo√£o de Cabanas" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Convento de S√£o Jo√£o de Cabanas 
                                </figcaption>
                            </figure>
                            <p>Tras varios tramos de bosque y adoquines, llegamos a la aldea de Barreiros y finalmente cruzamos bajo la carretera N-13 para entrar en Vila Praia de √Çncora.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://thenwewalked.com/wp-content/uploads/2025/01/agarda-seafront-1024x683.jpg" alt="Vila Praia De Ancora" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Vila Praia De Ancora 
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç VILA PRAIA DE √ÇNCORA</div><div class="distancia-acumulada">Distancia acumulada: 18,3 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 4: Vila Praia de √Çncora ‚Üí Moledo</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">4,7 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Se cruza la v√≠a del tren y llegamos ante la costa, junto al fuerte da Lagarteira. Seguimos todo el litoral hasta entrar en Moledo.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.portugalplease.com/uploads/artigos-visitar/1179/principal/principal-5f4d20a08da31-imagem_10_1_1024_2500.jpg" alt="Forte da Lagarteira" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Forte da Lagarteira
                                </figcaption>
                            </figure>
                            <p><strong>Variante recomendada:</strong> En lugar de cruzar bajo la v√≠a del tren, os recomendamos seguir de frente por la orilla del mar hacia la playa de Moledo y cruzar la Mata do Camarido (bosque de pinos), llegando al estuario del Mi√±o. El rodeo es m√≠nimo y vale la pena.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://r-xx.bstatic.com/xdata/images/hotel/608x352/660705177.webp?k=4a35029342f5a200e8a2810a95ad987af4b27ea5d5bbfa4d183a2309bbc096ad&o=" alt="Praia Moledo" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Praia Moledo - Caminha
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç MOLEDO</div><div class="distancia-acumulada">Distancia acumulada: 23 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 5: Moledo ‚Üí Caminha (Final de etapa)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,8 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Los que sigan la ruta oficial ir√°n paralelos a la v√≠a del tren hasta entrar en Caminha, llegando a la plaza del Ayuntamiento con la Torre del Reloj.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://content-viajes.nationalgeographic.com.es/medio/2025/12/17/carminha_970db375_251217094958_1280x854.webp" alt="Torre do Rel√≥gio" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Torre do Rel√≥gio (Porta de Viana)
                                </figcaption>
                            </figure>
                            <p>Adem√°s de visitar su bonito casco hist√≥rico, os recomendamos consultar enseguida los horarios del ferry que cruza el Mi√±o. Caminha es el punto final de nuestro recorrido en Portugal.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/c/c9/Caminha_e_Camposancos.JPG" alt="Caminha" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Caminha
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">‚úÖ CAMINHA - FIN DE ETAPA EN PORTUGAL</div><div class="distancia-acumulada">Distancia acumulada total: 26,8 km</div></div>
                        </div>
                    </div>
                    
                    <div id="map-etapa5" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa5()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Cargar Mapa Interactivo</button>

                    <div class="modal-section theme-photo" style="margin-top: 25px;">
                        <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                        <div class="pro-card">
                            <div id="photo-container-etapa5" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                                <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="document.getElementById('input-photo-etapa5').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üì∑ Seleccionar Foto</button>
                                <button onclick="removePhoto('etapa5')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üóëÔ∏è Borrar</button>
                            </div>
                            <input type="file" id="input-photo-etapa5" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa5', this)">
                        </div>
                    </div>

                </div>
            </div> <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü CASA SEBASTIAO TOURIST HOUSE *** (Caminha)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 05/06/2026 ‚Äì 06/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 150m del centro de Caminha</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Apartamento de 2 dormitorios</div>
                            <div class="accommodation-detail-line"><strong>Camas:</strong> 4 camas individuales</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size: 1.1em; font-weight: bold; color: #27ae60;">96‚Ç¨</span></div>
                        </div>
                        <a href="https://www.booking.com/Share-c8zbdNC" target="_blank" class="btn-alojamiento">Ver alojamiento en Booking</a>
                    </div>
                </div>

                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa5">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="‚úçÔ∏è Notas personales..." oninput="saveDiary('etapa5', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa5">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p>En esta √∫ltima jornada portuguesa disfrutaremos de las especialidades locales y de la excelente gastronom√≠a portuguesa:</p>
                        <ul style="padding-left: 20px;">
                            <li><strong>Vila Praia de √Çncora:</strong> Especialidades en caracoles y productos del mar.</li>
                            <li>Cocina casera y platos tradicionales en los pueblos del interior.</li>
                            <li><strong>Caminha:</strong> Amplia oferta de restaurantes con cocina t√≠pica portuguesa.</li>
                            <li>√öltimas oportunidades para degustar los pratos do dia portugueses.</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b;">üéí Otros (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #f9e79f; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent5">
                                <p>Desde Viana do Castelo hasta Vila Praia de √Çncora podemos utilizar la ruta oficial, que va por el interior, un tanto rompepiernas pero con buenas vistas, o bien seguir intuitivamente el litoral por playas y pasarelas, sin flechas pero sin p√©rdida posible. La distancia en ambas opciones resulta similar.<br><br>
                                <strong>VILA PRAIA DE AN√áORA</strong><br>
                                Adem√°s de un buen men√∫ a precio portugu√©s, en el restaurante Casa dos Caracois podemos degustar decenas de recetas con este molusco gaster√≥podo: caracol √† pescador, caracol na chapa, feijoada de caracol, caracol frito, tortilla de caracol‚Ä¶<br><br>
                                <strong>MOLEDO</strong><br>
                                El tramo entre Moledo y Caminha es por carretera y muy aburrido. La opci√≥n m√°s recomendable ser√≠a desviarse siguiendo la orilla del mar y cruzar la Mata do Camarido, con una playa preciosa y un bosque de pinos declarado Parque Nacional.<br><br>
                                <strong>CAMINHA</strong><br>
                                El camino pasa bajo la Torre do Rel√≥gio, por la √∫nica puerta que se conserva de la muralla medieval. Atenci√≥n a los horarios del ferry que cruza el r√≠o Mi√±o, pues var√≠an cada d√≠a en funci√≥n de la marea; adem√°s los lunes no hay servicio por descanso semanal.<br><br>
                                Hoy es nuestro √∫ltimo d√≠a del recorrido en Portugal, justo cuando nos hab√≠amos acostumbrado a la cocina casera y a los precios m√≥dicos de los men√∫s en sus restaurantes.</p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent5', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div> </div> </div> </div> ```
    <!-- MODAL ETAPA 6 -->
    <div class="modal-backdrop" id="modalEtapa6">
    <div class="modal-panel">
        
        <div class="modal-header">
            <h2>Etapa 6: Caminha ‚Üí Porto Moug√°s - Detalles Completos</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa6')">√ó</button>
        </div>

        <div class="modal-body">
            
            <div class="modal-left">

                <div class="widget-card" id="weather-etapa6" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Distancia:</strong> 23,5 km</li>
                            <li><strong>Duraci√≥n estimada:</strong> 5 horas 40 minutos</li>
                            <li><strong>Dificultad:</strong> Baja</li>
                            <li><strong>Tipo de etapa:</strong> Costera en Galicia, agreste y ventosa</li>
                            <li><strong>Pavimento:</strong> Ferry, caminos de tierra, carreteras, playas y senderos</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-elevation">
    <h3>‚õ∞Ô∏è Perfil de la Etapa</h3>
    <div class="pro-card">
        <div style="height: 150px; width: 100%;"> <canvas id="elevation-etapa6"></canvas> </div>
        <p style="font-size: 0.8em; color: #777; text-align: center; margin-top: 5px;">
            üìà Desnivel acumulado: <span id="gain-etapa6">--</span>m
        </p>
    </div>
</div>

                <div class="modal-section theme-route">
                    <h3>üìç Tramos y Puntos de Parada</h3>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 1: Caminha ‚Üí A Pasaxe (Ferry)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">0,7 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Desde el centro de Caminha nos acercamos al embarcadero, donde tomaremos el ferry que cruza el r√≠o Mi√±o hacia Galicia. Para informaci√≥n detallada sobre horarios y tarifas, consultar la secci√≥n de Curiosidades.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://static.laregion.es/clip/07065a38-527e-4d5e-b44f-7c337ecc93dc_source-aspect-ratio_1600w_0.jpg" alt="Ferry Caminha" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Ferry Caminha - A Guarda
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">‚õ¥Ô∏è A PASAXE (CAMPOSANCOS)</div><div class="distancia-acumulada">Distancia acumulada: 0,7 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 2: A Pasaxe ‚Üí A Guarda</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,6 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Nada m√°s salir del puerto caminaremos unos metros hacia la izquierda, pasando frente al edificio del antiguo colegio-internado de jesuitas. Tomamos la primera calle en subida y vamos siguiendo las flechas, que nos llevar√°n a rodear por la derecha el monte de Santa Tegra.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.turismoaguarda.es/wp-content/uploads/2016/05/viacrucis-1024x678.jpg" alt="Monte Santa Trega" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Monte Santa Trega - A Guarda
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç A GUARDA</div><div class="distancia-acumulada">Distancia acumulada: 4,3 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 3: A Guarda ‚Üí Portecelo</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">7,0 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Podemos seguir por la R√∫a San Bernardo o bien por la R√∫a Puerto Rico. Al final del aparcamiento de la playa comienza el tramo m√°s agreste de la etapa, durante el cual avanzaremos por un camino casi al nivel del mar y entre las rocas de la costa. Se trata de una parte de la Ruta de las Cetarias.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://elviajeroaccidental.com/wp-content/uploads/2022/04/Portada_ruta_cetareas.jpg" alt="Ruta de las Cetarias" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Ruta de las Cetarias
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç PORTECELO</div><div class="distancia-acumulada">Distancia acumulada: 11,3 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 4: Portecelo ‚Üí Oia</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">5,8 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Seguimos durante 2 km por la antigua Estrada Real, volviendo despu√©s al carril bici. Finalmente lo dejaremos tomando una pista asfaltada en bajada que lleva a la ermita de San Sebasti√°n.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.infobae.com/new-resizer/aUv_cAOidPzQOc6bsDVY7BJ7KvA=/arc-anglerfish-arc2-prod-infobae/public/B6HROS55RRFQBO5WH2GNHRGG3M.jpg" alt="Monasterio de Oia" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Monasterio de Oia
                                </figcaption>
                            </figure>
                            <p><strong>Monasterio cisterciense de Santa Mar√≠a (siglo XII),</strong> √∫nico de dicha orden construido frente al mar, en un emplazamiento espectacular y muy fotog√©nico.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç OIA</div><div class="distancia-acumulada">Distancia acumulada: 17,1 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 5: Oia ‚Üí O Serrallo</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,6 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Descendemos por la rampa empedrada entre la playa y el malec√≥n del monasterio, tras lo cual giramos a mano izquierda para seguir una pista de tierra que discurre entre muretes de piedra seca; disfrutaremos de un tramo de paisaje muy entretenido. A la altura de Punta Orelluda volvemos a la carretera.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç O SERRALLO</div><div class="distancia-acumulada">Distancia acumulada: 20,7 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 6: O Serrallo ‚Üí Porto Moug√°s (Final)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">2,8 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>S√≥lo 250 metros despu√©s del hotel Glasgow, tras superar una gasolinera, debemos cruzar la carretera por un paso de peatones y tomaremos una calle asfaltada en subida. Seguimos las indicaciones de las flechas para evitarnos un tramo peligroso de la carretera.</p>
                            <p>Finalmente bajamos de nuevo a la carretera, la cruzamos y torcemos a la izquierda por una pista de tierra. Pronto llegamos ante una playa de cantos rodados y la desembocadura del r√≠o Moug√°s, que cruzaremos gracias a un puentecillo met√°lico azul.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://caminhoportuguesdesantiago.eu/wp-content/uploads/2022/06/etapa-7.jpg" alt="Porto Moug√°s" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ El puerto de Moug√°s
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">‚úÖ PORTO MOUG√ÅS - FIN DE ETAPA</div><div class="distancia-acumulada">Distancia acumulada total: 23,5 km</div></div>
                        </div>
                    </div>

                    <div id="map-etapa6" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa6()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Cargar Mapa Interactivo</button>

                    <div class="modal-section theme-photo" style="margin-top: 25px;">
                        <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                        <div class="pro-card">
                            <div id="photo-container-etapa6" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                                <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="document.getElementById('input-photo-etapa6').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üì∑ Seleccionar Foto</button>
                                <button onclick="removePhoto('etapa6')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üóëÔ∏è Borrar</button>
                            </div>
                            <input type="file" id="input-photo-etapa6" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa6', this)">
                        </div>
                    </div>

                </div> 
            </div> <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü CASA TO√ëI *** (Porto Moug√°s)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 06/06/2026 ‚Äì 07/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 5,2 km del centro de Porto Moug√°s</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Apartamento</div>
                            <div class="accommodation-detail-line"><strong>Camas:</strong> 1 doble + 2 individuales</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size: 1.1em; font-weight: bold; color: #27ae60;">120‚Ç¨</span></div>
                        </div>
                        <a href="https://www.booking.com/Share-T4ieae" target="_blank" class="btn-alojamiento">Ver alojamiento en Booking</a>
                    </div>
                </div>

                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa6">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="‚úçÔ∏è Notas personales..." oninput="saveDiary('etapa6', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa6">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p>En esta primera etapa gallega disfrutaremos de la excelente gastronom√≠a de la costa atl√°ntica:</p>
                        <ul style="padding-left: 20px;">
                            <li><strong>A Guarda:</strong> Especialidades en crust√°ceos y marisco fresco.</li>
                            <li><strong>Oia:</strong> Cocina tradicional gallega junto al monasterio.</li>
                            <li><strong>Porto Moug√°s:</strong> Langosta, bogavante, centolla y otros manjares del mar.</li>
                            <li>Vinos gallegas y aceites locales.</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b; display: block; margin-bottom: 4px;">üéí Otros / Varios (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; padding-top: 10px; border-top: 1px dashed #f9e79f; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent6">
                                <p><strong>FERRY DEL R√çO MI√ëO</strong><br>
                                Atenci√≥n a los horarios del ferry que cruza el r√≠o Mi√±o: el primer transbordador sale de Caminha a las 10 de la ma√±ana (11h s√°bados y festivos), y luego cada hora en punto hasta las 19h, salvo si hay marea baja; adem√°s los lunes no hay servicio por descanso semanal.<br><br>
                                <strong>A GUARDA</strong><br>
                                Despu√©s de desembarcar en el puerto de A Pasaxe-Camposancos rodearemos el monte de Santa Tegra (Santa Tecla), en cuya cima se ha excavado un gran castro cuyo origen data del siglo IV a.C.<br><br>
                                <strong>OIA</strong><br>
                                Uno de los lugares m√°s fotog√©nicos de este camino es el monasterio de Santa Mar√≠a de Oia, abocado sobre la playa. Fundado a mediados del siglo XII, fue incorporado a la orden del C√≠ster en 1185.<br><br>
                                <strong>PORTO MOUG√ÅS</strong><br>
                                Los que se queden en Porto Moug√°s no pueden perderse la puesta de sol sobre el oc√©ano. A s√≥lo 1 km se halla el conjunto de petroglifos y el castro de A Cabeci√±a.</p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent6', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div> </div> </div> </div> ```
    <!-- MODAL ETAPA 7 -->
    <div class="modal-backdrop" id="modalEtapa7">
    <div class="modal-panel">
        
        <div class="modal-header">
            <h2>Etapa 7: Porto Moug√°s ‚Üí Baiona - Detalles Completos</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa7')">√ó</button>
        </div>

        <div class="modal-body">
            
            <div class="modal-left">

                <div class="widget-card" id="weather-etapa7" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Distancia:</strong> 11,5 km</li>
                            <li><strong>Duraci√≥n estimada:</strong> 4 horas</li>
                            <li><strong>Dificultad:</strong> Muy Baja</li>
                            <li><strong>Tipo de etapa:</strong> Costera, monte y villa hist√≥rica</li>
                            <li><strong>Pavimento:</strong> Carreteras, senderos, calzadas empedradas y calles urbanas</li>
                            <li><strong>Nota:</strong> Etapa corta ideal para disfrutar de Baiona</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-elevation">
    <h3>‚õ∞Ô∏è Perfil de la Etapa</h3>
    <div class="pro-card">
        <div style="height: 150px; width: 100%;"> <canvas id="elevation-etapa7"></canvas> </div>
        <p style="font-size: 0.8em; color: #777; text-align: center; margin-top: 5px;">
            üìà Desnivel acumulado: <span id="gain-etapa7">--</span>m
        </p>
    </div>
</div>

                <div class="modal-section theme-route">
                    <h3>üìç Tramos y Puntos de Parada</h3>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 1: Porto Moug√°s ‚Üí Pedra Rubia</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">1,8 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Se sigue la calle principal, en paralelo a la costa. Enlazamos con la carretera PO-552 y su carril bici, y en la siguiente curva tomamos una pista de tierra a la izquierda, que seguiremos hasta el camping O Mui√±o (que cuenta, por supuesto, con un molino con cierto aspecto manchego), en el lugar de Pedra Rubia.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://cf.bstatic.com/xdata/images/hotel/max1024x768/112222472.jpg?k=bdee898b68ce7a09ecb96306c9bb26f29486dfdac46f5eefa84de88932e5c7d8&o=" alt="Camping O Mui√±o" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Camping O Mui√±o
                                </figcaption>
                            </figure>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç PEDRA RUBIA</div>
                                <div class="distancia-acumulada">Distancia acumulada: 1,8 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 2: Pedra Rubia ‚Üí A Ermida</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">2,5 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Aqu√≠ volvemos al carril bici que va en paralelo a la carretera. Pasamos ante el hotel-restaurante O Pe√±asco, y al cabo de 150 metros un moj√≥n nos indica bajar hacia la costa para seguir un camino herboso, si bien en breve recula y vuelve a ascender a la carretera, en uno de esos casos en que s√≥lo el paisaje justifica el mini-rodeo. De nuevo por el carril bici superamos la Punta Centinela, mientras aparecen en la distancia el cabo Silleiro y su faro. Entramos en el lugar de A Ermida, apenas cuatro casas y un restaurante, antesala de As Mari√±as.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç A ERMIDA</div>
                                <div class="distancia-acumulada">Distancia acumulada: 4,3 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 3: A Ermida ‚Üí Baredo (Cami√±o da Portela)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,9 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Pasamos ante el hotel Soremma y al cabo de unos metros (sin dejar el carril bici, a pesar que alguna flecha as√≠ lo indique) llegamos al camping Moug√°s, que dispone de un curioso albergue solidario para peregrinos; ambos establecimientos abren s√≥lo de Semana Santa hasta finales de septiembre.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://dynamic-media-cdn.tripadvisor.com/media/photo-o/06/0b/ff/11/getlstd-property-photo.jpg?w=900&h=500&s=1" alt="Camping Moug√°s" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Camping Moug√°s - Oia
                                </figcaption>
                            </figure>
                            <p><strong>‚ö†Ô∏è ATENCI√ìN IMPORTANTE:</strong> Dejamos atr√°s el camping Moug√°s y seguimos por el carril bici durante 650 metros; aqu√≠ debemos estar muy atentos, ya que de repente las flechas nos indican cruzar la carretera ‚Äìcon precauci√≥n, pues no hay paso de peatones‚Äì para comenzar la subida hacia el monte por una rampa de hormig√≥n junto a unos chal√©s, que se convierte en camino de tierra, hierba y piedras, el Cami√±o da Portela. Cruzamos una cancela y nos enfrentamos a un trecho con pendiente del 20%, durillo si bien no excesivamente largo; as√≠ vamos ganando altura, hasta superar la cota del faro, que vemos a lo lejos, a nuestra izquierda y con el oc√©ano al fondo. Estamos sin duda en uno de los tramos m√°s bellos, m√°gicos y solitarios de este camino.</p>
                            <p>Seguimos una calzada antiqu√≠sima ‚Äìtal vez sea romana‚Äì con losas de piedra, utilizada durante siglos tanto para el pastoreo del ganado como por mercaderes en carros (pues vemos algunas hendiduras en las piedras para guiar el paso de las ruedas). Pasamos otra cancela y desembocamos en una llanura con afloramientos gran√≠ticos tras la cual, siempre de frente, comienza la bajada por bosque. Llegamos a una carreterilla asfaltada y la seguimos hasta las primeras casas del barrio de Cabreiro, en la parroquia de Baredo.</p>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">üìç BAREDO</div>
                                <div class="distancia-acumulada">Distancia acumulada: 8,2 km</div>
                            </div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 4: Baredo ‚Üí Baiona (Final de etapa)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">3,3 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Ahora toca seguir con atenci√≥n las flechas por las calles, entre las vallas de casas y chal√©s. Saldremos por el Cami√±o do R√≠o Peque√±o, una subida por asfalto, al final de la cual giramos bruscamente a la izquierda para seguir la carretera de Baredo (EP-2203) durante 700 metros, entre pinos y con buenas vistas sobre las islas C√≠es; llegamos a una encrucijada donde giraremos a la izquierda, pasando un viaducto sobre la gran brecha excavada de la autov√≠a AG-57. Acto seguido torcemos a la derecha, bordeando un parquecillo con una cruz y juegos infantiles, al que sigue un mirador con mesas de piedra y una p√©rgola, perfecto para disfrutar de la panor√°mica sobre Baiona y la entrada a la r√≠a de Vigo.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://s3.elespanol.com/2025/04/03/actualidad/1003743697190_254441039_1024x576.jpg" alt="Baiona" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Baiona - Vigo
                                </figcaption>
                            </figure>
                            <p>Siguiendo por la derecha llegamos a las casas del barrio de San Ant√≥n, la zona m√°s elevada de Baiona, y descendemos por sus calles hacia el casco urbano. Llegamos a una rotonda junto al campo de f√∫tbol y, frente a √©ste, el cementerio. Bordeando la valla met√°lica del estadio encontramos la capilla de Santa Liberata. A apenas 50 metros tenemos la excolegiata de Santa Mar√≠a, fundada en el siglo XII por los monjes cistercienses del cercano monasterio de Oia, con portada rom√°nica y naves interiores muy interesantes.</p>
                            <p>El camino sigue junto al muro de la iglesia y gira enseguida por la escalinata de la bonita R√∫a Manuel Valverde, que baja hacia la Praza do Consello (Ayuntamiento) y el paseo mar√≠timo, muy concurrido y tur√≠stico. Sin embargo, las flechas nos desv√≠an antes, pues tuercen a la derecha por la R√∫a do Conde, pasando ante la fuente de Zeta y de frente por la R√∫a Porta da Vila hasta el cruceiro da Sant√≠sima Trinidade, de estilo g√≥tico y cubierto con un soberbio templete o baldaquino de piedra. Continuamos a lo largo de la R√∫a Loureiral y la R√∫a do Burgo, por un recorrido intuitivo que sigue el trazado de la antigua calzada romana, en paralelo a la costa. Cruzamos un puentecillo de piedra sobre el r√≠o Ba√≠√±a con un lavadero en su cauce, y tras recorrer la Rua do Cruceiro llegamos a una avenida que conecta con las autopistas; la cruzamos y entramos en el barrio de Sabar√≠s.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.turismo.gal/osdam/filestore/1/1/2/7/7/8_2e9e92e0828388a/112778scr_6e1d33caee0fa8c.jpg" alt="Cruceiro" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Cruceiro da Sant√≠sima Trinidade
                                </figcaption>
                            </figure>
                            <div class="punto-parada">
                                <div class="punto-parada-nombre">‚úÖ BAIONA - FIN DE ETAPA</div>
                                <div class="distancia-acumulada">Distancia acumulada total: 11,5 km</div>
                            </div>
                        </div>
                    </div>

                    <div id="map-etapa7" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa7()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Cargar Mapa Interactivo</button>

                    <div class="modal-section theme-photo" style="margin-top: 25px;">
                        <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                        <div class="pro-card">
                            <div id="photo-container-etapa7" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                                <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="document.getElementById('input-photo-etapa7').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üì∑ Seleccionar Foto</button>
                                <button onclick="removePhoto('etapa7')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer;">üóëÔ∏è Borrar</button>
                            </div>
                            <input type="file" id="input-photo-etapa7" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa7', this)">
                        </div>
                    </div>

                </div> 
            </div> <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü APARTAMENTO MARI√ëEIRO *** (Baiona)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 07/06/2026 ‚Äì 09/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Duraci√≥n:</strong> 2 noches (descanso)</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 600m del centro de Baiona</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Apartamento de 2 dormitorios</div>
                            <div class="accommodation-detail-line"><strong>Camas:</strong> 2 individuales + 1 doble</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size: 1.1em; font-weight: bold; color: #27ae60;">256,80‚Ç¨</span> (2 noches)</div>
                        </div>
                        <a href="https://www.booking.com/Share-68H8KFH" target="_blank" class="btn-alojamiento">Ver alojamiento en Booking</a>
                    </div>
                </div>

                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa7">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="‚úçÔ∏è Notas personales..." oninput="saveDiary('etapa7', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa7">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p>Baiona es el para√≠so de los amantes del marisco gallego:</p>
                        <ul style="padding-left: 20px;">
                            <li><strong>Pulpo a la gallega</strong> - especialidad local.</li>
                            <li><strong>Percebes del Cabo Silleiro</strong> - manjares del mar.</li>
                            <li><strong>Erizos de mar</strong> - delicias primaverales.</li>
                            <li><strong>N√©coras</strong> - crust√°ceos de la costa.</li>
                            <li>Vinos de la comarca de Pontevedra.</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b;">üéí Otros (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; text-align: right; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent7">
                                <p>Hoy os sugerimos una etapa corta en kilometraje pero muy variada en su contenido, con tramos de costa salvaje, un recorrido muy bonito por monte y la visita obligada a la villa de Baiona, muy tur√≠stica y que merece una pausa cultural y gastron√≥mica.<br><br>
Al inicio de la jornada recorreremos parajes de costa rocosa, expuesta al viento y a las olas del Atl√°ntico. Resulta un h√°bitat perfecto para las aves marinas, tales como diferentes especies de gaviotas y cormoranes; √©stos, tambi√©n conocidos como cuervos marinos, son grandes nadadores tanto en superficie como buceando para pescar sus presas.<br>
Durante la ruta se pasa cerca de varios petroglifos, misteriosas inscripciones sobre roca realizadas por los pobladores de la Edad del Bronce hacia el 2500 a.C., la misma √©poca de las pir√°mides de Egipto o del monumento megal√≠tico de Stonehenge.<br>
Atenci√≥n a los caminantes: despu√©s del camping Moug√°s debemos seguir el carril bici durante 650 metros, y justo all√≠ las flechas indican cruzar la carretera ‚Äìcon precauci√≥n, pues no hay paso de peatones‚Äì para comenzar la subida hacia el monte, por un tramo agreste y solitario con senderos de tierra y calzadas empedradas, sin duda uno de los m√°s bellos de este camino.<br>
En este tramo por monte, donde deberemos abrir y cerrar varias cancelas, tal vez veamos caballos salvajes; son de una raza aut√≥ctona y se utilizan en la famosa fiesta de los Curros o Rapa das Bestas que se celebra en varias localidades entre mayo y julio, donde una multitud acorrala a los equinos para meterlos en el curro ‚Äìrecinto cerrado‚Äì, raparles la crin y marcarlos.<br>
Una de las estampas m√°s fotog√©nicas de la etapa es la panor√°mica desde el camino sobre el faro de Cabo Silleiro, con el azul del oc√©ano como tel√≥n de fondo. El farol fue construido en 1924 para sustituir al anterior de 1862, en un punto de navegaci√≥n peligrosa por los escollos, la proximidad a las islas C√≠es y las Estelas, y la entrada a la r√≠a de Vigo.<br><br>
<strong>BAIONA</strong><br>
En marzo de 1493 arrib√≥ a Baiona la carabela Pinta tras el descubrimiento del Nuevo Mundo, comandada por Mart√≠n Alonso Pinz√≥n, y en homenaje a esta gesta se ha instalado en el puerto una r√©plica de dicha nave, que puede visitarse; adem√°s cada a√±o celebran la efem√©ride con una multitudinaria fiesta medieval.<br>
El camino pasa ante la barroca capilla de Santa Liberata, una joven m√°rtir nacida en Baiona en el siglo II que se considera la primera mujer cristiana que muri√≥ crucificada; la incre√≠ble historia de la ni√±a, sus ocho hermanas gemelas y su nodriza es digna de una pel√≠cula gore, m√°xime cuando al final descubrimos que el gobernador romano que dict√≥ su pena de muerte resulta que era, sin saberlo, el verdadero padre de la ni√±a.<br>
A pocos metros de la capilla antedicha est√° la excolegiata de la Anunciada, iglesia rom√°nica con un gran roset√≥n. A la salida de la villa descubriremos el cruceiro da Trinidade, del siglo XV y cubierto por un soberbio templete.<br>
No hay m√°s que repasar los productos propios de la zona: pulpo, n√©coras, erizos, percebes del Cabo Silleiro‚Ä¶ ¬øa qui√©n no se le hace la boca agua?<br>
Pasaremos aqu√≠ en Baiona 2 noches para descansar y conocer las Islas C√≠es.
                                </p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent7', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div> </div> </div> </div> ```
    <!-- MODAL ETAPA 9 -->
    <div class="modal-backdrop" id="modalEtapa9">
    <div class="modal-panel">
        
        <div class="modal-header">
            <h2>Etapa 9: Padr√≥n ‚Üí Santiago de Compostela - ¬°La Meta!</h2>
            <button class="modal-close" onclick="closeModal('modalEtapa9')">√ó</button>
        </div>

        <div class="modal-body">
            
            <div class="modal-left">

                <div class="widget-card" id="weather-etapa9" style="margin-bottom: 25px;">
                    <div class="weather-header">
                        <div class="weather-info">
                            <div class="weather-temp">--¬∞C</div>
                            <div class="weather-desc-group">
                                <span class="weather-desc">Cargando clima...</span>
                                <span class="weather-advice">Preparando consejos...</span>
                            </div>
                        </div>
                        <div class="weather-icon">‚è≥</div>
                    </div>
                </div>

                <div class="modal-section theme-info">
                    <h3>‚ö° Datos r√°pidos</h3>
                    <div class="pro-card">
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li><strong>Distancia:</strong> 24,3 km</li>
                            <li><strong>Duraci√≥n estimada:</strong> 6 horas</li>
                            <li><strong>Dificultad:</strong> Baja</li>
                            <li><strong>Tipo de etapa:</strong> Urbana, monumental y emocionante</li>
                            <li><strong>Pavimento:</strong> Asfalto, aceras y tramos de tierra</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-elevation">
    <h3>‚õ∞Ô∏è Perfil de la Etapa</h3>
    <div class="pro-card">
        <div style="height: 150px; width: 100%;"> <canvas id="elevation-etapa9"></canvas> </div>
        <p style="font-size: 0.8em; color: #777; text-align: center; margin-top: 5px;">
            üìà Desnivel acumulado: <span id="gain-etapa9">--</span>m
        </p>
    </div>
</div>

                <div class="modal-section theme-route">
                    <h3>üìç Tramos y Puntos de Parada</h3>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 1: Padr√≥n ‚Üí Iria Flavia</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">1,0 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Siguiendo la misma direcci√≥n por la que llegamos ayer, por delante de la iglesia de Santiago, tomamos la calle Murgad√°n y, tras un giro a la derecha, nos aproximamos en diagonal a nuestra nacional N-550, a la que llegamos tras cruzar una canalizaci√≥n del r√≠o Sar.</p>
                            <p>Cruzamos la N-550 por el paso de peatones con precauci√≥n. El camino nos conduce a la parte trasera de la colegiata de Iria Flavia (ver curiosidades).</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.viajandoconpio.com/wp-content/uploads/2013/03/049044_HDR.jpg" alt="Colegiata de Iria Flavia" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Colegiata de Iria Flavia
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç IRIA FLAVIA</div><div class="distancia-acumulada">Distancia acumulada: 1,0 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 2: Iria Flavia ‚Üí A Escravitude</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">4,8 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Enseguida volvemos a la N-550 para tomar, por su derecha, un carril que nos lleva a la v√≠a del tren; la cruzamos a nivel. Continuamos recto, alcanzamos de nuevo la N-550, la cruzamos por el paso de peatones con mucha precauci√≥n y la vamos siguiendo.</p>
                            <p>Dejamos la N-550 por una calle a mano izquierda. Atravesamos luego una retah√≠la de peque√±os n√∫cleos rural-urbanos; finalmente, al lado de la v√≠a del tren, volvemos por en√©sima vez a la N-550, y tambi√©n por en√©sima vez la cruzamos con mucha precauci√≥n. Y la seguimos por la izquierda.</p> 
                            <p>Llegamos al imponente santuario barroco da Escravitude, donde cuenta la leyenda que un esclavo se cur√≥ de su enfermedad bebiendo de su Fuente Santa.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.iglesiaenpadron.com/wp-content/uploads/2017/05/IMG-PARROQUIAS-ESCLAVITUD.jpg" alt="Santuario da Escravitude" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Santuario da Escravitude
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç A ESCRAVITUDE</div><div class="distancia-acumulada">Distancia acumulada: 5,8 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 3: A Escravitude ‚Üí O Faramello</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">4,1 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Por la derecha de la nacional ascendemos hasta la iglesia de Santa Mar√≠a de Cruces, dejando la aldea de Cruces a mano derecha. M√°s adelante tomamos una pista forestal que nos desciende hasta la v√≠a del tren; la cruzamos y, despu√©s de un bonito tramo bajo un emparrado de vi√±as, alcanzamos la N-550</p>
                            <p>Nacional N-550 (a la altura de la pensi√≥n-bar-restaurante Alfonso). Seguimos la nacional por la derecha; a 800 metros la dejamos por una carretera a mano izquierda, por la cual cruzamos O Faramello, un lugar estrechamente ligado a la literatura gallega.</p>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç O FARAMELLO</div><div class="distancia-acumulada">Distancia acumulada: 9,9 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 4: O Faramello ‚Üí R√∫a de Francos</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">0,7 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Seguimos por pista asfaltada a mano izquierda. Es un tramo corto que nos deja en el lugar de R√∫a de Francos, donde se encuentra uno de los cruceiros m√°s antiguos de Galicia.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/6/65/Cruceiro_en_R%C3%BAa_de_Francos%2C_Calo%2C_Teo.jpg" alt="Cruceiro" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Cruceiro en R√∫a de Francos
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç R√öA DE FRANCOS</div><div class="distancia-acumulada">Distancia acumulada: 10,6 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 5: R√∫a de Francos ‚Üí O Milladoiro</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">6,2 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Doblamos a la izquierda y poco despu√©s, junto al restaurante Carboeiro, tomamos una pista de tierra que nos baja a un cruce, tras el cual ascendemos por una pista asfaltada en la misma direcci√≥n.</p>
                            <p>Comenzamos el ascenso hacia O Milladoiro, conocido como el "Humilladero" porque desde aqu√≠ los peregrinos ve√≠an por primera vez las torres de la Catedral y se arrodillaban. Llegamos a la capilla de Santa Mar√≠a Magdalena.</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://www.upmilladoiro.org/wp-content/uploads/2016/11/Santa_Maria_Magdalena03.jpg" alt="Capilla de Santa Mar√≠a Magdalena" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Capilla de Santa Mar√≠a Magdalena
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üìç O MILLADOIRO (MONTE AGRO DOS MONTEIROS)</div><div class="distancia-acumulada">Distancia acumulada: 16,8 km</div></div>
                        </div>
                    </div>

                    <div class="tramo">
                        <div class="tramo-header">
                            <h4>Tramo 6: O Milladoiro ‚Üí Santiago (Catedral)</h4>
                            <div class="tramo-header-right"><span class="tramo-distance">7,5 km</span><span class="tramo-toggle-icon">Ôºã</span></div>
                        </div>
                        <div class="tramo-content">
                            <p>Descendemos cruzando O Porto de Conxo. Salvamos las v√≠as del AVE y la autopista para llegar a Ponte Vella sobre el r√≠o Sar.</p>
                            <p>Entramos en la ciudad por la Avenida da Choupana y Rosal√≠a de Castro. La emoci√≥n aumenta a cada paso. Subimos por la R√∫a do Franco, llena de restaurantes y vida, hasta desembocar finalmente en la <strong>Plaza del Obradoiro</strong>. ¬°Lo hemos conseguido!</p>
                            <figure style="margin: 15px 0; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                                <img src="https://media.istockphoto.com/id/2149823529/es/foto/catedral-de-santiago-de-compostela-al-amanecer-con-plaza-principal-praza-do-obradoiro-galicia.jpg?s=612x612&w=0&k=20&c=C4lIXJMAirWk0kvirKqIMSlEvd3lhcGDfpncreYAMbo=" alt="Plaza del Obradoiro" style="width: 100%; height: 200px; object-fit: cover; display: block;">
                                <figcaption style="background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9em; text-align: center; font-weight: 500;">
                                    üåâ Plaza del Obradoiro
                                </figcaption>
                            </figure>
                            <div class="punto-parada"><div class="punto-parada-nombre">üèÅ SANTIAGO DE COMPOSTELA</div><div class="distancia-acumulada">Distancia acumulada total: 24,3 km</div></div>
                        </div>
                    </div>

                    <div id="map-etapa9" style="height: 350px; width: 100%; border-radius: 10px; margin-top: 20px; border: 2px solid #ddd; z-index: 1;"></div>
                    <button onclick="cargarMapaEtapa9()" class="btn-route-map" style="margin-top: 10px;">üó∫Ô∏è Cargar Mapa Interactivo</button>

                    <div class="modal-section theme-photo" style="margin-top: 25px;">
                        <h3>üì∏ Mi Recuerdo del D√≠a</h3>
                        <div class="pro-card">
                            <div id="photo-container-etapa9" class="photo-preview" style="width: 100%; height: 250px; background: #f9f9f9; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 12px; border: 2px dashed #e91e63; position: relative;">
                                <span style="color: #e91e63; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="document.getElementById('input-photo-etapa9').click()" style="flex: 2; background: #e91e63; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.85em;">üì∑ Seleccionar Foto</button>
                                <button onclick="removePhoto('etapa9')" style="flex: 1; background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; padding: 10px; border-radius: 8px; cursor: pointer;">üóëÔ∏è Borrar</button>
                            </div>
                            <input type="file" id="input-photo-etapa9" accept="image/*" style="display: none;" onchange="handlePhotoUpload('etapa9', this)">
                        </div>
                    </div>

                </div> 
            </div> <div class="modal-right">
                
                <div class="modal-section theme-sleep">
                    <h3>üè® Alojamiento</h3>
                    <div class="accommodation-card">
                        <h4>üåü PENSI√ìN DA SELA *** (Santiago)</h4>
                        <div class="accommodation-details">
                            <div class="accommodation-detail-line"><strong>Fechas:</strong> 10/06/2026 ‚Äì 11/06/2026</div>
                            <div class="accommodation-detail-line"><strong>Ubicaci√≥n:</strong> A 1,4 Km del centro (zona tranquila)</div>
                            <div class="accommodation-detail-line"><strong>Tipo:</strong> Habitaci√≥n Familiar</div>
                            <div class="accommodation-detail-line"><strong>Precio:</strong> <span style="font-size: 1.1em; font-weight: bold; color: #27ae60;">116‚Ç¨</span></div>
                        </div>
                        <a href="https://www.booking.com/Share-tzAcNg3" target="_blank" class="btn-alojamiento">Ver alojamiento en Booking</a>
                    </div>
                </div>

                <div class="modal-section theme-diary">
                    <h3>‚úçÔ∏è Diario Personal</h3>
                    <div class="pro-card">
                        <div id="diary-etapa9">
                            <div class="diary-body">
                                <textarea class="diary-textarea" placeholder="Querido diario: ¬°He llegado! Mis sentimientos al ver la Catedral..." oninput="saveDiary('etapa9', this.value)"></textarea>
                            </div>
                            <div class="diary-footer" style="margin-top: 5px;">
                                <span>Guardado autom√°tico</span>
                                <span id="status-etapa9">‚úÖ</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-food">
                    <h3>üçΩÔ∏è Gastronom√≠a</h3>
                    <div class="pro-card">
                        <p><strong>Especialidades para celebrar en Santiago:</strong></p>
                        <ul style="padding-left: 20px;">
                            <li><strong>Mariscada de celebraci√≥n:</strong> T√≠pico en la R√∫a do Franco.</li>
                            <li><strong>Tarta de Santiago:</strong> Postre obligado de almendras.</li>
                            <li><strong>Tapas gratis:</strong> Con cada consumici√≥n en los bares.</li>
                            <li><strong>Mercado de Abastos:</strong> Productos frescos y pulpeiras.</li>
                        </ul>
                    </div>
                </div>

                <div class="modal-section theme-money">
                    <h3>üí∞ Mis Gastos (Etapa)</h3>
                    <div class="pro-card">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b;">üè® Alojamiento (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="alojamiento" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                            <div>
                                <label style="font-size: 0.8em; color: #b7950b;">üçΩÔ∏è Comida (‚Ç¨)</label>
                                <input type="number" class="expense-input" data-cat="comida" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="font-size: 0.8em; color: #b7950b;">üéí Otros (‚Ç¨)</label>
                            <input type="number" class="expense-input" data-cat="otros" placeholder="0" style="width:100%; padding:8px; border:1px solid #f9e79f; border-radius:4px; font-size: 0.9em;">
                        </div>
                        <div style="margin-top: 15px; text-align: right; font-weight: bold; color: #b7950b; font-size: 1em; text-align: right;">
                            Total Etapa: <span class="subtotal-etapa" style="color: #d4ac0d;">0</span>‚Ç¨
                        </div>
                    </div>
                </div>

                <div class="modal-section theme-curious">
                    <h3>ü§ì Curiosidades</h3>
                    <div class="pro-card">
                        <div class="expandible-text">
                            <div class="expandible-content collapsed" id="expandibleContent9">
                                <p><strong>IRIA FLAVIA</strong><br>
                                Podemos visitar la bell√≠sima colegiata, que fue la primera catedral de Galicia. En su cementerio de Adina reposa el escritor Camilo Jos√© Cela, Premio Nobel, bajo un olivo.<br><br>
                                <strong>A ESCRAVITUDE</strong><br>
                                Encontramos el barroco Santuario da Escravitude y su Fuente Santa, famosa por sus supuestas propiedades curativas.<br><br>
                                <strong>SANTIAGO DE COMPOSTELA</strong><br>
                                La Oficina de Acogida al Peregrino (R√∫a Carretas, 33) es donde se expide la "Compostela", el certificado oficial que acredita nuestra peregrinaci√≥n.<br><br>
                                En la catedral, no os perd√°is el abrazo al Ap√≥stol en el Altar Mayor y la visita a la cripta con sus restos. Si ten√©is suerte (o si coincide con una festividad), podr√©is ver el famoso <strong>Botafumeiro</strong> en acci√≥n, un incensario gigante de 60 kg que vuela por la nave central a gran velocidad impulsado por los "tiraboleiros".<br><br>
                                ¬°Enhorabuena peregrinos! Hab√©is completado el Camino Portugu√©s de la Costa. ¬°Buen Camino y buena vida!</p>
                                <div class="expandible-fade"></div>
                            </div>
                            <button class="btn-expandible" onclick="toggleExpand('expandibleContent9', this)">Leer m√°s</button>
                        </div>
                    </div>
                </div>

            </div> </div> </div> </div> ```

    <button class="btn-sos" onclick="openEmergencyModal()" title="Emergencias">
    üÜò
</button>

<div class="modal-backdrop" id="modalSOS">
    <div class="modal-panel" style="max-width: 400px; text-align: center;">
        <div class="modal-header" style="background: #e74c3c; color: white; justify-content: center; border-bottom: none;">
            <h2 style="margin:0; font-size: 1.5em;">üÜò CENTRO DE AYUDA</h2>
        </div>
        <div class="modal-body" style="display: block; padding: 25px;">
            
            <p style="color: #666; margin-bottom: 20px;">
                Elige la opci√≥n seg√∫n tu situaci√≥n:
            </p>

            <a href="tel:112" style="display: block; background: #e74c3c; color: white; text-decoration: none; padding: 15px; border-radius: 10px; font-size: 1.2em; font-weight: bold; box-shadow: 0 4px 10px rgba(231,76,60,0.3); transition: transform 0.2s;">
                üìû LLAMAR AL 112
            </a>
            
            <div class="sos-divider">O TAMBI√âN</div>

            <button onclick="sendWhatsappLocation()" class="btn-whatsapp-sos">
                <span style="font-size: 1.3em;">üí¨</span> Enviar "Estoy Aqu√≠"
            </button>

            <div id="sos-status" style="font-size: 0.85em; color: #888; min-height: 20px; margin-top: 10px;"></div>

            <button onclick="closeModal('modalSOS')" style="margin-top: 20px; background: transparent; border: 1px solid #aaa; padding: 8px 25px; border-radius: 20px; cursor: pointer; color: #666; font-size: 0.9em;">
                Cerrar
            </button>
        </div>
    </div>
</div>

    <script>
        function openModal(modalId) {
    document.getElementById(modalId).classList.add('show');
    
    // Convertimos 'modalEtapa1' en 'etapa1' para buscar los datos
    const cleanId = modalId.replace('modal', '').toLowerCase();
    
    // Cargamos el diario, el clima y los gastos
    loadDiaryWidget(cleanId);
    loadExpensesIntoModal(cleanId);

    loadElevationProfile(cleanId);

    // --- NUEVO: CARGAR LA FOTO DEL D√çA SI EXISTE ---
    const savedPhoto = localStorage.getItem(`photo_${cleanId}`);
    if (savedPhoto) {
        displayPhoto(cleanId, savedPhoto);
    }
}

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        function toggleExpand(contentId, button) {
            const content = document.getElementById(contentId);
            content.classList.toggle('collapsed');
            button.textContent = content.classList.contains('collapsed') ? 'Leer m√°s' : 'Leer menos';
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.modal-backdrop').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('show');
                    }
                });
            });

            // 1. Esta funci√≥n se activa cuando eliges una foto
function handlePhotoUpload(etapaId, input) {
    const file = input.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const imageData = e.target.result;
            // ESTA L√çNEA ES LA QUE GUARDA EN EL NAVEGADOR
            localStorage.setItem(`photo_${etapaId}`, imageData); 
            displayPhoto(etapaId, imageData);
        };
        reader.readAsDataURL(file);
    }
}

// 2. Esta funci√≥n pone la imagen f√≠sicamente en el cuadro
function displayPhoto(etapaId, imageData) {
    const container = document.getElementById(`photo-container-${etapaId}`);
    if (container) {
        container.innerHTML = `<img src="${imageData}" style="width: 100%; height: 100%; object-fit: cover; cursor: pointer;" onclick="window.open('${imageData}')">`;
        container.style.border = "none";
    }
}

// 3. Por si quieres borrarla y poner otra
function removePhoto(etapaId) {
    if (confirm("¬øQuieres borrar esta foto?")) {
        localStorage.removeItem(`photo_${etapaId}`);
        const container = document.getElementById(`photo-container-${etapaId}`);
        if (container) {
            container.innerHTML = `<span style="color: #3498db; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>`;
            container.style.border = "2px dashed #3498db";
        }
    }
}

            document.querySelectorAll('.tramo-header').forEach(header => {
                header.addEventListener('click', function() {
                    const tramo = this.closest('.tramo');
                    const isOpen = tramo.classList.contains('open');
                    tramo.classList.toggle('open');
                    const icon = tramo.querySelector('.tramo-toggle-icon');
                    if (icon) icon.textContent = isOpen ? 'Ôºã' : '‚àí';
                });
            });
        });
        // --- CUENTA ATR√ÅS (HYPE TRAIN) ---
    // Fecha de inicio: 1 de Junio de 2026 a las 08:00 AM
    const fechaInicio = new Date("June 1, 2026 08:00:00").getTime();

    const x = setInterval(function() {
        const ahora = new Date().getTime();
        const distancia = fechaInicio - ahora;

        const dias = Math.floor(distancia / (1000 * 60 * 60 * 24));
        const horas = Math.floor((distancia % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutos = Math.floor((distancia % (1000 * 60 * 60)) / (1000 * 60));

        const elemento = document.getElementById("countdown");
        if (elemento) {
            elemento.innerHTML = dias + "d " + horas + "h " + minutos + "m ";
            
            if (distancia < 0) {
                clearInterval(x);
                elemento.innerHTML = "¬°BUEN CAMINO!";
                elemento.style.color = "#2ecc71";
            }
        }
    }, 1000);
        // --- L√ìGICA DE LA BARRA DE PROGRESO ---

    function updateProgress() {
        const checkboxes = document.querySelectorAll('.etapa-checkbox');
        const total = checkboxes.length;
        let checkedCount = 0;

        checkboxes.forEach(box => {
            // 1. Verificar si est√° marcado
            if (box.checked) {
                checkedCount++;
                // A√±adir clase visual a la tarjeta padre
                box.closest('.etapa').classList.add('completed');
                // Guardar en memoria del navegador
                localStorage.setItem(box.dataset.id, 'true');
            } else {
                box.closest('.etapa').classList.remove('completed');
                localStorage.setItem(box.dataset.id, 'false');
            }
        });

        // 2. Calcular porcentaje
        const percentage = Math.round((checkedCount / total) * 100);

        // 3. Actualizar la barra visual
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');

        progressBar.style.width = percentage + '%';
        progressBar.textContent = percentage + '%'; // Texto dentro de la barra
        progressText.textContent = checkedCount + '/' + total + ' Completadas';
        
        // Celebraci√≥n si llegas al 100%
        if (percentage === 100) {
            progressBar.style.backgroundColor = '#f1c40f'; // Dorado
            progressBar.textContent = '¬°CAMINO COMPLETADO! üèÜ';
        }
    }

    // --- CARGAR DATOS GUARDADOS AL ABRIR LA P√ÅGINA ---
    function loadSavedProgress() {
        const checkboxes = document.querySelectorAll('.etapa-checkbox');
        
        checkboxes.forEach(box => {
            const savedState = localStorage.getItem(box.dataset.id);
            if (savedState === 'true') {
                box.checked = true;
            }
        });
        
        // Actualizar la barra inicial
        updateProgress();
    }

    // Ejecutar al cargar la p√°gina
    document.addEventListener('DOMContentLoaded', function() {
        // ... (tu c√≥digo anterior) ...
        loadSavedProgress(); // Cargar progreso
    });
    document.addEventListener('DOMContentLoaded', function() {
    // ... tu c√≥digo anterior (como los quotes) ...
    
    loadSavedProgress(); // Carga el progreso de etapas
    loadBackpackState(); // Carga el estado de la mochila
    
    // A√ëADE ESTA L√çNEA AQU√ç:
    refreshGlobalTotal(); 
});

    // --- NUEVO: CONFIGURACI√ìN DE COORDENADAS PARA EL TIEMPO ---
    const stageCoordinates = {
        'etapa1': { lat: 41.275, lon: -8.729, name: 'Labruge' },
        'etapa2': { lat: 41.380, lon: -8.760, name: 'P√≥voa de Varzim' },
        'etapa3': { lat: 41.536, lon: -8.784, name: 'Marinhas' },
        'etapa4': { lat: 41.693, lon: -8.832, name: 'Viana do Castelo' },
        'etapa5': { lat: 41.876, lon: -8.838, name: 'Caminha' },
        'etapa6': { lat: 42.046, lon: -8.892, name: 'Porto Moug√°s' },
        'etapa7': { lat: 42.119, lon: -8.850, name: 'Baiona' },
        'etapa8': { lat: 42.738, lon: -8.661, name: 'Padr√≥n' }, 
        'etapa9': { lat: 42.880, lon: -8.544, name: 'Santiago' }
    };

    async function loadDiaryWidget(etapaId) {
    // 1. CARGAR DIARIO
    const diaryContainer = document.getElementById(`diary-${etapaId}`);
    if (diaryContainer) {
        const savedText = localStorage.getItem(`diary_text_${etapaId}`) || '';
        const textarea = diaryContainer.querySelector('.diary-textarea');
        if (textarea) textarea.value = savedText;
    }

    // 2. CARGAR TIEMPO PRO
    const weatherContainer = document.getElementById(`weather-${etapaId}`);
    const coords = stageCoordinates[etapaId];

    if (weatherContainer && coords) {
        try {
            const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current_weather=true&timezone=auto`);
            const data = await response.json();
            const header = weatherContainer.querySelector('.weather-header');
            
            // L√≥gica de estados y consejos
            const code = data.current_weather.weathercode;
            const temp = Math.round(data.current_weather.temperature);
            let icon, desc, consejo, climaClass;

            if (code === 0) {
                icon = '‚òÄÔ∏è'; desc = 'Despejado'; climaClass = 'weather-sunny';
                consejo = temp > 25 ? "üî• Calor: hidr√°tate mucho y usa crema." : "ü•æ D√≠a perfecto para caminar.";
            } else if (code <= 3) {
                icon = '‚õÖ'; desc = 'Nublado'; climaClass = 'weather-cloudy';
                consejo = "‚òÅÔ∏è Ideal para no quemarse. Mant√©n el ritmo.";
            } else if (code >= 51 && code <= 67) {
                icon = 'üåßÔ∏è'; desc = 'Lluvia'; climaClass = 'weather-rainy';
                consejo = "‚òî ¬°Chubasquero fuera! Protege tu mochila.";
            } else if (code >= 95) {
                icon = '‚õàÔ∏è'; desc = 'Tormenta'; climaClass = 'weather-storm';
                consejo = "‚ö†Ô∏è Tormenta: busca refugio si arrecia.";
            } else {
                icon = 'üå´Ô∏è'; desc = 'Niebla'; climaClass = 'weather-cloudy';
                consejo = "üå´Ô∏è Poca visibilidad: atento a las flechas.";
            }

            // Aplicar clase de color al header
            header.className = `weather-header ${climaClass}`;

            // Actualizar el HTML interior con la nueva estructura
            weatherContainer.innerHTML = `
                <div class="weather-header ${climaClass}">
                    <div class="weather-info">
                        <div class="weather-temp">${temp}¬∞C</div>
                        <div class="weather-desc-group">
                            <span class="weather-desc">${desc} en ${coords.name}</span>
                            <span class="weather-advice">${consejo}</span>
                        </div>
                    </div>
                    <div class="weather-icon">${icon}</div>
                </div>
            `;
            
        } catch (error) {
            console.error("Error al cargar el clima:", error);
        }
    }
}

    function saveDiary(etapaId, text) {
        localStorage.setItem(`diary_text_${etapaId}`, text);
        const statusSpan = document.getElementById(`status-${etapaId}`);
        if(statusSpan) {
            statusSpan.innerText = "Guardado ‚úÖ";
            setTimeout(() => statusSpan.innerText = "Autoguardado activo", 2000);
        }
    }


    // --- L√ìGICA VISTA LISTA VS DETALLE ---
function switchView(mode, btn) {
    const container = document.querySelector('.etapas-container');
    
    // 1. Buscamos TODOS los botones del selector (usando la nueva clase 'pro')
    const buttons = document.querySelectorAll('.view-btn-pro');
    
    // 2. Les quitamos la clase 'active' a todos (los "apagamos")
    buttons.forEach(b => {
        b.classList.remove('active');
    });
    
    // 3. Activamos SOLO el bot√≥n que has pulsado
    if(btn) {
        btn.classList.add('active');
    }

    // 4. Cambiamos el modo de visualizaci√≥n
    if (mode === 'list') {
        container.classList.add('list-mode');
    } else {
        container.classList.remove('list-mode');
    }
    
    // 5. Guardamos la preferencia
    localStorage.setItem('viewMode', mode);
}

    // --- L√ìGICA MOCHILA ---
    function updateBackpack() {
        const inputs = document.querySelectorAll('.backpack-item input');
        let checkedCount = 0;
        
        inputs.forEach(input => {
            // Guardar estado
            localStorage.setItem(input.id, input.checked);
            if(input.checked) checkedCount++;
        });

        // Calcular porcentaje visual
        const percent = inputs.length > 0 ? Math.round((checkedCount / inputs.length) * 100) : 0;
        const progressSpan = document.getElementById('backpack-progress');
        if(progressSpan) progressSpan.innerText = percent;
    }

    // --- NUEVA L√ìGICA MOCHILA PRO ---
function updateBackpackPro() {
    // 1. Ejecutamos la l√≥gica antigua para guardar en memoria
    updateBackpack(); 

    // 2. Actualizamos la nueva barra visual PRO
    const inputs = document.querySelectorAll('.check-item input');
    let checkedCount = 0;
    inputs.forEach(input => { if(input.checked) checkedCount++; });

    const percent = inputs.length > 0 ? Math.round((checkedCount / inputs.length) * 100) : 0;
    
    // Actualizar texto
    const textSpan = document.getElementById('backpack-progress-text');
    if(textSpan) textSpan.innerText = percent + '%';

    // Actualizar barra de color
    const bar = document.getElementById('backpack-progress-bar');
    if(bar) {
        bar.style.width = percent + '%';
        // Cambiar color si est√° completo
        if(percent === 100) bar.style.background = '#f1c40f'; // Dorado
        else bar.style.background = '#27ae60'; // Verde
    }
}

    function loadBackpackState() {
        const inputs = document.querySelectorAll('.backpack-item input');
        inputs.forEach(input => {
            const isChecked = localStorage.getItem(input.id) === 'true';
            input.checked = isChecked;
        });
        updateBackpack(); // Actualizar texto inicial
    }

    // --- CARGAR AL INICIO ---
    // A√±adimos esto para que se ejecute al abrir la p√°gina
    document.addEventListener('DOMContentLoaded', function() {
        // Cargar mochila
        loadBackpackState();
        
        // Cargar vista preferida
    const savedView = localStorage.getItem('viewMode');
    if(savedView === 'list') {
        const listBtn = document.querySelectorAll('.view-btn-pro')[1]; // El segundo bot√≥n es 'Lista'
        if(listBtn) switchView('list', listBtn);
    }
    });

    // --- L√ìGICA DE EMERGENCIA WHATSAPP ---

function sendWhatsappLocation() {
    const statusDiv = document.getElementById('sos-status');
    statusDiv.innerHTML = "üì° Buscando sat√©lites GPS...";
    statusDiv.style.color = "#e67e22"; // Naranja

    if (!navigator.geolocation) {
        statusDiv.innerHTML = "‚ùå Tu navegador no soporta GPS";
        alert("Tu dispositivo no permite acceso a la ubicaci√≥n.");
        return;
    }

    navigator.geolocation.getCurrentPosition(
        // √âxito
        function(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            const accuracy = position.coords.accuracy; // Precisi√≥n en metros

            statusDiv.innerHTML = "‚úÖ Ubicaci√≥n obtenida. Abriendo WhatsApp...";
            statusDiv.style.color = "#27ae60";

            // Creamos el enlace de Google Maps
            const mapsLink = `https://www.google.com/maps?q=${lat},${lon}`;
            
            // Mensaje de emergencia
            const text = `üÜò *SOS / EMERGENCIA* \nNecesito ayuda o que sepas d√≥nde estoy.\n\nüìç *Ubicaci√≥n exacta:* ${mapsLink}\n(Precisi√≥n: +/- ${Math.round(accuracy)}m)`;

            // Codificamos para URL
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(text)}`;

            // Abrir WhatsApp
            window.open(whatsappUrl, '_blank');
        },
        // Error
        function(error) {
            let errorMsg = "Error desconocido";
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    errorMsg = "‚ùå Denegaste el permiso de GPS.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    errorMsg = "‚ùå Se√±al GPS no disponible.";
                    break;
                case error.TIMEOUT:
                    errorMsg = "‚ùå Tiempo de espera agotado.";
                    break;
            }
            statusDiv.innerHTML = errorMsg;
            statusDiv.style.color = "#c0392b";
            alert("Por favor, activa la ubicaci√≥n en tu m√≥vil para usar esta funci√≥n.");
        },
        // Opciones de alta precisi√≥n
        {
            enableHighAccuracy: true, // Forzar GPS real (no solo wifi)
            timeout: 10000,           // Esperar m√°x 10 segundos
            maximumAge: 0             // No usar cach√© antigua
        }
    );
}

    // --- L√ìGICA DEL GESTOR DE GASTOS ---

// Funci√≥n para guardar gastos en localStorage
function saveExpense(etapaId, category, value) {
    let expenses = JSON.parse(localStorage.getItem('camino_gastos')) || {};
    if (!expenses[etapaId]) expenses[etapaId] = {};
    
    expenses[etapaId][category] = parseFloat(value) || 0;
    localStorage.setItem('camino_gastos', JSON.stringify(expenses));
    
    updateVisualTotals(etapaId);
}

// Actualiza los subtotales de la etapa en el modal
function updateVisualTotals(etapaId) {
    let expenses = JSON.parse(localStorage.getItem('camino_gastos')) || {};
    let etapaData = expenses[etapaId] || {};
    
    let subtotal = (etapaData.alojamiento || 0) + (etapaData.comida || 0) + (etapaData.otros || 0);
    
    // Construimos el ID del modal (ej: etapa1 -> modalEtapa1)
    const modalFullId = 'modal' + etapaId.charAt(0).toUpperCase() + etapaId.slice(1);
    const modal = document.getElementById(modalFullId);
    
    if (modal) {
        const subtotalSpan = modal.querySelector('.subtotal-etapa');
        if (subtotalSpan) subtotalSpan.innerText = subtotal.toFixed(2);
    }
}

// Carga los datos guardados al abrir el modal
function loadExpensesIntoModal(etapaId) {
    let expenses = JSON.parse(localStorage.getItem('camino_gastos')) || {};
    let etapaData = expenses[etapaId] || {};
    
    const modalFullId = 'modal' + etapaId.charAt(0).toUpperCase() + etapaId.slice(1);
    const modal = document.getElementById(modalFullId);
    
    if (modal) {
        modal.querySelectorAll('.expense-input').forEach(input => {
            const cat = input.dataset.cat;
            input.value = etapaData[cat] || "";
        });
        updateVisualTotals(etapaId);
    }
}

// Listener global para detectar cambios en los inputs de gastos
document.addEventListener('input', function(e) {
    if (e.target.classList.contains('expense-input')) {
        const modal = e.target.closest('.modal-backdrop');
        if (modal) {
            const etapaId = modal.id.replace('modal', '').toLowerCase();
            // 1. Guarda el gasto individual
            saveExpense(etapaId, e.target.dataset.cat, e.target.value);
            // 2. Recalcula el total de la cabecera principal
            refreshGlobalTotal(); 
        }
    }
});

    document.addEventListener('DOMContentLoaded', function() {
    const quotes = [
        '"El camino no se hace, el camino te hace a ti."',
        '"Hecho con ‚ù§Ô∏è para Xime, Paty y Modes"',
        '"Chic@s cada paso forja nuestra alma. Seguid andando."',
        '"Un pie tras otro, Compostela nos espera."',
        '"Cada ampolla es una historia, cada paso una victoria."'
    ];
    const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
    document.getElementById('random-quote').innerText = randomQuote;
});

// Calcula la suma de todos los gastos de todas las etapas
function refreshGlobalTotal() {
    let expenses = JSON.parse(localStorage.getItem('camino_gastos')) || {};
    let totalGlobal = 0;

    // Recorremos cada etapa y sumamos sus tres categor√≠as
    Object.values(expenses).forEach(etapa => {
        totalGlobal += (etapa.alojamiento || 0) + (etapa.comida || 0) + (etapa.otros || 0);
    });

    // Actualizamos el n√∫mero en la cabecera
    const totalDisplay = document.getElementById('global-total-money');
    if (totalDisplay) {
        totalDisplay.innerText = totalGlobal.toFixed(2) + '‚Ç¨';
    }
}

// Procesa la subida de la foto
function handlePhotoUpload(etapaId, input) {
    const file = input.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const imageData = e.target.result;
            localStorage.setItem(`photo_${etapaId}`, imageData); // Guarda en memoria local
            displayPhoto(etapaId, imageData);
        };
        reader.readAsDataURL(file);
    }
}

// Muestra la foto en el contenedor
function displayPhoto(etapaId, imageData) {
    const container = document.getElementById(`photo-container-${etapaId}`);
    if (container) {
        container.innerHTML = `<img src="${imageData}" style="width: 100%; height: 100%; object-fit: cover; cursor: pointer;" onclick="window.open('${imageData}')">`;
        container.style.border = "none";
    }
}

// Elimina la foto de la memoria
function removePhoto(etapaId) {
    if (confirm("¬øQuieres borrar esta foto?")) {
        localStorage.removeItem(`photo_${etapaId}`);
        const container = document.getElementById(`photo-container-${etapaId}`);
        if (container) {
            container.innerHTML = `<span style="color: #3498db; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>`;
            container.style.border = "2px dashed #3498db";
        }
    }
}

// 1. Motor de subida: Convierte la foto en datos y los guarda en el navegador
function handlePhotoUpload(etapaId, input) {
    const file = input.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const imageData = e.target.result;
            // ESTO ES LO QUE HACE QUE NO SE BORRE AL ACTUALIZAR
            localStorage.setItem(`photo_${etapaId}`, imageData); 
            displayPhoto(etapaId, imageData);
        };
        reader.readAsDataURL(file);
    }
}

// 2. Motor visual: Pone la imagen f√≠sicamente dentro del cuadro azul
function displayPhoto(etapaId, imageData) {
    const container = document.getElementById(`photo-container-${etapaId}`);
    if (container) {
        container.innerHTML = `<img src="${imageData}" style="width: 100%; height: 100%; object-fit: cover; cursor: pointer;" onclick="window.open('${imageData}')">`;
        container.style.border = "none";
    }
}

// 3. Motor de borrado: Limpia la memoria y el cuadro
function removePhoto(etapaId) {
    if (confirm("¬øQuieres borrar esta foto?")) {
        localStorage.removeItem(`photo_${etapaId}`);
        const container = document.getElementById(`photo-container-${etapaId}`);
        if (container) {
            container.innerHTML = `<span style="color: #3498db; font-size: 0.9em; font-weight: 500;">Captura un momento especial</span>`;
            container.style.border = "2px dashed #3498db";
        }
    }
}

// --- L√ìGICA DEL SELLO VISUAL (CORREGIDA) ---

function updateStampVisuals() {
    // Buscamos tus checkboxes reales (clase 'etapa-checkbox')
    const checkboxes = document.querySelectorAll('.etapa-checkbox');
    
    checkboxes.forEach(box => {
        // Buscamos la tarjeta padre real (clase 'etapa')
        const card = box.closest('.etapa');
        
        if (card) {
            if (box.checked) {
                card.classList.add('completed'); // ¬°Estampa el sello!
            } else {
                card.classList.remove('completed'); // Borra el sello
            }
        }
    });
}

// Activamos la l√≥gica
document.addEventListener('DOMContentLoaded', function() {
    updateStampVisuals(); // Al cargar la p√°gina
    
    // Escuchamos los cambios en tus checkboxes
    const checkboxes = document.querySelectorAll('.etapa-checkbox');
    checkboxes.forEach(box => {
        box.addEventListener('change', updateStampVisuals);
    });
});

// --- VARIABLES GLOBALES Y CONFIGURACI√ìN ---
let maps = { 1: null, 2: null, 3: null, 4: null, 5: null, 6: null, 7: null, 8: null, 9: null };

// Icono Hotel / Alojamiento
const hotelIcon = L.icon({
    iconUrl: 'https://cdn-icons-png.flaticon.com/512/10350/10350212.png',
    iconSize: [35, 35], iconAnchor: [17, 35], popupAnchor: [0, -35]
});

// Icono Usuario (Punto Azul estilo Google Maps)
const userIcon = L.divIcon({
    className: 'user-marker',
    html: '<div style="background-color: #4285F4; width: 15px; height: 15px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 0 4px rgba(66, 133, 244, 0.3);"></div>',
    iconSize: [20, 20],
    iconAnchor: [10, 10]
});

// --- FUNCI√ìN MAESTRA: CREAR MAPA CON GPS ---
function crearMapaBase(id, coordsCentro, zoom) {
    if (maps[id] !== null) return null; 

    // 1. Crear el mapa
    const map = L.map(`map-etapa${id}`).setView(coordsCentro, zoom);
    maps[id] = map;

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap'
    }).addTo(map);

    // 2. A√ëADIR BOT√ìN DE GPS "üéØ" (NUEVO)
    const GpsControl = L.Control.extend({
        options: { position: 'topright' }, // Arriba a la derecha
        onAdd: function(map) {
            const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control');
            const button = L.DomUtil.create('a', '', container);
            button.innerHTML = 'üéØ'; // Icono de diana
            button.href = '#';
            button.title = "Ver mi ubicaci√≥n";
            button.style.backgroundColor = 'white';
            button.style.width = '35px';
            button.style.height = '35px';
            button.style.display = 'flex';
            button.style.alignItems = 'center';
            button.style.justifyContent = 'center';
            button.style.fontSize = '20px';
            button.style.textDecoration = 'none';
            button.style.cursor = 'pointer';

            // Al hacer clic, buscamos al usuario
            L.DomEvent.on(button, 'click', function(e) {
                L.DomEvent.stop(e);
                button.innerHTML = '‚è≥'; // Icono de cargando
                map.locate({setView: true, maxZoom: 16});
            });

            return container;
        }
    });
    map.addControl(new GpsControl());

    // 3. EVENTOS DE GPS
    map.on('locationfound', function(e) {
        // Restaurar icono bot√≥n
        const btn = document.querySelector('.leaflet-control a[title="Ver mi ubicaci√≥n"]');
        if(btn) btn.innerHTML = 'üéØ';

        // Poner o mover el marcador azul
        if (map.userMarker) {
            map.userMarker.setLatLng(e.latlng);
        } else {
            map.userMarker = L.marker(e.latlng, {icon: userIcon}).addTo(map)
                .bindPopup("<b>üëã ¬°Est√°s aqu√≠!</b>").openPopup();
        }
    });

    map.on('locationerror', function(e) {
        alert("‚ö†Ô∏è No pudimos localizarte. Aseg√∫rate de tener el GPS activado y dar permiso al navegador.");
        const btn = document.querySelector('.leaflet-control a[title="Ver mi ubicaci√≥n"]');
        if(btn) btn.innerHTML = 'üéØ';
    });
    
    // Fix visualizaci√≥n
    setTimeout(() => { map.invalidateSize(); }, 200);
    return map;
}

// FUNCI√ìN PARA DIBUJAR RUTA
function dibujarRuta(map, latlngs) {
    if(!map) return;
    const polyline = L.polyline(latlngs, {color: '#3498db', weight: 4, dashArray: '10, 10', opacity: 0.7}).addTo(map);
    map.fitBounds(polyline.getBounds(), {padding: [40, 40]});
}

// --- ETAPA 1: OPORTO -> LABRUGE ---
function cargarMapaEtapa1() {
    const map = crearMapaBase(1, [41.2000, -8.6800], 11);
    if (!map) return;

    L.marker([41.1429, -8.6111]).addTo(map).bindPopup('<b>üö© Inicio: Oporto</b>');
    L.marker([41.2754, -8.7296]).addTo(map).bindPopup('<b>üèÅ Meta: Labruge</b>');
    L.marker([41.1485, -8.6680]).addTo(map).bindPopup('üìç Foz do Douro');
    L.marker([41.1685, -8.6890]).addTo(map).bindPopup('üìç Matosinhos');
    L.marker([41.1940, -8.7050]).addTo(map).bindPopup('üìç Le√ßa da Palmeira');
    L.marker([41.2210, -8.7190]).addTo(map).bindPopup('üìç Aldeia Nova');
    L.marker([41.2580, -8.7240]).addTo(map).bindPopup('üìç Angeiras');

    // Hotel
    L.marker([41.2765, -8.7250], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü Beach House Labruge</b>').openPopup();

    dibujarRuta(map, [
        [41.1429, -8.6111], [41.1485, -8.6680], [41.1685, -8.6890], 
        [41.1940, -8.7050], [41.2210, -8.7190], [41.2580, -8.7240], 
        [41.2754, -8.7296]
    ]);
}

// --- ETAPA 2: LABRUGE -> P√ìVOA DE VARZIM ---
function cargarMapaEtapa2() {
    const map = crearMapaBase(2, [41.3300, -8.7500], 12);
    if (!map) return;

    L.marker([41.2754, -8.7296]).addTo(map).bindPopup('<b>üö© Inicio: Labruge</b>');
    L.marker([41.3804, -8.7609]).addTo(map).bindPopup('<b>üèÅ Meta: P√≥voa</b>');
    L.marker([41.2950, -8.7350]).addTo(map).bindPopup('üìç Vila Ch√£');
    L.marker([41.3150, -8.7400]).addTo(map).bindPopup('üìç Mindelo');
    L.marker([41.3550, -8.7420]).addTo(map).bindPopup('üìç Vila do Conde');

    L.marker([41.3900, -8.7500], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü Casa Fragosa</b>').openPopup();

    dibujarRuta(map, [
        [41.2754, -8.7296], [41.2950, -8.7350], [41.3150, -8.7400], 
        [41.3550, -8.7420], [41.3804, -8.7609]
    ]);
}

// --- ETAPA 3: P√ìVOA -> MARINHAS ---
function cargarMapaEtapa3() {
    const map = crearMapaBase(3, [41.4500, -8.7700], 11);
    if (!map) return;

    L.marker([41.3804, -8.7609]).addTo(map).bindPopup('<b>üö© Inicio: P√≥voa</b>');
    L.marker([41.5420, -8.7850]).addTo(map).bindPopup('<b>üèÅ Meta: Marinhas</b>');
    L.marker([41.4100, -8.7750]).addTo(map).bindPopup('üìç Agu√ßadoura');
    L.marker([41.4800, -8.7780]).addTo(map).bindPopup('üìç Ap√∫lia');
    L.marker([41.5100, -8.7750]).addTo(map).bindPopup('üìç F√£o');
    L.marker([41.5300, -8.7800]).addTo(map).bindPopup('üìç Esposende');

    L.marker([41.5450, -8.7820], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü Casa Outeiro Polo 2</b>').openPopup();

    dibujarRuta(map, [
        [41.3804, -8.7609], [41.4100, -8.7750], [41.4800, -8.7780], 
        [41.5100, -8.7750], [41.5300, -8.7800], [41.5420, -8.7850]
    ]);
}

// --- ETAPA 4: MARINHAS -> VIANA DO CASTELO ---
function cargarMapaEtapa4() {
    const map = crearMapaBase(4, [41.6200, -8.8000], 11);
    if (!map) return;

    L.marker([41.5420, -8.7850]).addTo(map).bindPopup('<b>üö© Inicio: Marinhas</b>');
    L.marker([41.6932, -8.8325]).addTo(map).bindPopup('<b>üèÅ Meta: Viana</b>');
    L.marker([41.5800, -8.7900]).addTo(map).bindPopup('üìç Belinho');
    L.marker([41.6200, -8.8050]).addTo(map).bindPopup('üìç Castelo do Neiva');
    L.marker([41.6500, -8.8100]).addTo(map).bindPopup('üìç Chaf√©');
    L.marker([41.6750, -8.8150]).addTo(map).bindPopup('üìç Darque');

    L.marker([41.6980, -8.8280], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü 3 Marias Residence</b>').openPopup();

    dibujarRuta(map, [
        [41.5420, -8.7850], [41.5800, -8.7900], [41.6200, -8.8050], 
        [41.6500, -8.8100], [41.6750, -8.8150], [41.6932, -8.8325]
    ]);
}

// --- ETAPA 5: VIANA -> CAMINHA ---
function cargarMapaEtapa5() {
    const map = crearMapaBase(5, [41.7800, -8.8500], 11);
    if (!map) return;

    L.marker([41.6932, -8.8325]).addTo(map).bindPopup('<b>üö© Inicio: Viana</b>');
    L.marker([41.8760, -8.8380]).addTo(map).bindPopup('<b>üèÅ Meta: Caminha</b>');
    L.marker([41.7200, -8.8600]).addTo(map).bindPopup('üìç Areosa');
    L.marker([41.7500, -8.8700]).addTo(map).bindPopup('üìç Carre√ßo');
    L.marker([41.8100, -8.8650]).addTo(map).bindPopup('üìç Vila Praia de √Çncora');
    L.marker([41.8450, -8.8680]).addTo(map).bindPopup('üìç Moledo');

    L.marker([41.8770, -8.8390], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü Casa Sebastiao</b>').openPopup();

    dibujarRuta(map, [
        [41.6932, -8.8325], [41.7200, -8.8600], [41.7500, -8.8700], 
        [41.8100, -8.8650], [41.8450, -8.8680], [41.8760, -8.8380]
    ]);
}

// --- ETAPA 6: CAMINHA -> PORTO MOUG√ÅS ---
function cargarMapaEtapa6() {
    const map = crearMapaBase(6, [41.9600, -8.8700], 11);
    if (!map) return;

    L.marker([41.8760, -8.8380]).addTo(map).bindPopup('<b>üö© Inicio: Caminha</b>');
    L.marker([42.0460, -8.8920]).addTo(map).bindPopup('<b>üèÅ Meta: Porto Moug√°s</b>');
    L.marker([41.8850, -8.8500]).addTo(map).bindPopup('‚õ¥Ô∏è Ferry / A Pasaxe');
    L.marker([41.9010, -8.8750]).addTo(map).bindPopup('üìç A Guarda');
    L.marker([42.0000, -8.8770]).addTo(map).bindPopup('üìç Oia (Monasterio)');

    L.marker([42.0500, -8.8950], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü Casa To√±i</b>').openPopup();

    dibujarRuta(map, [
        [41.8760, -8.8380], [41.8850, -8.8500], [41.9010, -8.8750], 
        [42.0000, -8.8770], [42.0460, -8.8920]
    ]);
}

// --- ETAPA 7: PORTO MOUG√ÅS -> BAIONA ---
function cargarMapaEtapa7() {
    const map = crearMapaBase(7, [42.0800, -8.8700], 12);
    if (!map) return;

    L.marker([42.0460, -8.8920]).addTo(map).bindPopup('<b>üö© Inicio: Moug√°s</b>');
    L.marker([42.1195, -8.8505]).addTo(map).bindPopup('<b>üèÅ Meta: Baiona</b>');
    L.marker([42.0900, -8.8750]).addTo(map).bindPopup('üìç Baredo');

    L.marker([42.1220, -8.8480], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü Apt. Mari√±eiro</b>').openPopup();

    dibujarRuta(map, [
        [42.0460, -8.8920], [42.0900, -8.8750], [42.1195, -8.8505]
    ]);
}

// --- ETAPA 8: BAIONA -> PADR√ìN (Transporte) ---
function cargarMapaEtapa8() {
    const map = crearMapaBase(8, [42.4500, -8.7500], 9);
    if (!map) return;

    L.marker([42.1195, -8.8505]).addTo(map).bindPopup('<b>üöç Salida: Baiona</b>');
    L.marker([42.7380, -8.6610]).addTo(map).bindPopup('<b>üèÅ Llegada: Padr√≥n</b>');
    L.marker([42.2230, -8.9050]).addTo(map).bindPopup('üèùÔ∏è Islas C√≠es');

    L.marker([42.7390, -8.6620], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü O Secreto (Padr√≥n)</b>').openPopup();

    const polyline = L.polyline([
        [42.1195, -8.8505], [42.7380, -8.6610]
    ], {color: '#7f8c8d', weight: 3, dashArray: '5, 10'}).addTo(map);
    map.fitBounds(polyline.getBounds(), {padding: [50, 50]});
}

// --- ETAPA 9: PADR√ìN -> SANTIAGO ---
function cargarMapaEtapa9() {
    const map = crearMapaBase(9, [42.8100, -8.6000], 11);
    if (!map) return;

    L.marker([42.7380, -8.6610]).addTo(map).bindPopup('<b>üö© Inicio: Padr√≥n</b>');
    L.marker([42.8806, -8.5446]).addTo(map).bindPopup('<b>üèÅ CATEDRAL DE SANTIAGO</b>');
    L.marker([42.7480, -8.6550]).addTo(map).bindPopup('üìç Iria Flavia');
    L.marker([42.7750, -8.6400]).addTo(map).bindPopup('üìç A Escravitude');
    L.marker([42.8450, -8.5900]).addTo(map).bindPopup('üìç Milladoiro');

    L.marker([42.8750, -8.5500], {icon: hotelIcon}).addTo(map)
        .bindPopup('<b>üåü Pensi√≥n da Sela</b>').openPopup();

    dibujarRuta(map, [
        [42.7380, -8.6610], [42.7480, -8.6550], [42.7750, -8.6400], 
        [42.8450, -8.5900], [42.8806, -8.5446]
    ]);
}

// --- FUNCI√ìN QUE ABRE LA VENTANA DE EMERGENCIA ---
function openEmergencyModal() {
    // 1. Abre el modal usando la funci√≥n gen√©rica que ya tienes
    openModal('modalSOS');
    
    // 2. Limpia el mensaje de estado anterior (para que se vea limpio)
    const statusDiv = document.getElementById('sos-status');
    if(statusDiv) {
        statusDiv.innerHTML = ""; 
        statusDiv.style.color = "#888";
    }
}

// --- DATOS DE ELEVACI√ìN (APROXIMADOS CAMINO COSTA) ---
const elevationData = {
    'etapa1': { // Oporto -> Labruge (Muy llano)
        labels: ['0km', '5km', '10km', '15km', '20km', '24km'],
        data: [10, 15, 12, 8, 10, 5], 
        gain: '50'
    },
    'etapa2': { // Labruge -> P√≥voa (Llano)
        labels: ['0km', '4km', '8km', '12km', '14km'],
        data: [5, 8, 10, 12, 10], 
        gain: '30'
    },
    'etapa3': { // P√≥voa -> Marinhas (Llano)
        labels: ['0km', '5km', '10km', '15km', '20km', '24km'],
        data: [10, 12, 15, 10, 20, 15], 
        gain: '60'
    },
    'etapa4': { // Marinhas -> Viana (Subida al monte y bajada al r√≠o)
        labels: ['0km', '5km', '8km', '12km', '16km', '21km'],
        data: [20, 120, 150, 60, 40, 10], 
        gain: '350' // ¬°Aqu√≠ hay subida!
    },
    'etapa5': { // Viana -> Caminha (Peque√±os repechos)
        labels: ['0km', '5km', '10km', '15km', '20km', '26km'],
        data: [10, 50, 80, 20, 40, 10], 
        gain: '200'
    },
    'etapa6': { // Caminha -> Moug√°s (Costa rocosa)
        labels: ['0km', '5km', '10km', '15km', '20km', '23km'],
        data: [5, 40, 20, 30, 10, 15], 
        gain: '150'
    },
    'etapa7': { // Moug√°s -> Baiona (¬°LA SUBIDA DE BAREDO!)
        labels: ['0km', '2km', '4km', '6km', '8km', '11km'],
        data: [10, 20, 160, 140, 80, 10], 
        gain: '300'
    },
    'etapa8': { // Descanso (Sin gr√°fico necesario o plano)
        labels: ['0km', '10km'],
        data: [10, 10], 
        gain: '0'
    },
    'etapa9': { // Padr√≥n -> Santiago (Subida Milladoiro)
        labels: ['0km', '5km', '10km', '15km', '18km', '24km'],
        data: [20, 40, 100, 150, 260, 260], 
        gain: '450'
    }
};

let elevationCharts = {}; // Para guardar los gr√°ficos y no duplicarlos

function loadElevationProfile(etapaId) {
    const ctx = document.getElementById(`elevation-${etapaId}`);
    
    // Si no existe el canvas o ya dibujamos el gr√°fico, salimos
    if (!ctx || elevationCharts[etapaId]) return;

    const info = elevationData[etapaId];
    if (!info) return;

    // Actualizar texto de desnivel
    const gainSpan = document.getElementById(`gain-${etapaId}`);
    if(gainSpan) gainSpan.innerText = info.gain;

    // Crear el Gr√°fico
    elevationCharts[etapaId] = new Chart(ctx, {
        type: 'line',
        data: {
            labels: info.labels,
            datasets: [{
                label: 'Altitud (m)',
                data: info.data,
                borderColor: '#e67e22', // Color Naranja Camino
                backgroundColor: 'rgba(230, 126, 34, 0.2)', // Relleno transparente
                borderWidth: 3,
                tension: 0.4, // Suaviza las curvas (0 es pico, 1 es curva)
                fill: true,   // Rellenar debajo de la l√≠nea
                pointRadius: 0, // Ocultar puntos para que se vea limpio
                pointHoverRadius: 6
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false }, // Ocultar leyenda
                tooltip: { 
                    mode: 'index', 
                    intersect: false,
                    backgroundColor: 'rgba(44, 62, 80, 0.9)',
                    titleColor: '#f1c40f'
                }
            },
            scales: {
                y: { 
                    beginAtZero: true,
                    grid: { color: 'rgba(0,0,0,0.05)' } 
                },
                x: { 
                    grid: { display: false } 
                }
            }
        }
    });
}

// --- L√ìGICA MODO NOCHE ---
function toggleTheme() {
    document.body.classList.toggle('dark-mode');
    
    // Guardamos la preferencia del usuario
    if (document.body.classList.contains('dark-mode')) {
        localStorage.setItem('theme', 'dark');
    } else {
        localStorage.setItem('theme', 'light');
    }
}

// Cargar el tema guardado al abrir la app
document.addEventListener('DOMContentLoaded', function() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        document.body.classList.add('dark-mode');
    }
    // ... aqu√≠ sigue tu otro c√≥digo de DOMContentLoaded ...
});

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js');
}
    </script>

    <footer>
    <div class="footer-content">
        <svg class="shell-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <path d="M50 90 C 20 90, 5 60, 10 30 C 15 10, 85 10, 90 30 C 95 60, 80 90, 50 90 Z" fill="#f1c40f" />
            <line x1="50" y1="90" x2="50" y2="15" stroke="#2c3e50" stroke-width="3" stroke-linecap="round" />
            <line x1="50" y1="90" x2="25" y2="25" stroke="#2c3e50" stroke-width="3" stroke-linecap="round" />
            <line x1="50" y1="90" x2="75" y2="25" stroke="#2c3e50" stroke-width="3" stroke-linecap="round" />
            <line x1="50" y1="90" x2="15" y2="45" stroke="#2c3e50" stroke-width="3" stroke-linecap="round" />
            <line x1="50" y1="90" x2="85" y2="45" stroke="#2c3e50" stroke-width="3" stroke-linecap="round" />
        </svg>
        
        <div class="footer-quote" id="random-quote">"El camino no se hace, el camino te hace a ti."</div>
        
        <div class="footer-nav">
            <a href="#" onclick="openModal('modalMochila')">üéí Mi Mochila</a>
            <a href="https://www.caminodesantiago.gal" target="_blank">üåê Web Oficial</a>
            <a href="javascript:void(0)" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">‚¨ÜÔ∏è Volver arriba</a>
        </div>

        <div class="copyright">
            ¬© 2026 - Gu√≠a Personal del Camino Portugu√©s de la Costa<br>
            ¬°Buen Camino, Peregrino! üë£
        </div>
    </div>
</footer>

</body>
</html>